<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gated Recurrent Units (GRU) · d2l Julia</title><meta name="title" content="Gated Recurrent Units (GRU) · d2l Julia"/><meta property="og:title" content="Gated Recurrent Units (GRU) · d2l Julia"/><meta property="twitter:title" content="Gated Recurrent Units (GRU) · d2l Julia"/><meta name="description" content="Documentation for d2l Julia."/><meta property="og:description" content="Documentation for d2l Julia."/><meta property="twitter:description" content="Documentation for d2l Julia."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../CH3.Linear_Regression/LNN_1/">d2l Julia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Linear Neural Networks for Regression</span><ul><li><a class="tocitem" href="../../CH3.Linear_Regression/LNN_1/">Linear Regression</a></li><li><a class="tocitem" href="../../CH3.Linear_Regression/LNN_2/">Multiple Dispatch Design for Implementation</a></li><li><a class="tocitem" href="../../CH3.Linear_Regression/LNN_3/">Synthetic Regression Data</a></li><li><a class="tocitem" href="../../CH3.Linear_Regression/LNN_4/">Linear Regression Implementation from Scratch</a></li><li><a class="tocitem" href="../../CH3.Linear_Regression/LNN_5/">Concise Implementation of Linear Regression</a></li><li><a class="tocitem" href="../../CH3.Linear_Regression/LNN_6/">Generalization</a></li><li><a class="tocitem" href="../../CH3.Linear_Regression/LNN_7/">Weight Decay</a></li></ul></li><li><span class="tocitem">Linear Neural Networks for Classification</span><ul><li><a class="tocitem" href="../../CH4.Linear_Classification/LCN_1/">Softmax Regression</a></li><li><a class="tocitem" href="../../CH4.Linear_Classification/LCN_2/">The Image Classification Dataset</a></li><li><a class="tocitem" href="../../CH4.Linear_Classification/LCN_3/">Softmax Regression Implementation from Scratch</a></li><li><a class="tocitem" href="../../CH4.Linear_Classification/LCN_4/">Concise Implementation of Softmax Regression</a></li><li><a class="tocitem" href="../../CH4.Linear_Classification/LCN_5/">Generalization in Classification</a></li><li><a class="tocitem" href="../../CH4.Linear_Classification/LCN_6/">Environment and Distribution Shift</a></li></ul></li><li><span class="tocitem">Multilayer Perceptron</span><ul><li><a class="tocitem" href="../../CH5.MLP/MLP_1/">Multilayer Perceptrons</a></li><li><a class="tocitem" href="../../CH5.MLP/MLP_2/">Implementation of Multilayer Perceptrons</a></li><li><a class="tocitem" href="../../CH5.MLP/MLP_3/">Forward Propagation, Backward Propagation, and Computational Graphs</a></li><li><a class="tocitem" href="../../CH5.MLP/MLP_4/">Numerical Stability and Initialization</a></li><li><a class="tocitem" href="../../CH5.MLP/MLP_5/">Generalization in Deep Learning</a></li><li><a class="tocitem" href="../../CH5.MLP/MLP_6/">Dropout</a></li></ul></li><li><span class="tocitem">Convolutional Neural Networks</span><ul><li><a class="tocitem" href="../../CH6.Convolutional_Neural_Networks/CNN_2/">Convolutions for Images</a></li><li><a class="tocitem" href="../../CH6.Convolutional_Neural_Networks/CNN_3/">Padding and Stride</a></li><li><a class="tocitem" href="../../CH6.Convolutional_Neural_Networks/CNN_4/">Multiple Input and Multiple Output Channels</a></li><li><a class="tocitem" href="../../CH6.Convolutional_Neural_Networks/CNN_5/">Pooling</a></li><li><a class="tocitem" href="../../CH6.Convolutional_Neural_Networks/CNN_6/">Convolutional Neural Networks (LeNet)</a></li></ul></li><li><span class="tocitem">Modern Convolutional Neural Networks</span><ul><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_0/">Modern Convolutional Neural Networks</a></li><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_1/">Deep Convolutional Neural Networks (AlexNet)</a></li><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_2/">Networks Using Blocks (VGG)</a></li><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_3/">-</a></li><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_4/">Multi-Branch Networks  (GoogLeNet)</a></li><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_5/">-</a></li><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_6/">Residual Networks (ResNet) and ResNeXt</a></li><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_7/">Densely Connected Networks (DenseNet)</a></li><li><a class="tocitem" href="../../CH7.ModernConvolutionalNeuralNetworks/MCNN_8/">Designing Convolution Network Architectures</a></li></ul></li><li><span class="tocitem">Recurrent Neural Networks</span><ul><li><a class="tocitem" href="../../CH8.Recurrent_Neural_Networks/RNN_0/">Recurrent Neural Networks</a></li><li><a class="tocitem" href="../../CH8.Recurrent_Neural_Networks/RNN_1/">Working with Sequences</a></li><li><a class="tocitem" href="../../CH8.Recurrent_Neural_Networks/RNN_2/">Converting Raw Text into Sequence Data</a></li><li><a class="tocitem" href="../../CH8.Recurrent_Neural_Networks/RNN_3/">Language Models</a></li><li><a class="tocitem" href="../../CH8.Recurrent_Neural_Networks/RNN_4/">Recurrent Neural Networks</a></li><li><a class="tocitem" href="../../CH8.Recurrent_Neural_Networks/RNN_5/">Recurrent Neural Network Implementation from Scratch</a></li><li><a class="tocitem" href="../../CH8.Recurrent_Neural_Networks/RNN_6/">Concise Implementation of Recurrent Neural Networks</a></li><li><a class="tocitem" href="../../CH8.Recurrent_Neural_Networks/RNN_7/">Backpropagation Through Time</a></li></ul></li><li><span class="tocitem">Modern Recurrent Neural Networks</span><ul><li><a class="tocitem" href="../MRNN7/">Sequence-to-Sequence Learning for Machine Translation</a></li><li><a class="tocitem" href="../MRNN_1/">Long Short-Term Memory (LSTM)</a></li><li class="is-active"><a class="tocitem" href>Gated Recurrent Units (GRU)</a><ul class="internal"><li><a class="tocitem" href="#Reset-Gate-and-Update-Gate"><span>Reset Gate and Update Gate</span></a></li><li><a class="tocitem" href="#Hidden-State"><span>Hidden State</span></a></li><li><a class="tocitem" href="#Implementation-from-Scratch"><span>Implementation from Scratch</span></a></li><li><a class="tocitem" href="#Concise-Implementation"><span>Concise Implementation</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li><li><a class="tocitem" href="#Exercises"><span>Exercises</span></a></li></ul></li><li><a class="tocitem" href="../MRNN_3/">-</a></li><li><a class="tocitem" href="../MRNN_4/">Bidirectional Recurrent Neural Networks</a></li><li><a class="tocitem" href="../MRNN_5/">Machine Translation and the Dataset</a></li><li><a class="tocitem" href="../MRNN_6/">The Encoder–Decoder Architecture</a></li></ul></li><li><span class="tocitem">Attention Mechanisms and Transformers</span><ul><li><a class="tocitem" href="../../CH10.Attention_Mechanisms_and_Transformers/ATTN_1/">Queries, Keys, and Values</a></li><li><a class="tocitem" href="../../CH10.Attention_Mechanisms_and_Transformers/ATTN_2/">Attention Pooling by Similarity</a></li><li><a class="tocitem" href="../../CH10.Attention_Mechanisms_and_Transformers/ATTN_3/">Attention Scoring Functions</a></li><li><a class="tocitem" href="../../CH10.Attention_Mechanisms_and_Transformers/ATTN_4/">The Bahdanau Attention Mechanism</a></li><li><a class="tocitem" href="../../CH10.Attention_Mechanisms_and_Transformers/ATTN_5/">Multi-Head Attention</a></li><li><a class="tocitem" href="../../CH10.Attention_Mechanisms_and_Transformers/ATTN_6/">Self-Attention and Positional Encoding</a></li><li><a class="tocitem" href="../../CH10.Attention_Mechanisms_and_Transformers/Untitled/">-</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Modern Recurrent Neural Networks</a></li><li class="is-active"><a href>Gated Recurrent Units (GRU)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gated Recurrent Units (GRU)</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gated-Recurrent-Units-(GRU)"><a class="docs-heading-anchor" href="#Gated-Recurrent-Units-(GRU)">Gated Recurrent Units (GRU)</a><a id="Gated-Recurrent-Units-(GRU)-1"></a><a class="docs-heading-anchor-permalink" href="#Gated-Recurrent-Units-(GRU)" title="Permalink"></a></h1><p>As RNNs and particularly the LSTM architecture (:numref:<code>sec_lstm</code>) rapidly gained popularity during the 2010s, a number of researchers began to experiment  with simplified architectures in hopes  of retaining the key idea of incorporating an internal state and multiplicative gating mechanisms but with the aim of speeding up computation. The gated recurrent unit (GRU) :cite:<code>Cho.Van-Merrienboer.Bahdanau.ea.2014</code>  offered a streamlined version of the LSTM memory cell that often achieves comparable performance but with the advantage of being faster  to compute :cite:<code>Chung.Gulcehre.Cho.ea.2014</code>.</p><pre><code class="language-julia hljs">using Pkg; Pkg.activate(&quot;../../d2lai&quot;)
using d2lai
using Flux 
using Plots
using CUDA, cuDNN</code></pre><pre><code class="nohighlight hljs">  Activating project at `/workspace/d2l-julia/d2lai`</code></pre><div style="max-height:300px; overflow-y:auto; background:#111; color:#eee; padding:1em; border-radius:5px;">
<pre>    [ Info: Precompiling d2lai [749b8817-cd67-416c-8a57-830ea19f3cc4] (cache misses: include_dependency fsize change (2))</pre>
</div><h2 id="Reset-Gate-and-Update-Gate"><a class="docs-heading-anchor" href="#Reset-Gate-and-Update-Gate">Reset Gate and Update Gate</a><a id="Reset-Gate-and-Update-Gate-1"></a><a class="docs-heading-anchor-permalink" href="#Reset-Gate-and-Update-Gate" title="Permalink"></a></h2><p>Here, the LSTM&#39;s three gates are replaced by two: the <em>reset gate</em> and the <em>update gate</em>. As with LSTMs, these gates are given sigmoid activations, forcing their values to lie in the interval <span>$(0, 1)$</span>. Intuitively, the reset gate controls how much of the previous state  we might still want to remember. Likewise, an update gate would allow us to control  how much of the new state is just a copy of the old one. :numref:<code>fig_gru_1</code> illustrates the inputs for both the reset and update gates in a GRU,  given the input of the current time step and the hidden state of the previous time step. The outputs of the gates are given  by two fully connected layers with a sigmoid activation function.</p><p><img src="../../img/gru-1.svg" alt="Computing the reset gate and the update gate in a GRU model."/> :label:<code>fig_gru_1</code></p><p>Mathematically, for a given time step <span>$t$</span>, suppose that the input is a minibatch <span>$\mathbf{X}_t \in \mathbb{R}^{n \times d}$</span>  (number of examples <span>$=n$</span>; number of inputs <span>$=d$</span>) and the hidden state of the previous time step  is <span>$\mathbf{H}_{t-1} \in \mathbb{R}^{n \times h}$</span>  (number of hidden units <span>$=h$</span>).  Then the reset gate <span>$\mathbf{R}_t \in \mathbb{R}^{n \times h}$</span>  and update gate <span>$\mathbf{Z}_t \in \mathbb{R}^{n \times h}$</span> are computed as follows:</p><p class="math-container">\[
\begin{aligned}
\mathbf{R}_t = \sigma(\mathbf{X}_t \mathbf{W}_{\textrm{xr}} + \mathbf{H}_{t-1} \mathbf{W}_{\textrm{hr}} + \mathbf{b}_\textrm{r}),\\
\mathbf{Z}_t = \sigma(\mathbf{X}_t \mathbf{W}_{\textrm{xz}} + \mathbf{H}_{t-1} \mathbf{W}_{\textrm{hz}} + \mathbf{b}_\textrm{z}),
\end{aligned}
$$

where $\mathbf{W}_{\textrm{xr}}, \mathbf{W}_{\textrm{xz}} \in \mathbb{R}^{d \times h}$ 
and $\mathbf{W}_{\textrm{hr}}, \mathbf{W}_{\textrm{hz}} \in \mathbb{R}^{h \times h}$ 
are weight parameters and $\mathbf{b}_\textrm{r}, \mathbf{b}_\textrm{z} \in \mathbb{R}^{1 \times h}$ 
are bias parameters.


## Candidate Hidden State

Next, we integrate the reset gate $\mathbf{R}_t$ 
with the regular updating mechanism
in :eqref:`rnn_h_with_state`,
leading to the following
*candidate hidden state*
$\tilde{\mathbf{H}}_t \in \mathbb{R}^{n \times h}$ at time step $t$:

$$\tilde{\mathbf{H}}_t = \tanh(\mathbf{X}_t \mathbf{W}_{\textrm{xh}} + \left(\mathbf{R}_t \odot \mathbf{H}_{t-1}\right) \mathbf{W}_{\textrm{hh}} + \mathbf{b}_\textrm{h}),\]</p><p>:eqlabel:<code>gru_tilde_H</code></p><p>where <span>$\mathbf{W}_{\textrm{xh}} \in \mathbb{R}^{d \times h}$</span> and <span>$\mathbf{W}_{\textrm{hh}} \in \mathbb{R}^{h \times h}$</span> are weight parameters, <span>$\mathbf{b}_\textrm{h} \in \mathbb{R}^{1 \times h}$</span> is the bias, and the symbol <span>$\odot$</span> is the Hadamard (elementwise) product operator. Here we use a tanh activation function.</p><p>The result is a <em>candidate</em>, since we still need  to incorporate the action of the update gate. Comparing with :eqref:<code>rnn_h_with_state</code>, the influence of the previous states can now be reduced with the elementwise multiplication of <span>$\mathbf{R}_t$</span> and <span>$\mathbf{H}_{t-1}$</span> in :eqref:<code>gru_tilde_H</code>. Whenever the entries in the reset gate <span>$\mathbf{R}_t$</span> are close to 1,  we recover a vanilla RNN such as that in :eqref:<code>rnn_h_with_state</code>. For all entries of the reset gate <span>$\mathbf{R}_t$</span> that are close to 0,  the candidate hidden state is the result of an MLP with <span>$\mathbf{X}_t$</span> as input.  Any pre-existing hidden state is thus <em>reset</em> to defaults.</p><p>:numref:<code>fig_gru_2</code> illustrates the computational flow after applying the reset gate.</p><p><img src="../../img/gru-2.svg" alt="Computing the candidate hidden state in a GRU model."/> :label:<code>fig_gru_2</code></p><h2 id="Hidden-State"><a class="docs-heading-anchor" href="#Hidden-State">Hidden State</a><a id="Hidden-State-1"></a><a class="docs-heading-anchor-permalink" href="#Hidden-State" title="Permalink"></a></h2><p>Finally, we need to incorporate the effect of the update gate <span>$\mathbf{Z}_t$</span>. This determines the extent to which the new hidden state <span>$\mathbf{H}_t \in \mathbb{R}^{n \times h}$</span>  matches the old state <span>$\mathbf{H}_{t-1}$</span> compared with how much  it resembles the new candidate state <span>$\tilde{\mathbf{H}}_t$</span>. The update gate <span>$\mathbf{Z}_t$</span> can be used for this purpose,  simply by taking elementwise convex combinations  of <span>$\mathbf{H}_{t-1}$</span> and <span>$\tilde{\mathbf{H}}_t$</span>. This leads to the final update equation for the GRU:</p><p class="math-container">\[\mathbf{H}_t = \mathbf{Z}_t \odot \mathbf{H}_{t-1}  + (1 - \mathbf{Z}_t) \odot \tilde{\mathbf{H}}_t.\]</p><p>Whenever the update gate <span>$\mathbf{Z}_t$</span> is close to 1, we simply retain the old state.  In this case the information from <span>$\mathbf{X}_t$</span> is ignored,  effectively skipping time step <span>$t$</span> in the dependency chain.  By contrast, whenever <span>$\mathbf{Z}_t$</span> is close to 0, the new latent state <span>$\mathbf{H}_t$</span> approaches the candidate latent state <span>$\tilde{\mathbf{H}}_t$</span>.  :numref:<code>fig_gru_3</code> shows the computational flow after the update gate is in action.</p><p><img src="../../img/gru-3.svg" alt="Computing the hidden state in a GRU model."/> :label:<code>fig_gru_3</code></p><p>In summary, GRUs have the following two distinguishing features:</p><ul><li>Reset gates help capture short-term dependencies in sequences.</li><li>Update gates help capture long-term dependencies in sequences.</li></ul><h2 id="Implementation-from-Scratch"><a class="docs-heading-anchor" href="#Implementation-from-Scratch">Implementation from Scratch</a><a id="Implementation-from-Scratch-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-from-Scratch" title="Permalink"></a></h2><p>To gain a better understanding of the GRU model, let&#39;s implement it from scratch.</p><h3 id="Initializing-Model-Parameters"><a class="docs-heading-anchor" href="#Initializing-Model-Parameters">Initializing Model Parameters</a><a id="Initializing-Model-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Initializing-Model-Parameters" title="Permalink"></a></h3><p>The first step is to initialize the model parameters. We draw the weights from a Gaussian distribution with standard deviation to be <code>sigma</code> and set the bias to 0.  The hyperparameter <code>num_hiddens</code> defines the number of hidden units. We instantiate all weights and biases relating to the update gate,  the reset gate, and the candidate hidden state.</p><pre><code class="language-julia hljs">struct GRUScratch{W, A} &lt;: AbstractModel 
    w::W 
    args::A
end

Flux.@layer GRUScratch trainable = (w,)
function GRUScratch(num_inputs::Int, num_hiddens::Int; sigma = 0.01)
    init_weights() = randn(num_hiddens, num_inputs).*sigma, randn(num_hiddens, num_hiddens).*sigma, zeros(num_hiddens)

    W_rx, W_rh, b_r = init_weights()
    W_zx, W_zh, b_z = init_weights()
    W_cx, W_ch, b_c = init_weights()

    w = (
        reset_gate = construct_nt_args(; W_rx, W_rh, b_r),
        update_gate = construct_nt_args(; W_zx, W_zh, b_z),
        input_node = construct_nt_args(; W_cx, W_ch, b_c)
    )

    args = construct_nt_args(; num_inputs, num_hiddens, sigma)

    GRUScratch(w, args)
end</code></pre><pre><code class="nohighlight hljs">GRUScratch</code></pre><h3 id="Defining-the-Model"><a class="docs-heading-anchor" href="#Defining-the-Model">Defining the Model</a><a id="Defining-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-Model" title="Permalink"></a></h3><p>Now we are ready to define the GRU forward computation. Its structure is the same as that of the basic RNN cell,  except that the update equations are more complex.</p><pre><code class="language-julia hljs">function (gru::GRUScratch)(x, state = nothing)
    batchsize = size(x, 3)
    device = isa(x, CuArray) ? gpu : cpu
    H = if isnothing(state) 
        zeros(gru.args.num_hiddens, batchsize)
    else
        state 
    end |&gt; device

    outs = map(eachslice(x; dims = 2)) do x_ 
        Rt = sigmoid.(gru.w.reset_gate.W_rx*x_ + gru.w.reset_gate.W_rh*H .+ gru.w.reset_gate.b_r)
        Zt = sigmoid.(gru.w.update_gate.W_zx*x_ + gru.w.update_gate.W_zh*H .+ gru.w.update_gate.b_z)
        H_tilde = tanh.(gru.w.input_node.W_cx*x_ + gru.w.input_node.W_ch*(H.*Rt) .+ gru.w.input_node.b_c)
        H = Zt.*H + (1. .- Zt).*H_tilde
        return H 
    end
    outputs = stack(outs)
    permutedims(outputs, [1,3,2]), H
end
</code></pre><h3 id="Training"><a class="docs-heading-anchor" href="#Training">Training</a><a id="Training-1"></a><a class="docs-heading-anchor-permalink" href="#Training" title="Permalink"></a></h3><p>Training a language model on <em>The Time Machine</em> dataset works in exactly the same manner as in :numref:<code>sec_rnn-scratch</code>.</p><pre><code class="language-julia hljs">
data = d2lai.TimeMachine(1024, 32) |&gt; f64
num_hiddens = 32
gru = GRUScratch(length(data.vocab), num_hiddens)
model = RNNLMScratch(gru, length(data.vocab)) |&gt; f64

opt = Flux.Optimiser(Descent(4.))
trainer = Trainer(model, data, opt; max_epochs = 50, gpu = true, gradient_clip_val = 1., board_yscale = :identity)
m, _ = d2lai.fit(trainer);</code></pre><pre><code class="nohighlight hljs">┌ Warning: `Flux.Optimiser(...)` has been removed, please call `OptimiserChain(...)`, exported by Flux from Optimisers.jl
└ @ Flux ~/.julia/packages/Flux/3711C/src/deprecations.jl:123</code></pre><div style="max-height:300px; overflow-y:auto; background:#111; color:#eee; padding:1em; border-radius:5px;">
<pre>    [ Info: Train Loss: 3.2184242686567512, Val Loss: 3.2269960270582736
    [ Info: Train Loss: 3.2454453056258905, Val Loss: 3.2233400344625514
    [ Info: Train Loss: 2.8841355975958765, Val Loss: 2.8731194300592233
    [ Info: Train Loss: 2.7898046894270685, Val Loss: 2.8037308224065485
    [ Info: Train Loss: 2.5843870460540694, Val Loss: 2.6258695969145234
    [ Info: Train Loss: 2.4063724115357905, Val Loss: 2.453611923331305
    [ Info: Train Loss: 2.415416327292373, Val Loss: 2.506989562880749
    [ Info: Train Loss: 2.404373422541069, Val Loss: 2.4955997954095204
    [ Info: Train Loss: 2.2991540681521214, Val Loss: 2.4030741950456034
    [ Info: Train Loss: 2.2380686502111518, Val Loss: 2.3496677874615557
    [ Info: Train Loss: 2.2160344959783105, Val Loss: 2.3097102311222133
    [ Info: Train Loss: 2.160869173837746, Val Loss: 2.29854513533635
    [ Info: Train Loss: 2.077997974431826, Val Loss: 2.231138762367394
    [ Info: Train Loss: 2.0833351048215807, Val Loss: 2.2593798571389896
    [ Info: Train Loss: 2.0961769420094343, Val Loss: 2.27601532142624
    [ Info: Train Loss: 2.0092783099523395, Val Loss: 2.2378415981662783
    [ Info: Train Loss: 1.9441608566346948, Val Loss: 2.1914365297876035
    [ Info: Train Loss: 1.9454186973462442, Val Loss: 2.1909205360976536
    [ Info: Train Loss: 1.8724455107508904, Val Loss: 2.1654439758077233
    [ Info: Train Loss: 1.844901557144545, Val Loss: 2.1182251459752157
    [ Info: Train Loss: 1.8571493771608898, Val Loss: 2.1366166955629877
    [ Info: Train Loss: 1.8059455275939191, Val Loss: 2.104911549191334
    [ Info: Train Loss: 1.8022015052802496, Val Loss: 2.110539009884125
    [ Info: Train Loss: 1.8044525638267326, Val Loss: 2.1456027220101546
    [ Info: Train Loss: 1.760190275081936, Val Loss: 2.146519146703094
    [ Info: Train Loss: 1.8046725429790846, Val Loss: 2.1234603832927132
    [ Info: Train Loss: 1.7089165009058387, Val Loss: 2.1040408011380296
    [ Info: Train Loss: 1.7301537289566153, Val Loss: 2.1384532000644554
    [ Info: Train Loss: 1.714251127287933, Val Loss: 2.1470684459738463
    [ Info: Train Loss: 1.753714758239141, Val Loss: 2.1316658729932394
    [ Info: Train Loss: 1.6730627533648612, Val Loss: 2.077867868639784
    [ Info: Train Loss: 1.686125681794478, Val Loss: 2.1165183212603287
    [ Info: Train Loss: 1.6663104575630032, Val Loss: 2.1275151298102486
    [ Info: Train Loss: 1.6966194258913012, Val Loss: 2.149117756127385
    [ Info: Train Loss: 1.6789002281898384, Val Loss: 2.113142040409992
    [ Info: Train Loss: 1.6844237244930536, Val Loss: 2.2100766855476075
    [ Info: Train Loss: 1.6817432332701305, Val Loss: 2.129683805353495
    [ Info: Train Loss: 1.6576786513569925, Val Loss: 2.167279203054727
    [ Info: Train Loss: 1.6466098162032732, Val Loss: 2.1500735133774542
    [ Info: Train Loss: 1.6328531530720538, Val Loss: 2.133672474304548
    [ Info: Train Loss: 1.6763602199190177, Val Loss: 2.13855564905406
    [ Info: Train Loss: 1.643408229422141, Val Loss: 2.170360410791563
    [ Info: Train Loss: 1.6175275959100741, Val Loss: 2.138300273277144
    [ Info: Train Loss: 1.6522226112745413, Val Loss: 2.145135452425993
    [ Info: Train Loss: 1.6194837421191595, Val Loss: 2.113611239460667
    [ Info: Train Loss: 1.6357478996341248, Val Loss: 2.097823757763224
    [ Info: Train Loss: 1.627988949563024, Val Loss: 2.10964227764902
    [ Info: Train Loss: 1.5979120103842122, Val Loss: 2.091956771996411
    [ Info: Train Loss: 1.619086510968669, Val Loss: 2.137214106365581
    [ Info: Train Loss: 1.595581656739759, Val Loss: 2.124241910512155</pre>
</div><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip090">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip090)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip091">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip090)" d="M140.696 1423.18 L2352.76 1423.18 L2352.76 47.2441 L140.696 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip092">
    <rect x="140" y="47" width="2213" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="160.712,1423.18 160.712,47.2441 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="586.6,1423.18 586.6,47.2441 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1012.49,1423.18 1012.49,47.2441 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1438.38,1423.18 1438.38,47.2441 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1864.26,1423.18 1864.26,47.2441 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2290.15,1423.18 2290.15,47.2441 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,1379.5 2352.76,1379.5 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,1063.57 2352.76,1063.57 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,747.636 2352.76,747.636 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,431.706 2352.76,431.706 "/>
<polyline clip-path="url(#clip092)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,115.777 2352.76,115.777 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,1423.18 2352.76,1423.18 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="160.712,1423.18 160.712,1404.28 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="586.6,1423.18 586.6,1404.28 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1012.49,1423.18 1012.49,1404.28 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1438.38,1423.18 1438.38,1404.28 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1864.26,1423.18 1864.26,1404.28 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2290.15,1423.18 2290.15,1404.28 "/>
<path clip-path="url(#clip090)" d="M160.712 1454.1 Q157.101 1454.1 155.272 1457.66 Q153.467 1461.2 153.467 1468.33 Q153.467 1475.44 155.272 1479.01 Q157.101 1482.55 160.712 1482.55 Q164.347 1482.55 166.152 1479.01 Q167.981 1475.44 167.981 1468.33 Q167.981 1461.2 166.152 1457.66 Q164.347 1454.1 160.712 1454.1 M160.712 1450.39 Q166.522 1450.39 169.578 1455 Q172.657 1459.58 172.657 1468.33 Q172.657 1477.06 169.578 1481.67 Q166.522 1486.25 160.712 1486.25 Q154.902 1486.25 151.823 1481.67 Q148.768 1477.06 148.768 1468.33 Q148.768 1459.58 151.823 1455 Q154.902 1450.39 160.712 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M561.288 1481.64 L568.926 1481.64 L568.926 1455.28 L560.616 1456.95 L560.616 1452.69 L568.88 1451.02 L573.556 1451.02 L573.556 1481.64 L581.195 1481.64 L581.195 1485.58 L561.288 1485.58 L561.288 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M600.639 1454.1 Q597.028 1454.1 595.199 1457.66 Q593.394 1461.2 593.394 1468.33 Q593.394 1475.44 595.199 1479.01 Q597.028 1482.55 600.639 1482.55 Q604.273 1482.55 606.079 1479.01 Q607.908 1475.44 607.908 1468.33 Q607.908 1461.2 606.079 1457.66 Q604.273 1454.1 600.639 1454.1 M600.639 1450.39 Q606.449 1450.39 609.505 1455 Q612.584 1459.58 612.584 1468.33 Q612.584 1477.06 609.505 1481.67 Q606.449 1486.25 600.639 1486.25 Q594.829 1486.25 591.75 1481.67 Q588.695 1477.06 588.695 1468.33 Q588.695 1459.58 591.75 1455 Q594.829 1450.39 600.639 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M991.261 1481.64 L1007.58 1481.64 L1007.58 1485.58 L985.636 1485.58 L985.636 1481.64 Q988.298 1478.89 992.881 1474.26 Q997.488 1469.61 998.668 1468.27 Q1000.91 1465.74 1001.79 1464.01 Q1002.7 1462.25 1002.7 1460.56 Q1002.7 1457.8 1000.75 1456.07 Q998.83 1454.33 995.728 1454.33 Q993.529 1454.33 991.076 1455.09 Q988.645 1455.86 985.867 1457.41 L985.867 1452.69 Q988.691 1451.55 991.145 1450.97 Q993.599 1450.39 995.636 1450.39 Q1001.01 1450.39 1004.2 1453.08 Q1007.39 1455.77 1007.39 1460.26 Q1007.39 1462.39 1006.58 1464.31 Q1005.8 1466.2 1003.69 1468.8 Q1003.11 1469.47 1000.01 1472.69 Q996.909 1475.88 991.261 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1027.39 1454.1 Q1023.78 1454.1 1021.96 1457.66 Q1020.15 1461.2 1020.15 1468.33 Q1020.15 1475.44 1021.96 1479.01 Q1023.78 1482.55 1027.39 1482.55 Q1031.03 1482.55 1032.83 1479.01 Q1034.66 1475.44 1034.66 1468.33 Q1034.66 1461.2 1032.83 1457.66 Q1031.03 1454.1 1027.39 1454.1 M1027.39 1450.39 Q1033.21 1450.39 1036.26 1455 Q1039.34 1459.58 1039.34 1468.33 Q1039.34 1477.06 1036.26 1481.67 Q1033.21 1486.25 1027.39 1486.25 Q1021.58 1486.25 1018.51 1481.67 Q1015.45 1477.06 1015.45 1468.33 Q1015.45 1459.58 1018.51 1455 Q1021.58 1450.39 1027.39 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1427.22 1466.95 Q1430.57 1467.66 1432.45 1469.93 Q1434.35 1472.2 1434.35 1475.53 Q1434.35 1480.65 1430.83 1483.45 Q1427.31 1486.25 1420.83 1486.25 Q1418.65 1486.25 1416.34 1485.81 Q1414.05 1485.39 1411.59 1484.54 L1411.59 1480.02 Q1413.54 1481.16 1415.85 1481.74 Q1418.17 1482.32 1420.69 1482.32 Q1425.09 1482.32 1427.38 1480.58 Q1429.69 1478.84 1429.69 1475.53 Q1429.69 1472.48 1427.54 1470.77 Q1425.41 1469.03 1421.59 1469.03 L1417.57 1469.03 L1417.57 1465.19 L1421.78 1465.19 Q1425.23 1465.19 1427.06 1463.82 Q1428.88 1462.43 1428.88 1459.84 Q1428.88 1457.18 1426.99 1455.77 Q1425.11 1454.33 1421.59 1454.33 Q1419.67 1454.33 1417.47 1454.75 Q1415.27 1455.16 1412.63 1456.04 L1412.63 1451.88 Q1415.3 1451.14 1417.61 1450.77 Q1419.95 1450.39 1422.01 1450.39 Q1427.33 1450.39 1430.44 1452.83 Q1433.54 1455.23 1433.54 1459.35 Q1433.54 1462.22 1431.89 1464.21 Q1430.25 1466.18 1427.22 1466.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1453.21 1454.1 Q1449.6 1454.1 1447.77 1457.66 Q1445.97 1461.2 1445.97 1468.33 Q1445.97 1475.44 1447.77 1479.01 Q1449.6 1482.55 1453.21 1482.55 Q1456.85 1482.55 1458.65 1479.01 Q1460.48 1475.44 1460.48 1468.33 Q1460.48 1461.2 1458.65 1457.66 Q1456.85 1454.1 1453.21 1454.1 M1453.21 1450.39 Q1459.02 1450.39 1462.08 1455 Q1465.16 1459.58 1465.16 1468.33 Q1465.16 1477.06 1462.08 1481.67 Q1459.02 1486.25 1453.21 1486.25 Q1447.4 1486.25 1444.32 1481.67 Q1441.27 1477.06 1441.27 1468.33 Q1441.27 1459.58 1444.32 1455 Q1447.4 1450.39 1453.21 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1852.43 1455.09 L1840.63 1473.54 L1852.43 1473.54 L1852.43 1455.09 M1851.21 1451.02 L1857.09 1451.02 L1857.09 1473.54 L1862.02 1473.54 L1862.02 1477.43 L1857.09 1477.43 L1857.09 1485.58 L1852.43 1485.58 L1852.43 1477.43 L1836.83 1477.43 L1836.83 1472.92 L1851.21 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1879.75 1454.1 Q1876.14 1454.1 1874.31 1457.66 Q1872.5 1461.2 1872.5 1468.33 Q1872.5 1475.44 1874.31 1479.01 Q1876.14 1482.55 1879.75 1482.55 Q1883.38 1482.55 1885.19 1479.01 Q1887.02 1475.44 1887.02 1468.33 Q1887.02 1461.2 1885.19 1457.66 Q1883.38 1454.1 1879.75 1454.1 M1879.75 1450.39 Q1885.56 1450.39 1888.61 1455 Q1891.69 1459.58 1891.69 1468.33 Q1891.69 1477.06 1888.61 1481.67 Q1885.56 1486.25 1879.75 1486.25 Q1873.94 1486.25 1870.86 1481.67 Q1867.8 1477.06 1867.8 1468.33 Q1867.8 1459.58 1870.86 1455 Q1873.94 1450.39 1879.75 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2264.85 1451.02 L2283.21 1451.02 L2283.21 1454.96 L2269.13 1454.96 L2269.13 1463.43 Q2270.15 1463.08 2271.17 1462.92 Q2272.19 1462.73 2273.21 1462.73 Q2278.99 1462.73 2282.37 1465.9 Q2285.75 1469.08 2285.75 1474.49 Q2285.75 1480.07 2282.28 1483.17 Q2278.81 1486.25 2272.49 1486.25 Q2270.31 1486.25 2268.04 1485.88 Q2265.8 1485.51 2263.39 1484.77 L2263.39 1480.07 Q2265.47 1481.2 2267.7 1481.76 Q2269.92 1482.32 2272.4 1482.32 Q2276.4 1482.32 2278.74 1480.21 Q2281.08 1478.1 2281.08 1474.49 Q2281.08 1470.88 2278.74 1468.77 Q2276.4 1466.67 2272.4 1466.67 Q2270.52 1466.67 2268.65 1467.08 Q2266.79 1467.5 2264.85 1468.38 L2264.85 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2304.97 1454.1 Q2301.35 1454.1 2299.53 1457.66 Q2297.72 1461.2 2297.72 1468.33 Q2297.72 1475.44 2299.53 1479.01 Q2301.35 1482.55 2304.97 1482.55 Q2308.6 1482.55 2310.4 1479.01 Q2312.23 1475.44 2312.23 1468.33 Q2312.23 1461.2 2310.4 1457.66 Q2308.6 1454.1 2304.97 1454.1 M2304.97 1450.39 Q2310.78 1450.39 2313.83 1455 Q2316.91 1459.58 2316.91 1468.33 Q2316.91 1477.06 2313.83 1481.67 Q2310.78 1486.25 2304.97 1486.25 Q2299.16 1486.25 2296.08 1481.67 Q2293.02 1477.06 2293.02 1468.33 Q2293.02 1459.58 2296.08 1455 Q2299.16 1450.39 2304.97 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1166.92 1548.76 L1166.92 1551.62 L1139.99 1551.62 Q1140.37 1557.67 1143.62 1560.85 Q1146.9 1564 1152.72 1564 Q1156.09 1564 1159.25 1563.17 Q1162.43 1562.35 1165.55 1560.69 L1165.55 1566.23 Q1162.4 1567.57 1159.09 1568.27 Q1155.78 1568.97 1152.37 1568.97 Q1143.84 1568.97 1138.84 1564 Q1133.88 1559.04 1133.88 1550.57 Q1133.88 1541.82 1138.59 1536.69 Q1143.33 1531.54 1151.35 1531.54 Q1158.54 1531.54 1162.71 1536.18 Q1166.92 1540.8 1166.92 1548.76 M1161.06 1547.04 Q1161 1542.23 1158.35 1539.37 Q1155.74 1536.5 1151.42 1536.5 Q1146.51 1536.5 1143.55 1539.27 Q1140.63 1542.04 1140.18 1547.07 L1161.06 1547.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1182.19 1562.7 L1182.19 1581.6 L1176.31 1581.6 L1176.31 1532.4 L1182.19 1532.4 L1182.19 1537.81 Q1184.04 1534.62 1186.84 1533.1 Q1189.67 1531.54 1193.59 1531.54 Q1200.08 1531.54 1204.12 1536.69 Q1208.2 1541.85 1208.2 1550.25 Q1208.2 1558.65 1204.12 1563.81 Q1200.08 1568.97 1193.59 1568.97 Q1189.67 1568.97 1186.84 1567.44 Q1184.04 1565.88 1182.19 1562.7 M1202.12 1550.25 Q1202.12 1543.79 1199.44 1540.13 Q1196.8 1536.44 1192.16 1536.44 Q1187.51 1536.44 1184.84 1540.13 Q1182.19 1543.79 1182.19 1550.25 Q1182.19 1556.71 1184.84 1560.4 Q1187.51 1564.07 1192.16 1564.07 Q1196.8 1564.07 1199.44 1560.4 Q1202.12 1556.71 1202.12 1550.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1231.72 1536.5 Q1227.01 1536.5 1224.27 1540.19 Q1221.53 1543.85 1221.53 1550.25 Q1221.53 1556.65 1224.24 1560.34 Q1226.98 1564 1231.72 1564 Q1236.4 1564 1239.13 1560.31 Q1241.87 1556.62 1241.87 1550.25 Q1241.87 1543.92 1239.13 1540.23 Q1236.4 1536.5 1231.72 1536.5 M1231.72 1531.54 Q1239.36 1531.54 1243.72 1536.5 Q1248.08 1541.47 1248.08 1550.25 Q1248.08 1559 1243.72 1564 Q1239.36 1568.97 1231.72 1568.97 Q1224.05 1568.97 1219.69 1564 Q1215.36 1559 1215.36 1550.25 Q1215.36 1541.47 1219.69 1536.5 Q1224.05 1531.54 1231.72 1531.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1283.44 1533.76 L1283.44 1539.24 Q1280.96 1537.87 1278.44 1537.2 Q1275.96 1536.5 1273.41 1536.5 Q1267.72 1536.5 1264.57 1540.13 Q1261.41 1543.73 1261.41 1550.25 Q1261.41 1556.78 1264.57 1560.4 Q1267.72 1564 1273.41 1564 Q1275.96 1564 1278.44 1563.33 Q1280.96 1562.63 1283.44 1561.26 L1283.44 1566.68 Q1280.99 1567.82 1278.35 1568.39 Q1275.74 1568.97 1272.78 1568.97 Q1264.72 1568.97 1259.98 1563.91 Q1255.24 1558.85 1255.24 1550.25 Q1255.24 1541.53 1260.01 1536.53 Q1264.82 1531.54 1273.16 1531.54 Q1275.86 1531.54 1278.44 1532.11 Q1281.02 1532.65 1283.44 1533.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1323.26 1546.53 L1323.26 1568.04 L1317.4 1568.04 L1317.4 1546.72 Q1317.4 1541.66 1315.43 1539.14 Q1313.45 1536.63 1309.51 1536.63 Q1304.77 1536.63 1302.03 1539.65 Q1299.29 1542.68 1299.29 1547.9 L1299.29 1568.04 L1293.4 1568.04 L1293.4 1518.52 L1299.29 1518.52 L1299.29 1537.93 Q1301.39 1534.72 1304.22 1533.13 Q1307.09 1531.54 1310.81 1531.54 Q1316.96 1531.54 1320.11 1535.36 Q1323.26 1539.14 1323.26 1546.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M1357.66 1533.45 L1357.66 1538.98 Q1355.18 1537.71 1352.51 1537.07 Q1349.83 1536.44 1346.97 1536.44 Q1342.61 1536.44 1340.41 1537.77 Q1338.25 1539.11 1338.25 1541.79 Q1338.25 1543.82 1339.81 1545 Q1341.37 1546.15 1346.08 1547.2 L1348.08 1547.64 Q1354.32 1548.98 1356.93 1551.43 Q1359.57 1553.85 1359.57 1558.21 Q1359.57 1563.17 1355.63 1566.07 Q1351.71 1568.97 1344.84 1568.97 Q1341.97 1568.97 1338.85 1568.39 Q1335.77 1567.85 1332.33 1566.74 L1332.33 1560.69 Q1335.58 1562.38 1338.73 1563.24 Q1341.88 1564.07 1344.96 1564.07 Q1349.1 1564.07 1351.33 1562.66 Q1353.56 1561.23 1353.56 1558.65 Q1353.56 1556.27 1351.93 1554.99 Q1350.34 1553.72 1344.9 1552.54 L1342.86 1552.07 Q1337.42 1550.92 1335 1548.56 Q1332.58 1546.18 1332.58 1542.04 Q1332.58 1537.01 1336.15 1534.27 Q1339.71 1531.54 1346.27 1531.54 Q1349.52 1531.54 1352.38 1532.01 Q1355.25 1532.49 1357.66 1533.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,1423.18 140.696,47.2441 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,1379.5 159.593,1379.5 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,1063.57 159.593,1063.57 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,747.636 159.593,747.636 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,431.706 159.593,431.706 "/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,115.777 159.593,115.777 "/>
<path clip-path="url(#clip090)" d="M83.7929 1362.22 L102.149 1362.22 L102.149 1366.15 L88.0753 1366.15 L88.0753 1374.62 Q89.0938 1374.28 90.1123 1374.11 Q91.1308 1373.93 92.1493 1373.93 Q97.9363 1373.93 101.316 1377.1 Q104.696 1380.27 104.696 1385.69 Q104.696 1391.27 101.223 1394.37 Q97.7511 1397.45 91.4317 1397.45 Q89.2558 1397.45 86.9873 1397.08 Q84.7419 1396.71 82.3346 1395.97 L82.3346 1391.27 Q84.4179 1392.4 86.6401 1392.96 Q88.8623 1393.51 91.3391 1393.51 Q95.3437 1393.51 97.6817 1391.41 Q100.02 1389.3 100.02 1385.69 Q100.02 1382.08 97.6817 1379.97 Q95.3437 1377.86 91.3391 1377.86 Q89.4641 1377.86 87.5892 1378.28 Q85.7373 1378.7 83.7929 1379.58 L83.7929 1362.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M53.3995 1076.91 L61.0384 1076.91 L61.0384 1050.55 L52.7282 1052.21 L52.7282 1047.95 L60.9921 1046.29 L65.668 1046.29 L65.668 1076.91 L73.3068 1076.91 L73.3068 1080.85 L53.3995 1080.85 L53.3995 1076.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M92.7512 1049.36 Q89.1401 1049.36 87.3114 1052.93 Q85.5058 1056.47 85.5058 1063.6 Q85.5058 1070.71 87.3114 1074.27 Q89.1401 1077.81 92.7512 1077.81 Q96.3854 1077.81 98.1909 1074.27 Q100.02 1070.71 100.02 1063.6 Q100.02 1056.47 98.1909 1052.93 Q96.3854 1049.36 92.7512 1049.36 M92.7512 1045.66 Q98.5613 1045.66 101.617 1050.27 Q104.696 1054.85 104.696 1063.6 Q104.696 1072.33 101.617 1076.93 Q98.5613 1081.52 92.7512 1081.52 Q86.941 1081.52 83.8623 1076.93 Q80.8068 1072.33 80.8068 1063.6 Q80.8068 1054.85 83.8623 1050.27 Q86.941 1045.66 92.7512 1045.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M54.3949 760.981 L62.0337 760.981 L62.0337 734.615 L53.7236 736.282 L53.7236 732.023 L61.9874 730.356 L66.6633 730.356 L66.6633 760.981 L74.3022 760.981 L74.3022 764.916 L54.3949 764.916 L54.3949 760.981 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M83.7929 730.356 L102.149 730.356 L102.149 734.291 L88.0753 734.291 L88.0753 742.764 Q89.0938 742.416 90.1123 742.254 Q91.1308 742.069 92.1493 742.069 Q97.9363 742.069 101.316 745.24 Q104.696 748.412 104.696 753.828 Q104.696 759.407 101.223 762.509 Q97.7511 765.587 91.4317 765.587 Q89.2558 765.587 86.9873 765.217 Q84.7419 764.847 82.3346 764.106 L82.3346 759.407 Q84.4179 760.541 86.6401 761.097 Q88.8623 761.652 91.3391 761.652 Q95.3437 761.652 97.6817 759.546 Q100.02 757.439 100.02 753.828 Q100.02 750.217 97.6817 748.111 Q95.3437 746.004 91.3391 746.004 Q89.4641 746.004 87.5892 746.421 Q85.7373 746.838 83.7929 747.717 L83.7929 730.356 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M56.6171 445.051 L72.9365 445.051 L72.9365 448.986 L50.9921 448.986 L50.9921 445.051 Q53.6541 442.297 58.2375 437.667 Q62.8439 433.014 64.0245 431.672 Q66.2698 429.149 67.1494 427.412 Q68.0522 425.653 68.0522 423.963 Q68.0522 421.209 66.1078 419.473 Q64.1865 417.737 61.0847 417.737 Q58.8856 417.737 56.4319 418.5 Q54.0014 419.264 51.2236 420.815 L51.2236 416.093 Q54.0477 414.959 56.5014 414.38 Q58.955 413.801 60.9921 413.801 Q66.3624 413.801 69.5568 416.487 Q72.7513 419.172 72.7513 423.662 Q72.7513 425.792 71.9411 427.713 Q71.1541 429.611 69.0476 432.204 Q68.4689 432.875 65.367 436.093 Q62.2652 439.287 56.6171 445.051 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M92.7512 417.505 Q89.1401 417.505 87.3114 421.07 Q85.5058 424.611 85.5058 431.741 Q85.5058 438.848 87.3114 442.412 Q89.1401 445.954 92.7512 445.954 Q96.3854 445.954 98.1909 442.412 Q100.02 438.848 100.02 431.741 Q100.02 424.611 98.1909 421.07 Q96.3854 417.505 92.7512 417.505 M92.7512 413.801 Q98.5613 413.801 101.617 418.408 Q104.696 422.991 104.696 431.741 Q104.696 440.468 101.617 445.074 Q98.5613 449.658 92.7512 449.658 Q86.941 449.658 83.8623 445.074 Q80.8068 440.468 80.8068 431.741 Q80.8068 422.991 83.8623 418.408 Q86.941 413.801 92.7512 413.801 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M57.6125 129.121 L73.9318 129.121 L73.9318 133.057 L51.9875 133.057 L51.9875 129.121 Q54.6495 126.367 59.2328 121.737 Q63.8393 117.084 65.0198 115.742 Q67.2652 113.219 68.1448 111.483 Q69.0476 109.723 69.0476 108.034 Q69.0476 105.279 67.1032 103.543 Q65.1819 101.807 62.08 101.807 Q59.881 101.807 57.4273 102.571 Q54.9967 103.334 52.219 104.885 L52.219 100.163 Q55.043 99.0289 57.4967 98.4502 Q59.9504 97.8715 61.9874 97.8715 Q67.3578 97.8715 70.5522 100.557 Q73.7466 103.242 73.7466 107.733 Q73.7466 109.862 72.9365 111.783 Q72.1494 113.682 70.0429 116.274 Q69.4642 116.945 66.3624 120.163 Q63.2606 123.357 57.6125 129.121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M83.7929 98.4965 L102.149 98.4965 L102.149 102.432 L88.0753 102.432 L88.0753 110.904 Q89.0938 110.557 90.1123 110.395 Q91.1308 110.209 92.1493 110.209 Q97.9363 110.209 101.316 113.381 Q104.696 116.552 104.696 121.969 Q104.696 127.547 101.223 130.649 Q97.7511 133.728 91.4317 133.728 Q89.2558 133.728 86.9873 133.357 Q84.7419 132.987 82.3346 132.246 L82.3346 127.547 Q84.4179 128.682 86.6401 129.237 Q88.8623 129.793 91.3391 129.793 Q95.3437 129.793 97.6817 127.686 Q100.02 125.58 100.02 121.969 Q100.02 118.358 97.6817 116.251 Q95.3437 114.145 91.3391 114.145 Q89.4641 114.145 87.5892 114.561 Q85.7373 114.978 83.7929 115.858 L83.7929 98.4965 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip092)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="203.301,98.9414 245.89,86.1857 288.479,431.407 331.067,647.043 373.656,776.124 416.245,846.005 458.834,917.809 501.422,977.781 544.011,1025.82 586.6,1064.66 629.189,1107.45 671.777,1130.96 714.366,1168.18 756.955,1190.06 799.544,1209.83 842.132,1232.05 884.721,1245.12 927.31,1261.44 969.899,1270.06 1012.49,1278.21 1055.08,1284.73 1097.67,1297.87 1140.25,1306.73 1182.84,1313.59 1225.43,1318 1268.02,1325.18 1310.61,1330.86 1353.2,1330.09 1395.79,1336.62 1438.38,1339.47 1480.96,1346.3 1523.55,1347.95 1566.14,1350.1 1608.73,1355.85 1651.32,1354.69 1693.91,1358.44 1736.5,1360.69 1779.09,1364.04 1821.67,1367.15 1864.26,1366.66 1906.85,1368.57 1949.44,1369.61 1992.03,1376.96 2034.62,1369.73 2077.21,1373.55 2119.8,1380.5 2162.38,1378.41 2204.97,1376.78 2247.56,1380.6 2290.15,1384.24 "/>
<polyline clip-path="url(#clip092)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="203.301,122.849 245.89,105.393 288.479,586.68 331.067,685.468 373.656,873.135 416.245,1006.83 458.834,967.349 501.422,965.153 544.011,1043.91 586.6,1065.78 629.189,1064.87 671.777,1091.31 714.366,1115.88 756.955,1103.43 799.544,1093.85 842.132,1125.05 884.721,1151.94 927.31,1148.4 969.899,1163.01 1012.49,1184.22 1055.08,1163.52 1097.67,1195.91 1140.25,1174.83 1182.84,1166.03 1225.43,1155.39 1268.02,1171.57 1310.61,1187.8 1353.2,1171.86 1395.79,1170.57 1438.38,1178.34 1480.96,1219.03 1523.55,1199.58 1566.14,1189.64 1608.73,1159.43 1651.32,1189.71 1693.91,1146.73 1736.5,1163.99 1779.09,1157.29 1821.67,1180.29 1864.26,1185.74 1906.85,1166.96 1949.44,1163.26 1992.03,1195.05 2034.62,1178.17 2077.21,1171.6 2119.8,1172.41 2162.38,1168.93 2204.97,1181.72 2247.56,1159.98 2290.15,1183.07 "/>
<path clip-path="url(#clip090)" d="M1856.13 248.629 L2279.02 248.629 L2279.02 93.1086 L1856.13 93.1086  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip090)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1856.13,248.629 2279.02,248.629 2279.02,93.1086 1856.13,93.1086 1856.13,248.629 "/>
<polyline clip-path="url(#clip090)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1880.7,144.949 2028.17,144.949 "/>
<path clip-path="url(#clip090)" d="M2060.16 128.942 L2060.16 136.303 L2068.93 136.303 L2068.93 139.613 L2060.16 139.613 L2060.16 153.687 Q2060.16 156.858 2061.02 157.761 Q2061.9 158.664 2064.56 158.664 L2068.93 158.664 L2068.93 162.229 L2064.56 162.229 Q2059.63 162.229 2057.75 160.4 Q2055.88 158.548 2055.88 153.687 L2055.88 139.613 L2052.75 139.613 L2052.75 136.303 L2055.88 136.303 L2055.88 128.942 L2060.16 128.942 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2089.56 140.284 Q2088.84 139.868 2087.98 139.682 Q2087.15 139.474 2086.13 139.474 Q2082.52 139.474 2080.58 141.835 Q2078.66 144.173 2078.66 148.571 L2078.66 162.229 L2074.37 162.229 L2074.37 136.303 L2078.66 136.303 L2078.66 140.331 Q2080 137.969 2082.15 136.835 Q2084.3 135.678 2087.38 135.678 Q2087.82 135.678 2088.36 135.747 Q2088.89 135.794 2089.54 135.909 L2089.56 140.284 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2105.81 149.196 Q2100.65 149.196 2098.66 150.377 Q2096.67 151.557 2096.67 154.405 Q2096.67 156.673 2098.15 158.016 Q2099.65 159.335 2102.22 159.335 Q2105.76 159.335 2107.89 156.835 Q2110.04 154.312 2110.04 150.145 L2110.04 149.196 L2105.81 149.196 M2114.3 147.437 L2114.3 162.229 L2110.04 162.229 L2110.04 158.293 Q2108.59 160.655 2106.41 161.789 Q2104.23 162.9 2101.09 162.9 Q2097.1 162.9 2094.74 160.678 Q2092.41 158.432 2092.41 154.682 Q2092.41 150.307 2095.32 148.085 Q2098.26 145.863 2104.07 145.863 L2110.04 145.863 L2110.04 145.446 Q2110.04 142.507 2108.1 140.909 Q2106.18 139.289 2102.68 139.289 Q2100.46 139.289 2098.35 139.821 Q2096.25 140.354 2094.3 141.419 L2094.3 137.483 Q2096.64 136.581 2098.84 136.141 Q2101.04 135.678 2103.12 135.678 Q2108.75 135.678 2111.53 138.594 Q2114.3 141.511 2114.3 147.437 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2123.08 136.303 L2127.34 136.303 L2127.34 162.229 L2123.08 162.229 L2123.08 136.303 M2123.08 126.21 L2127.34 126.21 L2127.34 131.604 L2123.08 131.604 L2123.08 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2157.8 146.581 L2157.8 162.229 L2153.54 162.229 L2153.54 146.719 Q2153.54 143.039 2152.1 141.21 Q2150.67 139.382 2147.8 139.382 Q2144.35 139.382 2142.36 141.581 Q2140.37 143.78 2140.37 147.576 L2140.37 162.229 L2136.09 162.229 L2136.09 136.303 L2140.37 136.303 L2140.37 140.331 Q2141.9 137.993 2143.96 136.835 Q2146.04 135.678 2148.75 135.678 Q2153.22 135.678 2155.51 138.456 Q2157.8 141.21 2157.8 146.581 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2185.99 170.099 L2185.99 173.409 L2161.36 173.409 L2161.36 170.099 L2185.99 170.099 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2194.12 158.34 L2194.12 172.09 L2189.84 172.09 L2189.84 136.303 L2194.12 136.303 L2194.12 140.238 Q2195.46 137.923 2197.5 136.812 Q2199.56 135.678 2202.41 135.678 Q2207.13 135.678 2210.07 139.428 Q2213.03 143.178 2213.03 149.289 Q2213.03 155.4 2210.07 159.15 Q2207.13 162.9 2202.41 162.9 Q2199.56 162.9 2197.5 161.789 Q2195.46 160.655 2194.12 158.34 M2208.61 149.289 Q2208.61 144.59 2206.66 141.928 Q2204.74 139.243 2201.36 139.243 Q2197.98 139.243 2196.04 141.928 Q2194.12 144.59 2194.12 149.289 Q2194.12 153.988 2196.04 156.673 Q2197.98 159.335 2201.36 159.335 Q2204.74 159.335 2206.66 156.673 Q2208.61 153.988 2208.61 149.289 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2224.21 158.34 L2224.21 172.09 L2219.93 172.09 L2219.93 136.303 L2224.21 136.303 L2224.21 140.238 Q2225.55 137.923 2227.59 136.812 Q2229.65 135.678 2232.5 135.678 Q2237.22 135.678 2240.16 139.428 Q2243.12 143.178 2243.12 149.289 Q2243.12 155.4 2240.16 159.15 Q2237.22 162.9 2232.5 162.9 Q2229.65 162.9 2227.59 161.789 Q2225.55 160.655 2224.21 158.34 M2238.7 149.289 Q2238.7 144.59 2236.76 141.928 Q2234.84 139.243 2231.46 139.243 Q2228.08 139.243 2226.13 141.928 Q2224.21 144.59 2224.21 149.289 Q2224.21 153.988 2226.13 156.673 Q2228.08 159.335 2231.46 159.335 Q2234.84 159.335 2236.76 156.673 Q2238.7 153.988 2238.7 149.289 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2250.18 126.21 L2254.44 126.21 L2254.44 162.229 L2250.18 162.229 L2250.18 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip090)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1880.7,196.789 2028.17,196.789 "/>
<path clip-path="url(#clip090)" d="M2052.75 188.143 L2057.27 188.143 L2065.37 209.902 L2073.47 188.143 L2077.98 188.143 L2068.26 214.069 L2062.48 214.069 L2052.75 188.143 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2095.65 201.036 Q2090.48 201.036 2088.49 202.217 Q2086.5 203.397 2086.5 206.245 Q2086.5 208.513 2087.98 209.856 Q2089.49 211.175 2092.06 211.175 Q2095.6 211.175 2097.73 208.675 Q2099.88 206.152 2099.88 201.985 L2099.88 201.036 L2095.65 201.036 M2104.14 199.277 L2104.14 214.069 L2099.88 214.069 L2099.88 210.133 Q2098.42 212.495 2096.25 213.629 Q2094.07 214.74 2090.92 214.74 Q2086.94 214.74 2084.58 212.518 Q2082.24 210.272 2082.24 206.522 Q2082.24 202.147 2085.16 199.925 Q2088.1 197.703 2093.91 197.703 L2099.88 197.703 L2099.88 197.286 Q2099.88 194.347 2097.94 192.749 Q2096.02 191.129 2092.52 191.129 Q2090.3 191.129 2088.19 191.661 Q2086.09 192.194 2084.14 193.259 L2084.14 189.323 Q2086.48 188.421 2088.68 187.981 Q2090.88 187.518 2092.96 187.518 Q2098.59 187.518 2101.36 190.434 Q2104.14 193.351 2104.14 199.277 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2112.92 178.05 L2117.17 178.05 L2117.17 214.069 L2112.92 214.069 L2112.92 178.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2145.79 221.939 L2145.79 225.249 L2121.16 225.249 L2121.16 221.939 L2145.79 221.939 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2153.91 210.18 L2153.91 223.93 L2149.63 223.93 L2149.63 188.143 L2153.91 188.143 L2153.91 192.078 Q2155.25 189.763 2157.29 188.652 Q2159.35 187.518 2162.2 187.518 Q2166.92 187.518 2169.86 191.268 Q2172.82 195.018 2172.82 201.129 Q2172.82 207.24 2169.86 210.99 Q2166.92 214.74 2162.2 214.74 Q2159.35 214.74 2157.29 213.629 Q2155.25 212.495 2153.91 210.18 M2168.4 201.129 Q2168.4 196.43 2166.46 193.768 Q2164.54 191.083 2161.16 191.083 Q2157.78 191.083 2155.83 193.768 Q2153.91 196.43 2153.91 201.129 Q2153.91 205.828 2155.83 208.513 Q2157.78 211.175 2161.16 211.175 Q2164.54 211.175 2166.46 208.513 Q2168.4 205.828 2168.4 201.129 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2184 210.18 L2184 223.93 L2179.72 223.93 L2179.72 188.143 L2184 188.143 L2184 192.078 Q2185.35 189.763 2187.38 188.652 Q2189.44 187.518 2192.29 187.518 Q2197.01 187.518 2199.95 191.268 Q2202.91 195.018 2202.91 201.129 Q2202.91 207.24 2199.95 210.99 Q2197.01 214.74 2192.29 214.74 Q2189.44 214.74 2187.38 213.629 Q2185.35 212.495 2184 210.18 M2198.49 201.129 Q2198.49 196.43 2196.55 193.768 Q2194.63 191.083 2191.25 191.083 Q2187.87 191.083 2185.92 193.768 Q2184 196.43 2184 201.129 Q2184 205.828 2185.92 208.513 Q2187.87 211.175 2191.25 211.175 Q2194.63 211.175 2196.55 208.513 Q2198.49 205.828 2198.49 201.129 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip090)" d="M2209.97 178.05 L2214.23 178.05 L2214.23 214.069 L2209.97 214.069 L2209.97 178.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg><pre><code class="language-julia hljs">prefix = &quot;it has&quot;
d2lai.prediction(prefix, m, data.vocab, 20)</code></pre><pre><code class="nohighlight hljs">&quot;it has surfeen and and and&quot;</code></pre><h2 id="Concise-Implementation"><a class="docs-heading-anchor" href="#Concise-Implementation">Concise Implementation</a><a id="Concise-Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Concise-Implementation" title="Permalink"></a></h2><p>In high-level APIs, we can directly instantiate a GRU model. This encapsulates all the configuration detail that we made explicit above.</p><pre><code class="language-julia hljs">gru = GRU(length(data.vocab) =&gt; num_hiddens; return_state = true) |&gt; f64</code></pre><pre><code class="nohighlight hljs">GRU(28 =&gt; 32)       # 5_856 parameters</code></pre><p>The code is significantly faster in training as it uses compiled operators  rather than Python.</p><pre><code class="language-julia hljs">model = RNNModelConcise(gru, num_hiddens, length(data.vocab)) |&gt; f64

opt = Flux.Optimiser(Descent(4.))
trainer = Trainer(model, data, opt; max_epochs = 50, gpu = true, gradient_clip_val = 1., board_yscale = :identity)
m, _ = d2lai.fit(trainer);</code></pre><div style="max-height:300px; overflow-y:auto; background:#111; color:#eee; padding:1em; border-radius:5px;">
<pre>    [ Info: Train Loss: 3.339843, Val Loss: 3.312427
    [ Info: Train Loss: 3.0337014, Val Loss: 3.0180933
    [ Info: Train Loss: 2.884366, Val Loss: 2.8980086
    [ Info: Train Loss: 2.8016486, Val Loss: 2.847144
    [ Info: Train Loss: 2.5892751, Val Loss: 2.6466618
    [ Info: Train Loss: 2.571692, Val Loss: 2.6829135
    [ Info: Train Loss: 2.296868, Val Loss: 2.4164293
    [ Info: Train Loss: 2.2367384, Val Loss: 2.3546956
    [ Info: Train Loss: 2.125788, Val Loss: 2.2762396
    [ Info: Train Loss: 2.2237732, Val Loss: 2.3819647
    [ Info: Train Loss: 2.1239038, Val Loss: 2.3075745
    [ Info: Train Loss: 2.0849369, Val Loss: 2.310408
    [ Info: Train Loss: 1.996697, Val Loss: 2.2265015
    [ Info: Train Loss: 1.9640743, Val Loss: 2.2453709
    [ Info: Train Loss: 1.9234996, Val Loss: 2.2496967
    [ Info: Train Loss: 1.8941792, Val Loss: 2.1987276
    [ Info: Train Loss: 1.8709935, Val Loss: 2.1941028
    [ Info: Train Loss: 1.8494147, Val Loss: 2.1791139
    [ Info: Train Loss: 1.8232733, Val Loss: 2.1584883
    [ Info: Train Loss: 1.8160797, Val Loss: 2.1821036
    [ Info: Train Loss: 1.8234555, Val Loss: 2.1965368
    [ Info: Train Loss: 1.8221275, Val Loss: 2.1924026
    [ Info: Train Loss: 1.7592524, Val Loss: 2.1596148
    [ Info: Train Loss: 1.7351427, Val Loss: 2.2111495
    [ Info: Train Loss: 1.7387463, Val Loss: 2.1325395
    [ Info: Train Loss: 1.7577927, Val Loss: 2.1458294
    [ Info: Train Loss: 1.7149017, Val Loss: 2.1555128
    [ Info: Train Loss: 1.7009236, Val Loss: 2.1802876
    [ Info: Train Loss: 1.6960799, Val Loss: 2.1415792
    [ Info: Train Loss: 1.7019024, Val Loss: 2.1644964
    [ Info: Train Loss: 1.6962849, Val Loss: 2.1717067
    [ Info: Train Loss: 1.662441, Val Loss: 2.1127226
    [ Info: Train Loss: 1.6471889, Val Loss: 2.1438167
    [ Info: Train Loss: 1.6382595, Val Loss: 2.136528
    [ Info: Train Loss: 1.640606, Val Loss: 2.1420505
    [ Info: Train Loss: 1.6557862, Val Loss: 2.132759
    [ Info: Train Loss: 1.6378021, Val Loss: 2.132157
    [ Info: Train Loss: 1.6483008, Val Loss: 2.1438074
    [ Info: Train Loss: 1.6278783, Val Loss: 2.1374648
    [ Info: Train Loss: 1.6036717, Val Loss: 2.159356
    [ Info: Train Loss: 1.6073177, Val Loss: 2.0879977
    [ Info: Train Loss: 1.6344908, Val Loss: 2.1560361
    [ Info: Train Loss: 1.5891083, Val Loss: 2.1251879
    [ Info: Train Loss: 1.6216028, Val Loss: 2.134575
    [ Info: Train Loss: 1.6479585, Val Loss: 2.1918073
    [ Info: Train Loss: 1.6001322, Val Loss: 2.1128173
    [ Info: Train Loss: 1.618749, Val Loss: 2.1110365
    [ Info: Train Loss: 1.6129019, Val Loss: 2.1544127
    [ Info: Train Loss: 1.577596, Val Loss: 2.1495469
    [ Info: Train Loss: 1.5807685, Val Loss: 2.0804036</pre>
</div><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip180">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip180)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip181">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip180)" d="M140.696 1423.18 L2352.76 1423.18 L2352.76 47.2441 L140.696 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip182">
    <rect x="140" y="47" width="2213" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="160.712,1423.18 160.712,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="586.6,1423.18 586.6,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1012.49,1423.18 1012.49,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1438.38,1423.18 1438.38,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1864.26,1423.18 1864.26,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2290.15,1423.18 2290.15,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,1379.71 2352.76,1379.71 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,1110.38 2352.76,1110.38 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,841.044 2352.76,841.044 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,571.711 2352.76,571.711 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="140.696,302.378 2352.76,302.378 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,1423.18 2352.76,1423.18 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="160.712,1423.18 160.712,1404.28 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="586.6,1423.18 586.6,1404.28 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1012.49,1423.18 1012.49,1404.28 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1438.38,1423.18 1438.38,1404.28 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1864.26,1423.18 1864.26,1404.28 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2290.15,1423.18 2290.15,1404.28 "/>
<path clip-path="url(#clip180)" d="M160.712 1454.1 Q157.101 1454.1 155.272 1457.66 Q153.467 1461.2 153.467 1468.33 Q153.467 1475.44 155.272 1479.01 Q157.101 1482.55 160.712 1482.55 Q164.347 1482.55 166.152 1479.01 Q167.981 1475.44 167.981 1468.33 Q167.981 1461.2 166.152 1457.66 Q164.347 1454.1 160.712 1454.1 M160.712 1450.39 Q166.522 1450.39 169.578 1455 Q172.657 1459.58 172.657 1468.33 Q172.657 1477.06 169.578 1481.67 Q166.522 1486.25 160.712 1486.25 Q154.902 1486.25 151.823 1481.67 Q148.768 1477.06 148.768 1468.33 Q148.768 1459.58 151.823 1455 Q154.902 1450.39 160.712 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M561.288 1481.64 L568.926 1481.64 L568.926 1455.28 L560.616 1456.95 L560.616 1452.69 L568.88 1451.02 L573.556 1451.02 L573.556 1481.64 L581.195 1481.64 L581.195 1485.58 L561.288 1485.58 L561.288 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M600.639 1454.1 Q597.028 1454.1 595.199 1457.66 Q593.394 1461.2 593.394 1468.33 Q593.394 1475.44 595.199 1479.01 Q597.028 1482.55 600.639 1482.55 Q604.273 1482.55 606.079 1479.01 Q607.908 1475.44 607.908 1468.33 Q607.908 1461.2 606.079 1457.66 Q604.273 1454.1 600.639 1454.1 M600.639 1450.39 Q606.449 1450.39 609.505 1455 Q612.584 1459.58 612.584 1468.33 Q612.584 1477.06 609.505 1481.67 Q606.449 1486.25 600.639 1486.25 Q594.829 1486.25 591.75 1481.67 Q588.695 1477.06 588.695 1468.33 Q588.695 1459.58 591.75 1455 Q594.829 1450.39 600.639 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M991.261 1481.64 L1007.58 1481.64 L1007.58 1485.58 L985.636 1485.58 L985.636 1481.64 Q988.298 1478.89 992.881 1474.26 Q997.488 1469.61 998.668 1468.27 Q1000.91 1465.74 1001.79 1464.01 Q1002.7 1462.25 1002.7 1460.56 Q1002.7 1457.8 1000.75 1456.07 Q998.83 1454.33 995.728 1454.33 Q993.529 1454.33 991.076 1455.09 Q988.645 1455.86 985.867 1457.41 L985.867 1452.69 Q988.691 1451.55 991.145 1450.97 Q993.599 1450.39 995.636 1450.39 Q1001.01 1450.39 1004.2 1453.08 Q1007.39 1455.77 1007.39 1460.26 Q1007.39 1462.39 1006.58 1464.31 Q1005.8 1466.2 1003.69 1468.8 Q1003.11 1469.47 1000.01 1472.69 Q996.909 1475.88 991.261 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1027.39 1454.1 Q1023.78 1454.1 1021.96 1457.66 Q1020.15 1461.2 1020.15 1468.33 Q1020.15 1475.44 1021.96 1479.01 Q1023.78 1482.55 1027.39 1482.55 Q1031.03 1482.55 1032.83 1479.01 Q1034.66 1475.44 1034.66 1468.33 Q1034.66 1461.2 1032.83 1457.66 Q1031.03 1454.1 1027.39 1454.1 M1027.39 1450.39 Q1033.21 1450.39 1036.26 1455 Q1039.34 1459.58 1039.34 1468.33 Q1039.34 1477.06 1036.26 1481.67 Q1033.21 1486.25 1027.39 1486.25 Q1021.58 1486.25 1018.51 1481.67 Q1015.45 1477.06 1015.45 1468.33 Q1015.45 1459.58 1018.51 1455 Q1021.58 1450.39 1027.39 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1427.22 1466.95 Q1430.57 1467.66 1432.45 1469.93 Q1434.35 1472.2 1434.35 1475.53 Q1434.35 1480.65 1430.83 1483.45 Q1427.31 1486.25 1420.83 1486.25 Q1418.65 1486.25 1416.34 1485.81 Q1414.05 1485.39 1411.59 1484.54 L1411.59 1480.02 Q1413.54 1481.16 1415.85 1481.74 Q1418.17 1482.32 1420.69 1482.32 Q1425.09 1482.32 1427.38 1480.58 Q1429.69 1478.84 1429.69 1475.53 Q1429.69 1472.48 1427.54 1470.77 Q1425.41 1469.03 1421.59 1469.03 L1417.57 1469.03 L1417.57 1465.19 L1421.78 1465.19 Q1425.23 1465.19 1427.06 1463.82 Q1428.88 1462.43 1428.88 1459.84 Q1428.88 1457.18 1426.99 1455.77 Q1425.11 1454.33 1421.59 1454.33 Q1419.67 1454.33 1417.47 1454.75 Q1415.27 1455.16 1412.63 1456.04 L1412.63 1451.88 Q1415.3 1451.14 1417.61 1450.77 Q1419.95 1450.39 1422.01 1450.39 Q1427.33 1450.39 1430.44 1452.83 Q1433.54 1455.23 1433.54 1459.35 Q1433.54 1462.22 1431.89 1464.21 Q1430.25 1466.18 1427.22 1466.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1453.21 1454.1 Q1449.6 1454.1 1447.77 1457.66 Q1445.97 1461.2 1445.97 1468.33 Q1445.97 1475.44 1447.77 1479.01 Q1449.6 1482.55 1453.21 1482.55 Q1456.85 1482.55 1458.65 1479.01 Q1460.48 1475.44 1460.48 1468.33 Q1460.48 1461.2 1458.65 1457.66 Q1456.85 1454.1 1453.21 1454.1 M1453.21 1450.39 Q1459.02 1450.39 1462.08 1455 Q1465.16 1459.58 1465.16 1468.33 Q1465.16 1477.06 1462.08 1481.67 Q1459.02 1486.25 1453.21 1486.25 Q1447.4 1486.25 1444.32 1481.67 Q1441.27 1477.06 1441.27 1468.33 Q1441.27 1459.58 1444.32 1455 Q1447.4 1450.39 1453.21 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1852.43 1455.09 L1840.63 1473.54 L1852.43 1473.54 L1852.43 1455.09 M1851.21 1451.02 L1857.09 1451.02 L1857.09 1473.54 L1862.02 1473.54 L1862.02 1477.43 L1857.09 1477.43 L1857.09 1485.58 L1852.43 1485.58 L1852.43 1477.43 L1836.83 1477.43 L1836.83 1472.92 L1851.21 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1879.75 1454.1 Q1876.14 1454.1 1874.31 1457.66 Q1872.5 1461.2 1872.5 1468.33 Q1872.5 1475.44 1874.31 1479.01 Q1876.14 1482.55 1879.75 1482.55 Q1883.38 1482.55 1885.19 1479.01 Q1887.02 1475.44 1887.02 1468.33 Q1887.02 1461.2 1885.19 1457.66 Q1883.38 1454.1 1879.75 1454.1 M1879.75 1450.39 Q1885.56 1450.39 1888.61 1455 Q1891.69 1459.58 1891.69 1468.33 Q1891.69 1477.06 1888.61 1481.67 Q1885.56 1486.25 1879.75 1486.25 Q1873.94 1486.25 1870.86 1481.67 Q1867.8 1477.06 1867.8 1468.33 Q1867.8 1459.58 1870.86 1455 Q1873.94 1450.39 1879.75 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2264.85 1451.02 L2283.21 1451.02 L2283.21 1454.96 L2269.13 1454.96 L2269.13 1463.43 Q2270.15 1463.08 2271.17 1462.92 Q2272.19 1462.73 2273.21 1462.73 Q2278.99 1462.73 2282.37 1465.9 Q2285.75 1469.08 2285.75 1474.49 Q2285.75 1480.07 2282.28 1483.17 Q2278.81 1486.25 2272.49 1486.25 Q2270.31 1486.25 2268.04 1485.88 Q2265.8 1485.51 2263.39 1484.77 L2263.39 1480.07 Q2265.47 1481.2 2267.7 1481.76 Q2269.92 1482.32 2272.4 1482.32 Q2276.4 1482.32 2278.74 1480.21 Q2281.08 1478.1 2281.08 1474.49 Q2281.08 1470.88 2278.74 1468.77 Q2276.4 1466.67 2272.4 1466.67 Q2270.52 1466.67 2268.65 1467.08 Q2266.79 1467.5 2264.85 1468.38 L2264.85 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2304.97 1454.1 Q2301.35 1454.1 2299.53 1457.66 Q2297.72 1461.2 2297.72 1468.33 Q2297.72 1475.44 2299.53 1479.01 Q2301.35 1482.55 2304.97 1482.55 Q2308.6 1482.55 2310.4 1479.01 Q2312.23 1475.44 2312.23 1468.33 Q2312.23 1461.2 2310.4 1457.66 Q2308.6 1454.1 2304.97 1454.1 M2304.97 1450.39 Q2310.78 1450.39 2313.83 1455 Q2316.91 1459.58 2316.91 1468.33 Q2316.91 1477.06 2313.83 1481.67 Q2310.78 1486.25 2304.97 1486.25 Q2299.16 1486.25 2296.08 1481.67 Q2293.02 1477.06 2293.02 1468.33 Q2293.02 1459.58 2296.08 1455 Q2299.16 1450.39 2304.97 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1166.92 1548.76 L1166.92 1551.62 L1139.99 1551.62 Q1140.37 1557.67 1143.62 1560.85 Q1146.9 1564 1152.72 1564 Q1156.09 1564 1159.25 1563.17 Q1162.43 1562.35 1165.55 1560.69 L1165.55 1566.23 Q1162.4 1567.57 1159.09 1568.27 Q1155.78 1568.97 1152.37 1568.97 Q1143.84 1568.97 1138.84 1564 Q1133.88 1559.04 1133.88 1550.57 Q1133.88 1541.82 1138.59 1536.69 Q1143.33 1531.54 1151.35 1531.54 Q1158.54 1531.54 1162.71 1536.18 Q1166.92 1540.8 1166.92 1548.76 M1161.06 1547.04 Q1161 1542.23 1158.35 1539.37 Q1155.74 1536.5 1151.42 1536.5 Q1146.51 1536.5 1143.55 1539.27 Q1140.63 1542.04 1140.18 1547.07 L1161.06 1547.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1182.19 1562.7 L1182.19 1581.6 L1176.31 1581.6 L1176.31 1532.4 L1182.19 1532.4 L1182.19 1537.81 Q1184.04 1534.62 1186.84 1533.1 Q1189.67 1531.54 1193.59 1531.54 Q1200.08 1531.54 1204.12 1536.69 Q1208.2 1541.85 1208.2 1550.25 Q1208.2 1558.65 1204.12 1563.81 Q1200.08 1568.97 1193.59 1568.97 Q1189.67 1568.97 1186.84 1567.44 Q1184.04 1565.88 1182.19 1562.7 M1202.12 1550.25 Q1202.12 1543.79 1199.44 1540.13 Q1196.8 1536.44 1192.16 1536.44 Q1187.51 1536.44 1184.84 1540.13 Q1182.19 1543.79 1182.19 1550.25 Q1182.19 1556.71 1184.84 1560.4 Q1187.51 1564.07 1192.16 1564.07 Q1196.8 1564.07 1199.44 1560.4 Q1202.12 1556.71 1202.12 1550.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1231.72 1536.5 Q1227.01 1536.5 1224.27 1540.19 Q1221.53 1543.85 1221.53 1550.25 Q1221.53 1556.65 1224.24 1560.34 Q1226.98 1564 1231.72 1564 Q1236.4 1564 1239.13 1560.31 Q1241.87 1556.62 1241.87 1550.25 Q1241.87 1543.92 1239.13 1540.23 Q1236.4 1536.5 1231.72 1536.5 M1231.72 1531.54 Q1239.36 1531.54 1243.72 1536.5 Q1248.08 1541.47 1248.08 1550.25 Q1248.08 1559 1243.72 1564 Q1239.36 1568.97 1231.72 1568.97 Q1224.05 1568.97 1219.69 1564 Q1215.36 1559 1215.36 1550.25 Q1215.36 1541.47 1219.69 1536.5 Q1224.05 1531.54 1231.72 1531.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1283.44 1533.76 L1283.44 1539.24 Q1280.96 1537.87 1278.44 1537.2 Q1275.96 1536.5 1273.41 1536.5 Q1267.72 1536.5 1264.57 1540.13 Q1261.41 1543.73 1261.41 1550.25 Q1261.41 1556.78 1264.57 1560.4 Q1267.72 1564 1273.41 1564 Q1275.96 1564 1278.44 1563.33 Q1280.96 1562.63 1283.44 1561.26 L1283.44 1566.68 Q1280.99 1567.82 1278.35 1568.39 Q1275.74 1568.97 1272.78 1568.97 Q1264.72 1568.97 1259.98 1563.91 Q1255.24 1558.85 1255.24 1550.25 Q1255.24 1541.53 1260.01 1536.53 Q1264.82 1531.54 1273.16 1531.54 Q1275.86 1531.54 1278.44 1532.11 Q1281.02 1532.65 1283.44 1533.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1323.26 1546.53 L1323.26 1568.04 L1317.4 1568.04 L1317.4 1546.72 Q1317.4 1541.66 1315.43 1539.14 Q1313.45 1536.63 1309.51 1536.63 Q1304.77 1536.63 1302.03 1539.65 Q1299.29 1542.68 1299.29 1547.9 L1299.29 1568.04 L1293.4 1568.04 L1293.4 1518.52 L1299.29 1518.52 L1299.29 1537.93 Q1301.39 1534.72 1304.22 1533.13 Q1307.09 1531.54 1310.81 1531.54 Q1316.96 1531.54 1320.11 1535.36 Q1323.26 1539.14 1323.26 1546.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1357.66 1533.45 L1357.66 1538.98 Q1355.18 1537.71 1352.51 1537.07 Q1349.83 1536.44 1346.97 1536.44 Q1342.61 1536.44 1340.41 1537.77 Q1338.25 1539.11 1338.25 1541.79 Q1338.25 1543.82 1339.81 1545 Q1341.37 1546.15 1346.08 1547.2 L1348.08 1547.64 Q1354.32 1548.98 1356.93 1551.43 Q1359.57 1553.85 1359.57 1558.21 Q1359.57 1563.17 1355.63 1566.07 Q1351.71 1568.97 1344.84 1568.97 Q1341.97 1568.97 1338.85 1568.39 Q1335.77 1567.85 1332.33 1566.74 L1332.33 1560.69 Q1335.58 1562.38 1338.73 1563.24 Q1341.88 1564.07 1344.96 1564.07 Q1349.1 1564.07 1351.33 1562.66 Q1353.56 1561.23 1353.56 1558.65 Q1353.56 1556.27 1351.93 1554.99 Q1350.34 1553.72 1344.9 1552.54 L1342.86 1552.07 Q1337.42 1550.92 1335 1548.56 Q1332.58 1546.18 1332.58 1542.04 Q1332.58 1537.01 1336.15 1534.27 Q1339.71 1531.54 1346.27 1531.54 Q1349.52 1531.54 1352.38 1532.01 Q1355.25 1532.49 1357.66 1533.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,1423.18 140.696,47.2441 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,1379.71 159.593,1379.71 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,1110.38 159.593,1110.38 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,841.044 159.593,841.044 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,571.711 159.593,571.711 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="140.696,302.378 159.593,302.378 "/>
<path clip-path="url(#clip180)" d="M83.7929 1362.43 L102.149 1362.43 L102.149 1366.37 L88.0753 1366.37 L88.0753 1374.84 Q89.0938 1374.49 90.1123 1374.33 Q91.1308 1374.14 92.1493 1374.14 Q97.9363 1374.14 101.316 1377.31 Q104.696 1380.49 104.696 1385.9 Q104.696 1391.48 101.223 1394.58 Q97.7511 1397.66 91.4317 1397.66 Q89.2558 1397.66 86.9873 1397.29 Q84.7419 1396.92 82.3346 1396.18 L82.3346 1391.48 Q84.4179 1392.62 86.6401 1393.17 Q88.8623 1393.73 91.3391 1393.73 Q95.3437 1393.73 97.6817 1391.62 Q100.02 1389.51 100.02 1385.9 Q100.02 1382.29 97.6817 1380.19 Q95.3437 1378.08 91.3391 1378.08 Q89.4641 1378.08 87.5892 1378.5 Q85.7373 1378.91 83.7929 1379.79 L83.7929 1362.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M53.3995 1123.72 L61.0384 1123.72 L61.0384 1097.36 L52.7282 1099.02 L52.7282 1094.76 L60.9921 1093.1 L65.668 1093.1 L65.668 1123.72 L73.3068 1123.72 L73.3068 1127.66 L53.3995 1127.66 L53.3995 1123.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M92.7512 1096.18 Q89.1401 1096.18 87.3114 1099.74 Q85.5058 1103.28 85.5058 1110.41 Q85.5058 1117.52 87.3114 1121.08 Q89.1401 1124.63 92.7512 1124.63 Q96.3854 1124.63 98.1909 1121.08 Q100.02 1117.52 100.02 1110.41 Q100.02 1103.28 98.1909 1099.74 Q96.3854 1096.18 92.7512 1096.18 M92.7512 1092.47 Q98.5613 1092.47 101.617 1097.08 Q104.696 1101.66 104.696 1110.41 Q104.696 1119.14 101.617 1123.75 Q98.5613 1128.33 92.7512 1128.33 Q86.941 1128.33 83.8623 1123.75 Q80.8068 1119.14 80.8068 1110.41 Q80.8068 1101.66 83.8623 1097.08 Q86.941 1092.47 92.7512 1092.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M54.3949 854.389 L62.0337 854.389 L62.0337 828.024 L53.7236 829.69 L53.7236 825.431 L61.9874 823.764 L66.6633 823.764 L66.6633 854.389 L74.3022 854.389 L74.3022 858.324 L54.3949 858.324 L54.3949 854.389 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M83.7929 823.764 L102.149 823.764 L102.149 827.7 L88.0753 827.7 L88.0753 836.172 Q89.0938 835.825 90.1123 835.663 Q91.1308 835.477 92.1493 835.477 Q97.9363 835.477 101.316 838.649 Q104.696 841.82 104.696 847.237 Q104.696 852.815 101.223 855.917 Q97.7511 858.996 91.4317 858.996 Q89.2558 858.996 86.9873 858.625 Q84.7419 858.255 82.3346 857.514 L82.3346 852.815 Q84.4179 853.949 86.6401 854.505 Q88.8623 855.061 91.3391 855.061 Q95.3437 855.061 97.6817 852.954 Q100.02 850.848 100.02 847.237 Q100.02 843.625 97.6817 841.519 Q95.3437 839.413 91.3391 839.413 Q89.4641 839.413 87.5892 839.829 Q85.7373 840.246 83.7929 841.125 L83.7929 823.764 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M56.6171 585.056 L72.9365 585.056 L72.9365 588.991 L50.9921 588.991 L50.9921 585.056 Q53.6541 582.301 58.2375 577.672 Q62.8439 573.019 64.0245 571.677 Q66.2698 569.153 67.1494 567.417 Q68.0522 565.658 68.0522 563.968 Q68.0522 561.214 66.1078 559.478 Q64.1865 557.741 61.0847 557.741 Q58.8856 557.741 56.4319 558.505 Q54.0014 559.269 51.2236 560.82 L51.2236 556.098 Q54.0477 554.964 56.5014 554.385 Q58.955 553.806 60.9921 553.806 Q66.3624 553.806 69.5568 556.491 Q72.7513 559.177 72.7513 563.667 Q72.7513 565.797 71.9411 567.718 Q71.1541 569.616 69.0476 572.209 Q68.4689 572.88 65.367 576.098 Q62.2652 579.292 56.6171 585.056 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M92.7512 557.51 Q89.1401 557.51 87.3114 561.075 Q85.5058 564.616 85.5058 571.746 Q85.5058 578.852 87.3114 582.417 Q89.1401 585.959 92.7512 585.959 Q96.3854 585.959 98.1909 582.417 Q100.02 578.852 100.02 571.746 Q100.02 564.616 98.1909 561.075 Q96.3854 557.51 92.7512 557.51 M92.7512 553.806 Q98.5613 553.806 101.617 558.413 Q104.696 562.996 104.696 571.746 Q104.696 580.473 101.617 585.079 Q98.5613 589.663 92.7512 589.663 Q86.941 589.663 83.8623 585.079 Q80.8068 580.473 80.8068 571.746 Q80.8068 562.996 83.8623 558.413 Q86.941 553.806 92.7512 553.806 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M57.6125 315.723 L73.9318 315.723 L73.9318 319.658 L51.9875 319.658 L51.9875 315.723 Q54.6495 312.968 59.2328 308.339 Q63.8393 303.686 65.0198 302.343 Q67.2652 299.82 68.1448 298.084 Q69.0476 296.325 69.0476 294.635 Q69.0476 291.88 67.1032 290.144 Q65.1819 288.408 62.08 288.408 Q59.881 288.408 57.4273 289.172 Q54.9967 289.936 52.219 291.487 L52.219 286.765 Q55.043 285.63 57.4967 285.052 Q59.9504 284.473 61.9874 284.473 Q67.3578 284.473 70.5522 287.158 Q73.7466 289.843 73.7466 294.334 Q73.7466 296.464 72.9365 298.385 Q72.1494 300.283 70.0429 302.876 Q69.4642 303.547 66.3624 306.765 Q63.2606 309.959 57.6125 315.723 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M83.7929 285.098 L102.149 285.098 L102.149 289.033 L88.0753 289.033 L88.0753 297.505 Q89.0938 297.158 90.1123 296.996 Q91.1308 296.811 92.1493 296.811 Q97.9363 296.811 101.316 299.982 Q104.696 303.154 104.696 308.57 Q104.696 314.149 101.223 317.251 Q97.7511 320.329 91.4317 320.329 Q89.2558 320.329 86.9873 319.959 Q84.7419 319.589 82.3346 318.848 L82.3346 314.149 Q84.4179 315.283 86.6401 315.839 Q88.8623 316.394 91.3391 316.394 Q95.3437 316.394 97.6817 314.288 Q100.02 312.181 100.02 308.57 Q100.02 304.959 97.6817 302.853 Q95.3437 300.746 91.3391 300.746 Q89.4641 300.746 87.5892 301.163 Q85.7373 301.579 83.7929 302.459 L83.7929 285.098 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip182)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="203.301,86.1857 245.89,516.148 288.479,680.482 331.067,852.532 373.656,931.529 416.245,995.479 458.834,1059.21 501.422,1099.57 544.011,1142.21 586.6,1166.07 629.189,1197.31 671.777,1215.82 714.366,1235.1 756.955,1253.14 799.544,1262.22 842.132,1277.8 884.721,1282.21 927.31,1297.87 969.899,1298.34 1012.49,1310.13 1055.08,1316.42 1097.67,1323.21 1140.25,1328.1 1182.84,1335.23 1225.43,1336.24 1268.02,1340.01 1310.61,1344.67 1353.2,1348.49 1395.79,1350.74 1438.38,1353.82 1480.96,1354.86 1523.55,1362.91 1566.14,1362.35 1608.73,1358.93 1651.32,1365.81 1693.91,1368.75 1736.5,1366.05 1779.09,1370.29 1821.67,1371.21 1864.26,1376.28 1906.85,1375.36 1949.44,1375.06 1992.03,1377.03 2034.62,1378.1 2077.21,1378.9 2119.8,1380.7 2162.38,1382.17 2204.97,1382.08 2247.56,1382.86 2290.15,1384.24 "/>
<polyline clip-path="url(#clip182)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="203.301,166.195 245.89,558.715 288.479,695.301 331.067,747.474 373.656,927.557 416.245,888.525 458.834,1078.8 501.422,1109.81 544.011,1153.87 586.6,1093.59 629.189,1134.75 671.777,1134.23 714.366,1162.97 756.955,1167.38 799.544,1168.86 842.132,1180.73 884.721,1176.29 927.31,1191.72 969.899,1198.04 1012.49,1183.96 1055.08,1182.42 1097.67,1175.06 1140.25,1199.74 1182.84,1202.7 1225.43,1204.46 1268.02,1197.34 1310.61,1208.28 1353.2,1193.67 1395.79,1207 1438.38,1185.9 1480.96,1179.28 1523.55,1214.58 1566.14,1208.1 1608.73,1194.58 1651.32,1201.53 1693.91,1207.47 1736.5,1203.52 1779.09,1204.18 1821.67,1187.98 1864.26,1188.93 1906.85,1209.31 1949.44,1204.59 1992.03,1206.9 2034.62,1201.4 2077.21,1171.11 2119.8,1201.89 2162.38,1201.89 2204.97,1179.42 2247.56,1200.15 2290.15,1212.03 "/>
<path clip-path="url(#clip180)" d="M1856.13 248.629 L2279.02 248.629 L2279.02 93.1086 L1856.13 93.1086  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1856.13,248.629 2279.02,248.629 2279.02,93.1086 1856.13,93.1086 1856.13,248.629 "/>
<polyline clip-path="url(#clip180)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1880.7,144.949 2028.17,144.949 "/>
<path clip-path="url(#clip180)" d="M2060.16 128.942 L2060.16 136.303 L2068.93 136.303 L2068.93 139.613 L2060.16 139.613 L2060.16 153.687 Q2060.16 156.858 2061.02 157.761 Q2061.9 158.664 2064.56 158.664 L2068.93 158.664 L2068.93 162.229 L2064.56 162.229 Q2059.63 162.229 2057.75 160.4 Q2055.88 158.548 2055.88 153.687 L2055.88 139.613 L2052.75 139.613 L2052.75 136.303 L2055.88 136.303 L2055.88 128.942 L2060.16 128.942 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2089.56 140.284 Q2088.84 139.868 2087.98 139.682 Q2087.15 139.474 2086.13 139.474 Q2082.52 139.474 2080.58 141.835 Q2078.66 144.173 2078.66 148.571 L2078.66 162.229 L2074.37 162.229 L2074.37 136.303 L2078.66 136.303 L2078.66 140.331 Q2080 137.969 2082.15 136.835 Q2084.3 135.678 2087.38 135.678 Q2087.82 135.678 2088.36 135.747 Q2088.89 135.794 2089.54 135.909 L2089.56 140.284 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2105.81 149.196 Q2100.65 149.196 2098.66 150.377 Q2096.67 151.557 2096.67 154.405 Q2096.67 156.673 2098.15 158.016 Q2099.65 159.335 2102.22 159.335 Q2105.76 159.335 2107.89 156.835 Q2110.04 154.312 2110.04 150.145 L2110.04 149.196 L2105.81 149.196 M2114.3 147.437 L2114.3 162.229 L2110.04 162.229 L2110.04 158.293 Q2108.59 160.655 2106.41 161.789 Q2104.23 162.9 2101.09 162.9 Q2097.1 162.9 2094.74 160.678 Q2092.41 158.432 2092.41 154.682 Q2092.41 150.307 2095.32 148.085 Q2098.26 145.863 2104.07 145.863 L2110.04 145.863 L2110.04 145.446 Q2110.04 142.507 2108.1 140.909 Q2106.18 139.289 2102.68 139.289 Q2100.46 139.289 2098.35 139.821 Q2096.25 140.354 2094.3 141.419 L2094.3 137.483 Q2096.64 136.581 2098.84 136.141 Q2101.04 135.678 2103.12 135.678 Q2108.75 135.678 2111.53 138.594 Q2114.3 141.511 2114.3 147.437 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2123.08 136.303 L2127.34 136.303 L2127.34 162.229 L2123.08 162.229 L2123.08 136.303 M2123.08 126.21 L2127.34 126.21 L2127.34 131.604 L2123.08 131.604 L2123.08 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2157.8 146.581 L2157.8 162.229 L2153.54 162.229 L2153.54 146.719 Q2153.54 143.039 2152.1 141.21 Q2150.67 139.382 2147.8 139.382 Q2144.35 139.382 2142.36 141.581 Q2140.37 143.78 2140.37 147.576 L2140.37 162.229 L2136.09 162.229 L2136.09 136.303 L2140.37 136.303 L2140.37 140.331 Q2141.9 137.993 2143.96 136.835 Q2146.04 135.678 2148.75 135.678 Q2153.22 135.678 2155.51 138.456 Q2157.8 141.21 2157.8 146.581 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2185.99 170.099 L2185.99 173.409 L2161.36 173.409 L2161.36 170.099 L2185.99 170.099 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2194.12 158.34 L2194.12 172.09 L2189.84 172.09 L2189.84 136.303 L2194.12 136.303 L2194.12 140.238 Q2195.46 137.923 2197.5 136.812 Q2199.56 135.678 2202.41 135.678 Q2207.13 135.678 2210.07 139.428 Q2213.03 143.178 2213.03 149.289 Q2213.03 155.4 2210.07 159.15 Q2207.13 162.9 2202.41 162.9 Q2199.56 162.9 2197.5 161.789 Q2195.46 160.655 2194.12 158.34 M2208.61 149.289 Q2208.61 144.59 2206.66 141.928 Q2204.74 139.243 2201.36 139.243 Q2197.98 139.243 2196.04 141.928 Q2194.12 144.59 2194.12 149.289 Q2194.12 153.988 2196.04 156.673 Q2197.98 159.335 2201.36 159.335 Q2204.74 159.335 2206.66 156.673 Q2208.61 153.988 2208.61 149.289 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2224.21 158.34 L2224.21 172.09 L2219.93 172.09 L2219.93 136.303 L2224.21 136.303 L2224.21 140.238 Q2225.55 137.923 2227.59 136.812 Q2229.65 135.678 2232.5 135.678 Q2237.22 135.678 2240.16 139.428 Q2243.12 143.178 2243.12 149.289 Q2243.12 155.4 2240.16 159.15 Q2237.22 162.9 2232.5 162.9 Q2229.65 162.9 2227.59 161.789 Q2225.55 160.655 2224.21 158.34 M2238.7 149.289 Q2238.7 144.59 2236.76 141.928 Q2234.84 139.243 2231.46 139.243 Q2228.08 139.243 2226.13 141.928 Q2224.21 144.59 2224.21 149.289 Q2224.21 153.988 2226.13 156.673 Q2228.08 159.335 2231.46 159.335 Q2234.84 159.335 2236.76 156.673 Q2238.7 153.988 2238.7 149.289 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2250.18 126.21 L2254.44 126.21 L2254.44 162.229 L2250.18 162.229 L2250.18 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip180)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1880.7,196.789 2028.17,196.789 "/>
<path clip-path="url(#clip180)" d="M2052.75 188.143 L2057.27 188.143 L2065.37 209.902 L2073.47 188.143 L2077.98 188.143 L2068.26 214.069 L2062.48 214.069 L2052.75 188.143 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2095.65 201.036 Q2090.48 201.036 2088.49 202.217 Q2086.5 203.397 2086.5 206.245 Q2086.5 208.513 2087.98 209.856 Q2089.49 211.175 2092.06 211.175 Q2095.6 211.175 2097.73 208.675 Q2099.88 206.152 2099.88 201.985 L2099.88 201.036 L2095.65 201.036 M2104.14 199.277 L2104.14 214.069 L2099.88 214.069 L2099.88 210.133 Q2098.42 212.495 2096.25 213.629 Q2094.07 214.74 2090.92 214.74 Q2086.94 214.74 2084.58 212.518 Q2082.24 210.272 2082.24 206.522 Q2082.24 202.147 2085.16 199.925 Q2088.1 197.703 2093.91 197.703 L2099.88 197.703 L2099.88 197.286 Q2099.88 194.347 2097.94 192.749 Q2096.02 191.129 2092.52 191.129 Q2090.3 191.129 2088.19 191.661 Q2086.09 192.194 2084.14 193.259 L2084.14 189.323 Q2086.48 188.421 2088.68 187.981 Q2090.88 187.518 2092.96 187.518 Q2098.59 187.518 2101.36 190.434 Q2104.14 193.351 2104.14 199.277 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2112.92 178.05 L2117.17 178.05 L2117.17 214.069 L2112.92 214.069 L2112.92 178.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2145.79 221.939 L2145.79 225.249 L2121.16 225.249 L2121.16 221.939 L2145.79 221.939 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2153.91 210.18 L2153.91 223.93 L2149.63 223.93 L2149.63 188.143 L2153.91 188.143 L2153.91 192.078 Q2155.25 189.763 2157.29 188.652 Q2159.35 187.518 2162.2 187.518 Q2166.92 187.518 2169.86 191.268 Q2172.82 195.018 2172.82 201.129 Q2172.82 207.24 2169.86 210.99 Q2166.92 214.74 2162.2 214.74 Q2159.35 214.74 2157.29 213.629 Q2155.25 212.495 2153.91 210.18 M2168.4 201.129 Q2168.4 196.43 2166.46 193.768 Q2164.54 191.083 2161.16 191.083 Q2157.78 191.083 2155.83 193.768 Q2153.91 196.43 2153.91 201.129 Q2153.91 205.828 2155.83 208.513 Q2157.78 211.175 2161.16 211.175 Q2164.54 211.175 2166.46 208.513 Q2168.4 205.828 2168.4 201.129 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2184 210.18 L2184 223.93 L2179.72 223.93 L2179.72 188.143 L2184 188.143 L2184 192.078 Q2185.35 189.763 2187.38 188.652 Q2189.44 187.518 2192.29 187.518 Q2197.01 187.518 2199.95 191.268 Q2202.91 195.018 2202.91 201.129 Q2202.91 207.24 2199.95 210.99 Q2197.01 214.74 2192.29 214.74 Q2189.44 214.74 2187.38 213.629 Q2185.35 212.495 2184 210.18 M2198.49 201.129 Q2198.49 196.43 2196.55 193.768 Q2194.63 191.083 2191.25 191.083 Q2187.87 191.083 2185.92 193.768 Q2184 196.43 2184 201.129 Q2184 205.828 2185.92 208.513 Q2187.87 211.175 2191.25 211.175 Q2194.63 211.175 2196.55 208.513 Q2198.49 205.828 2198.49 201.129 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2209.97 178.05 L2214.23 178.05 L2214.23 214.069 L2209.97 214.069 L2209.97 178.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg><p>After training, we print out the perplexity on the training set and the predicted sequence following the provided prefix.</p><pre><code class="language-julia hljs">d2lai.prediction(prefix, m, data.vocab, 20, state = zeros(num_hiddens))
</code></pre><pre><code class="nohighlight hljs">┌ Warning: Layer with Float32 parameters got Float64 input.
│   The input will be converted, but any earlier layers may be very slow.
│   layer = Dense(32 =&gt; 28)     # 924 parameters
│   summary(x) = &quot;32×1 Matrix{Float64}&quot;
└ @ Flux ~/.julia/packages/Flux/3711C/src/layers/stateless.jl:60





&quot;it has a four dimension of&quot;</code></pre><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>Compared with LSTMs, GRUs achieve similar performance but tend to be lighter computationally. Generally, compared with simple RNNs, gated RNNS, just like LSTMs and GRUs, can better capture dependencies for sequences with large time step distances. GRUs contain basic RNNs as their extreme case whenever the reset gate is switched on.  They can also skip subsequences by turning on the update gate.</p><h2 id="Exercises"><a class="docs-heading-anchor" href="#Exercises">Exercises</a><a id="Exercises-1"></a><a class="docs-heading-anchor-permalink" href="#Exercises" title="Permalink"></a></h2><ol><li>Assume that we only want to use the input at time step <span>$t&#39;$</span> to predict the output at time step <span>$t &gt; t&#39;$</span>. What are the best values for the reset and update gates for each time step?</li><li>Adjust the hyperparameters and analyze their influence on running time, perplexity, and the output sequence.</li><li>Compare runtime, perplexity, and the output strings for <code>rnn.RNN</code> and <code>rnn.GRU</code> implementations with each other.</li><li>What happens if you implement only parts of a GRU, e.g., with only a reset gate or only an update gate?</li></ol><pre><code class="language-julia hljs"></code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../MRNN_1/">« Long Short-Term Memory (LSTM)</a><a class="docs-footer-nextpage" href="../MRNN_3/">- »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Sunday 15 June 2025 19:32">Sunday 15 June 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
