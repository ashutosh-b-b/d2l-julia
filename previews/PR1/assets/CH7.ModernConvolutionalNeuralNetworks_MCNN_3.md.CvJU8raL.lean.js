import{_ as n,c as e,o as a,j as l,aA as t,a as s}from"./chunks/framework.DjA5121Y.js";const p="/d2l-julia/previews/PR1/assets/nin.71yV49QC.svg",I=JSON.parse('{"title":"Network in Network (NiN)","description":"","frontmatter":{},"headers":[],"relativePath":"CH7.ModernConvolutionalNeuralNetworks/MCNN_3.md","filePath":"CH7.ModernConvolutionalNeuralNetworks/MCNN_3.md","lastUpdated":null}'),o={name:"CH7.ModernConvolutionalNeuralNetworks/MCNN_3.md"},r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 2222.4 666","aria-hidden":"true"},Q={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 2222.4 666","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 2222.4 666","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.554ex",role:"img",focusable:"false",viewBox:"0 -665 2222.4 687","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"7.291ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 3222.4 666","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 2222.4 688","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.554ex",role:"img",focusable:"false",viewBox:"0 -665 2222.4 687","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.554ex",role:"img",focusable:"false",viewBox:"0 -665 2222.4 687","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 2222.4 666","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 2222.4 666","aria-hidden":"true"},F={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.028ex",height:"1.554ex",role:"img",focusable:"false",viewBox:"0 -665 2222.4 687","aria-hidden":"true"},_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.188ex",height:"1.581ex",role:"img",focusable:"false",viewBox:"0 -677 4944.9 699","aria-hidden":"true"},A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.056ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 4444.9 688","aria-hidden":"true"};function Z(B,i,j,D,z,S){return a(),e("div",null,[i[62]||(i[62]=l("h1",{id:"Network-in-Network-NiN",tabindex:"-1"},[s("Network in Network (NiN) "),l("a",{class:"header-anchor",href:"#Network-in-Network-NiN","aria-label":'Permalink to "Network in Network (NiN) {#Network-in-Network-NiN}"'},"​")],-1)),i[63]||(i[63]=l("p",null,[s("LeNet, AlexNet, and VGG all share a common design pattern: extract features exploiting "),l("em",null,"spatial"),s(" structure via a sequence of convolutions and pooling layers and post-process the representations via fully connected layers. The improvements upon LeNet by AlexNet and VGG mainly lie in how these later networks widen and deepen these two modules.")],-1)),i[64]||(i[64]=l("p",null,"This design poses two major challenges. First, the fully connected layers at the end of the architecture consume tremendous numbers of parameters. For instance, even a simple model such as VGG-11 requires a monstrous matrix, occupying almost 400MB of RAM in single precision (FP32). This is a significant impediment to computation, in particular on mobile and embedded devices. After all, even high-end mobile phones sport no more than 8GB of RAM. At the time VGG was invented, this was an order of magnitude less (the iPhone 4S had 512MB). As such, it would have been difficult to justify spending the majority of memory on an image classifier.",-1)),i[65]||(i[65]=l("p",null,"Second, it is equally impossible to add fully connected layers earlier in the network to increase the degree of nonlinearity: doing so would destroy the spatial structure and require potentially even more memory.",-1)),l("p",null,[i[2]||(i[2]=s("The ")),i[3]||(i[3]=l("em",null,"network in network",-1)),i[4]||(i[4]=s(" (")),i[5]||(i[5]=l("em",null,"NiN",-1)),i[6]||(i[6]=s(") blocks [")),i[7]||(i[7]=l("a",{href:"/d2l-julia/previews/PR1/references#Lin_Chen_Yan_2013"},"78",-1)),i[8]||(i[8]=s("] offer an alternative, capable of solving both problems in one simple strategy. They were proposed based on a very simple insight: (i) use ")),l("mjx-container",r,[(a(),e("svg",h,i[0]||(i[0]=[t("",1)]))),i[1]||(i[1]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"1"),l("mo",null,"×"),l("mn",null,"1")])],-1))]),i[9]||(i[9]=s(" convolutions to add local nonlinearities across the channel activations and (ii) use global average pooling to integrate across all locations in the last representation layer. Note that global average pooling would not be effective, were it not for the added nonlinearities. Let's dive into this in detail."))]),i[66]||(i[66]=t("",3)),l("p",null,[i[12]||(i[12]=s("Recall :numref:")),i[13]||(i[13]=l("code",null,"subsec_1x1",-1)),i[14]||(i[14]=s(". In it we said that the inputs and outputs of convolutional layers consist of four-dimensional tensors with axes corresponding to the example, channel, height, and width. Also recall that the inputs and outputs of fully connected layers are typically two-dimensional tensors corresponding to the example and feature. The idea behind NiN is to apply a fully connected layer at each pixel location (for each height and width). The resulting ")),l("mjx-container",Q,[(a(),e("svg",d,i[10]||(i[10]=[t("",1)]))),i[11]||(i[11]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"1"),l("mo",null,"×"),l("mn",null,"1")])],-1))]),i[15]||(i[15]=s(" convolution can be thought of as a fully connected layer acting independently on each pixel location."))]),l("p",null,[i[20]||(i[20]=l("a",{href:"/d2l-julia/previews/PR1/CH7.ModernConvolutionalNeuralNetworks/MCNN_3#fig_nin"},"Figure",-1)),i[21]||(i[21]=s(" illustrates the main structural differences between VGG and NiN, and their blocks. Note both the difference in the NiN blocks (the initial convolution is followed by ")),l("mjx-container",k,[(a(),e("svg",T,i[16]||(i[16]=[t("",1)]))),i[17]||(i[17]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"1"),l("mo",null,"×"),l("mn",null,"1")])],-1))]),i[22]||(i[22]=s(" convolutions, whereas VGG retains ")),l("mjx-container",c,[(a(),e("svg",u,i[18]||(i[18]=[t("",1)]))),i[19]||(i[19]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"3"),l("mo",null,"×"),l("mn",null,"3")])],-1))]),i[23]||(i[23]=s(" convolutions) and at the end where we no longer require a giant fully connected layer."))]),i[67]||(i[67]=t("",4)),l("p",null,[i[32]||(i[32]=s("NiN uses the same initial convolution sizes as AlexNet (it was proposed shortly thereafter). The kernel sizes are ")),l("mjx-container",g,[(a(),e("svg",y,i[24]||(i[24]=[t("",1)]))),i[25]||(i[25]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"11"),l("mo",null,"×"),l("mn",null,"11")])],-1))]),i[33]||(i[33]=s(", ")),l("mjx-container",L,[(a(),e("svg",m,i[26]||(i[26]=[t("",1)]))),i[27]||(i[27]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"5"),l("mo",null,"×"),l("mn",null,"5")])],-1))]),i[34]||(i[34]=s(", and ")),l("mjx-container",f,[(a(),e("svg",E,i[28]||(i[28]=[t("",1)]))),i[29]||(i[29]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"3"),l("mo",null,"×"),l("mn",null,"3")])],-1))]),i[35]||(i[35]=s(", respectively, and the numbers of output channels match those of AlexNet. Each NiN block is followed by a max-pooling layer with a stride of 2 and a window shape of ")),l("mjx-container",w,[(a(),e("svg",x,i[30]||(i[30]=[t("",1)]))),i[31]||(i[31]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"3"),l("mo",null,"×"),l("mn",null,"3")])],-1))]),i[36]||(i[36]=s("."))]),i[68]||(i[68]=t("",11)),l("ol",null,[l("li",null,[l("p",null,[i[39]||(i[39]=s("Why are there two ")),l("mjx-container",C,[(a(),e("svg",b,i[37]||(i[37]=[t("",1)]))),i[38]||(i[38]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"1"),l("mo",null,"×"),l("mn",null,"1")])],-1))]),i[40]||(i[40]=s(" convolutional layers per NiN block? Increase their number to three. Reduce their number to one. What changes?"))])]),l("li",null,[l("p",null,[i[45]||(i[45]=s("What changes if you replace the ")),l("mjx-container",v,[(a(),e("svg",M,i[41]||(i[41]=[t("",1)]))),i[42]||(i[42]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"1"),l("mo",null,"×"),l("mn",null,"1")])],-1))]),i[46]||(i[46]=s(" convolutions by ")),l("mjx-container",F,[(a(),e("svg",V,i[43]||(i[43]=[t("",1)]))),i[44]||(i[44]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"3"),l("mo",null,"×"),l("mn",null,"3")])],-1))]),i[47]||(i[47]=s(" convolutions?"))])]),i[55]||(i[55]=l("li",null,[l("p",null,"What happens if you replace the global average pooling by a fully connected layer (speed, accuracy, number of parameters)?")],-1)),i[56]||(i[56]=l("li",null,[l("p",null,"Calculate the resource usage for NiN.")],-1)),i[57]||(i[57]=l("li",null,[l("p",null,"What is the number of parameters?")],-1)),i[58]||(i[58]=l("li",null,[l("p",null,"What is the amount of computation?")],-1)),i[59]||(i[59]=l("li",null,[l("p",null,"What is the amount of memory needed during training?")],-1)),i[60]||(i[60]=l("li",null,[l("p",null,"What is the amount of memory needed during prediction?")],-1)),l("li",null,[l("p",null,[i[52]||(i[52]=s("What are possible problems with reducing the ")),l("mjx-container",_,[(a(),e("svg",N,i[48]||(i[48]=[t("",1)]))),i[49]||(i[49]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"384"),l("mo",null,"×"),l("mn",null,"5"),l("mo",null,"×"),l("mn",null,"5")])],-1))]),i[53]||(i[53]=s(" representation to a ")),l("mjx-container",A,[(a(),e("svg",H,i[50]||(i[50]=[t("",1)]))),i[51]||(i[51]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"10"),l("mo",null,"×"),l("mn",null,"5"),l("mo",null,"×"),l("mn",null,"5")])],-1))]),i[54]||(i[54]=s(" representation in one step?"))])]),i[61]||(i[61]=l("li",null,[l("p",null,"Use the structural design decisions in VGG that led to VGG-11, VGG-16, and VGG-19 to design a family of NiN-like networks.")],-1))]),i[69]||(i[69]=t("",1))])}const G=n(o,[["render",Z]]);export{I as __pageData,G as default};
