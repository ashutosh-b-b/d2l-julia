import{_ as s,c as Q,o as T,aA as l,j as t,a as e}from"./chunks/framework.DjA5121Y.js";const a2=JSON.parse('{"title":"Numerical Stability and Initialization","description":"","frontmatter":{},"headers":[],"relativePath":"CH5.MLP/MLP_4.md","filePath":"CH5.MLP/MLP_4.md","lastUpdated":null}'),o={name:"CH5.MLP/MLP_4.md"},n={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.005ex",role:"img",focusable:"false",viewBox:"0 -444 607 444","aria-hidden":"true"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.011ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.301ex",height:"1.034ex",role:"img",focusable:"false",viewBox:"0 -452 575 457","aria-hidden":"true"},p={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.674ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 298 705","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.773ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 783.7 910","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.016ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.599ex",height:"2.037ex",role:"img",focusable:"false",viewBox:"0 -893.3 2032.8 900.3","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.355ex",height:"2.021ex",role:"img",focusable:"false",viewBox:"0 -893.3 1482.8 893.3","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.068ex",height:"2.207ex",role:"img",focusable:"false",viewBox:"0 -893.3 3566.2 975.3","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"44.424ex",height:"2.7ex",role:"img",focusable:"false",viewBox:"0 -943.3 19635.2 1193.3","aria-hidden":"true"},M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.011ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.301ex",height:"1.034ex",role:"img",focusable:"false",viewBox:"0 -452 575 457","aria-hidden":"true"},Z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.016ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.599ex",height:"2.037ex",role:"img",focusable:"false",viewBox:"0 -893.3 2032.8 900.3","aria-hidden":"true"},D={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.87ex"},xmlns:"http://www.w3.org/2000/svg",width:"39.759ex",height:"7.004ex",role:"img",focusable:"false",viewBox:"0 -943.3 17573.4 3095.9","aria-hidden":"true"},j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.981ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 2201.4 776","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"14.822ex",height:"2.021ex",role:"img",focusable:"false",viewBox:"0 -893.3 6551.5 893.3","aria-hidden":"true"},R={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.282ex",height:"2.021ex",role:"img",focusable:"false",viewBox:"0 -893.3 1450.8 893.3","aria-hidden":"true"},O={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"4.38ex",height:"2.021ex",role:"img",focusable:"false",viewBox:"0 -893.3 1935.8 893.3","aria-hidden":"true"},z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.292ex",height:"1ex",role:"img",focusable:"false",viewBox:"0 -431 571 442","aria-hidden":"true"},I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.191ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 7156.4 1000","aria-hidden":"true"},F={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.428ex",height:"2.072ex",role:"img",focusable:"false",viewBox:"0 -833.9 2841.1 915.9","aria-hidden":"true"},N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},J={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.016ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.922ex",height:"2.037ex",role:"img",focusable:"false",viewBox:"0 -893.3 2175.7 900.3","aria-hidden":"true"},q={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.919ex",height:"2.207ex",role:"img",focusable:"false",viewBox:"0 -893.3 3942.2 975.3","aria-hidden":"true"},U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.98ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 433 453","aria-hidden":"true"},Y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.016ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.922ex",height:"2.037ex",role:"img",focusable:"false",viewBox:"0 -893.3 2175.7 900.3","aria-hidden":"true"},t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.016ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.922ex",height:"2.037ex",role:"img",focusable:"false",viewBox:"0 -893.3 2175.7 900.3","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.837ex",height:"1.355ex",role:"img",focusable:"false",viewBox:"0 -441 812 598.8","aria-hidden":"true"},T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.879ex",height:"1.339ex",role:"img",focusable:"false",viewBox:"0 -442 1272.7 592","aria-hidden":"true"},s1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.141ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 946.3 736.2","aria-hidden":"true"},n1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.019ex",height:"1.668ex",role:"img",focusable:"false",viewBox:"0 -443 1334.3 737.2","aria-hidden":"true"},i1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},d1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.287ex",height:"6.588ex",role:"img",focusable:"false",viewBox:"0 -1579.6 6314.8 2911.8","aria-hidden":"true"},m1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.019ex",height:"1.668ex",role:"img",focusable:"false",viewBox:"0 -443 1334.3 737.2","aria-hidden":"true"},p1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.28ex",height:"1.912ex",role:"img",focusable:"false",viewBox:"0 -833.9 1007.6 844.9","aria-hidden":"true"},c1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.141ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 946.3 736.2","aria-hidden":"true"},u1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.332ex",height:"2.375ex",role:"img",focusable:"false",viewBox:"0 -833.9 1030.8 1049.9","aria-hidden":"true"},w1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.019ex",height:"1.668ex",role:"img",focusable:"false",viewBox:"0 -443 1334.3 737.2","aria-hidden":"true"},f1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.837ex",height:"1.355ex",role:"img",focusable:"false",viewBox:"0 -441 812 598.8","aria-hidden":"true"},k1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},L1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-7.832ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.617ex",height:"16.795ex",role:"img",focusable:"false",viewBox:"0 -3961.8 9996.8 7423.6","aria-hidden":"true"},M1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},b1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-9.611ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.655ex",height:"20.353ex",role:"img",focusable:"false",viewBox:"0 -4748.1 11339.5 8996.2","aria-hidden":"true"},Z1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.307ex",height:"2.226ex",role:"img",focusable:"false",viewBox:"0 -833.9 4113.8 983.9","aria-hidden":"true"},D1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.285ex",height:"2.244ex",role:"img",focusable:"false",viewBox:"0 -833.9 4545.9 991.7","aria-hidden":"true"},j1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.857ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1704.8 599.8","aria-hidden":"true"},C1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},E1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.896ex"},xmlns:"http://www.w3.org/2000/svg",width:"53.282ex",height:"6.923ex",role:"img",focusable:"false",viewBox:"0 -1780 23550.5 3060","aria-hidden":"true"},R1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.033ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.3ex",height:"2.99ex",role:"img",focusable:"false",viewBox:"0 -864.9 5436.6 1321.5","aria-hidden":"true"},O1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.655ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3825.7 1000","aria-hidden":"true"},z1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.816ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.54ex",height:"3.041ex",role:"img",focusable:"false",viewBox:"0 -983.7 1122.7 1344.2","aria-hidden":"true"},I1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.816ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.54ex",height:"3.041ex",role:"img",focusable:"false",viewBox:"0 -983.7 1122.7 1344.2","aria-hidden":"true"},F1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.28ex",height:"1.912ex",role:"img",focusable:"false",viewBox:"0 -833.9 1007.6 844.9","aria-hidden":"true"},N1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},J1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.223ex"},xmlns:"http://www.w3.org/2000/svg",width:"35.077ex",height:"7.576ex",role:"img",focusable:"false",viewBox:"0 -1924.4 15504.2 3348.7","aria-hidden":"true"};function q1(W1,a,U1,$1,Y1,K1){return T(),Q("div",null,[a[163]||(a[163]=l("",5)),t("p",null,[a[16]||(a[16]=e("Consider a deep network with ")),t("mjx-container",n,[(T(),Q("svg",r,a[0]||(a[0]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)]))),a[1]||(a[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),a[17]||(a[17]=e(" layers, input ")),t("mjx-container",i,[(T(),Q("svg",d,a[2]||(a[2]=[l("",1)]))),a[3]||(a[3]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")])])],-1))]),a[18]||(a[18]=e(" and output ")),t("mjx-container",m,[(T(),Q("svg",h,a[4]||(a[4]=[l("",1)]))),a[5]||(a[5]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")])])],-1))]),a[19]||(a[19]=e(". With each layer ")),t("mjx-container",p,[(T(),Q("svg",g,a[6]||(a[6]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D459",d:"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z",style:{"stroke-width":"3"}})])])],-1)]))),a[7]||(a[7]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"l")])],-1))]),a[20]||(a[20]=e(" defined by a transformation ")),t("mjx-container",c,[(T(),Q("svg",H,a[8]||(a[8]=[l("",1)]))),a[9]||(a[9]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"f"),t("mi",null,"l")])])],-1))]),a[21]||(a[21]=e(" parametrized by weights ")),t("mjx-container",u,[(T(),Q("svg",x,a[10]||(a[10]=[l("",1)]))),a[11]||(a[11]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[22]||(a[22]=e(", whose hidden layer output is ")),t("mjx-container",w,[(T(),Q("svg",V,a[12]||(a[12]=[l("",1)]))),a[13]||(a[13]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[23]||(a[23]=e(" (let ")),t("mjx-container",f,[(T(),Q("svg",y,a[14]||(a[14]=[l("",1)]))),a[15]||(a[15]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mn",null,"0"),t("mo",{stretchy:"false"},")")])]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")])])],-1))]),a[24]||(a[24]=e("), our network can be expressed as:"))]),t("mjx-container",k,[(T(),Q("svg",L,a[25]||(a[25]=[l("",1)]))),a[26]||(a[26]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])]),t("mo",null,"="),t("msub",null,[t("mi",null,"f"),t("mi",null,"l")]),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",null,"−"),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])]),t("mo",{stretchy:"false"},")"),t("mtext",null," and thus "),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mo",null,"="),t("msub",null,[t("mi",null,"f"),t("mi",null,"L")]),t("mo",null,"∘"),t("mo",null,"⋯"),t("mo",null,"∘"),t("msub",null,[t("mi",null,"f"),t("mn",null,"1")]),t("mo",{stretchy:"false"},"("),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",{stretchy:"false"},")"),t("mo",null,".")])],-1))]),t("p",null,[a[31]||(a[31]=e("If all the hidden layer output and the input are vectors, we can write the gradient of ")),t("mjx-container",M,[(T(),Q("svg",b,a[27]||(a[27]=[l("",1)]))),a[28]||(a[28]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")])])],-1))]),a[32]||(a[32]=e(" with respect to any set of parameters ")),t("mjx-container",Z,[(T(),Q("svg",v,a[29]||(a[29]=[l("",1)]))),a[30]||(a[30]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[33]||(a[33]=e(" as follows:"))]),t("mjx-container",D,[(T(),Q("svg",_,a[34]||(a[34]=[l("",1)]))),a[35]||(a[35]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mo",null,"="),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("msub",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"L"),t("mo",null,"−"),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])])])]),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"L"),t("mo",{stretchy:"false"},")")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"L"),t("mo",{stretchy:"false"},")")])]),t("mrow",{"data-mjx-texclass":"REL"},[t("mover",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("mo",null,"=")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"def")])])])])]),t("mo",null,"⋯"),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("msub",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])]),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",null,"+"),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",null,"+"),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])]),t("mrow",{"data-mjx-texclass":"REL"},[t("mover",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("mo",null,"=")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"def")])])])])]),t("munder",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("munder",null,[t("mrow",null,[t("msub",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])]),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])]),t("mo",null,"⏟")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])]),t("mrow",{"data-mjx-texclass":"REL"},[t("mover",null,[t("mrow",{"data-mjx-texclass":"OP"},[t("mo",null,"=")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mtext",null,"def")])])])])]),t("mo",null,".")])],-1))]),t("p",null,[a[44]||(a[44]=e("In other words, this gradient is the product of ")),t("mjx-container",j,[(T(),Q("svg",A,a[36]||(a[36]=[l("",1)]))),a[37]||(a[37]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L"),t("mo",null,"−"),t("mi",null,"l")])],-1))]),a[45]||(a[45]=e(" matrices ")),t("mjx-container",C,[(T(),Q("svg",E,a[38]||(a[38]=[l("",1)]))),a[39]||(a[39]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"L"),t("mo",{stretchy:"false"},")")])]),t("mo",null,"⋯"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",null,"+"),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[46]||(a[46]=e(" and the gradient vector ")),t("mjx-container",R,[(T(),Q("svg",S,a[40]||(a[40]=[l("",1)]))),a[41]||(a[41]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[47]||(a[47]=e(". Thus we are susceptible to the same problems of numerical underflow that often crop up when multiplying together too many probabilities. When dealing with probabilities, a common trick is to switch into log-space, i.e., shifting pressure from the mantissa to the exponent of the numerical representation. Unfortunately, our problem above is more serious: initially the matrices ")),t("mjx-container",O,[(T(),Q("svg",P,a[42]||(a[42]=[l("",1)]))),a[43]||(a[43]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[48]||(a[48]=e(" may have a wide variety of eigenvalues. They might be small or large, and their product might be ")),a[49]||(a[49]=t("em",null,"very large",-1)),a[50]||(a[50]=e(" or ")),a[51]||(a[51]=t("em",null,"very small",-1)),a[52]||(a[52]=e("."))]),a[164]||(a[164]=t("p",null,[e("The risks posed by unstable gradients go beyond numerical representation. Gradients of unpredictable magnitude also threaten the stability of our optimization algorithms. We may be facing parameter updates that are either (i) excessively large, destroying our model (the "),t("em",null,"exploding gradient"),e(" problem); or (ii) excessively small (the "),t("em",null,"vanishing gradient"),e(" problem), rendering learning impossible as parameters hardly move on each update.")],-1)),a[165]||(a[165]=t("h3",{id:"Vanishing-Gradients",tabindex:"-1"},[e("Vanishing Gradients "),t("a",{class:"header-anchor",href:"#Vanishing-Gradients","aria-label":'Permalink to "Vanishing Gradients {#Vanishing-Gradients}"'},"​")],-1)),t("p",null,[a[57]||(a[57]=e("One frequent culprit causing the vanishing gradient problem is the choice of the activation function ")),t("mjx-container",z,[(T(),Q("svg",B,a[53]||(a[53]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D70E",d:"M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z",style:{"stroke-width":"3"}})])])],-1)]))),a[54]||(a[54]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"σ")])],-1))]),a[58]||(a[58]=e(" that is appended following each layer's linear operations. Historically, the sigmoid function ")),t("mjx-container",I,[(T(),Q("svg",X,a[55]||(a[55]=[l("",1)]))),a[56]||(a[56]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"1"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"exp"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("mo",{stretchy:"false"},"("),t("mo",null,"−"),t("mi",null,"x"),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])],-1))]),a[59]||(a[59]=e(" (introduced in :numref:")),a[60]||(a[60]=t("code",null,"sec_mlp",-1)),a[61]||(a[61]=e(") was popular because it resembles a thresholding function. Since early artificial neural networks were inspired by biological neural networks, the idea of neurons that fire either ")),a[62]||(a[62]=t("em",null,"fully",-1)),a[63]||(a[63]=e(" or ")),a[64]||(a[64]=t("em",null,"not at all",-1)),a[65]||(a[65]=e(" (like biological neurons) seemed appealing. Let's take a closer look at the sigmoid to see why it can cause vanishing gradients."))]),a[166]||(a[166]=l("",4)),t("p",null,[a[68]||(a[68]=e("The opposite problem, when gradients explode, can be similarly vexing. To illustrate this a bit better, we draw 100 Gaussian random matrices and multiply them with some initial matrix. For the scale that we picked (the choice of the variance ")),t("mjx-container",F,[(T(),Q("svg",G,a[66]||(a[66]=[l("",1)]))),a[67]||(a[67]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"σ"),t("mn",null,"2")]),t("mo",null,"="),t("mn",null,"1")])],-1))]),a[69]||(a[69]=e("), the matrix product explodes. When this happens because of the initialization of a deep network, we have no chance of getting a gradient descent optimizer to converge."))]),a[167]||(a[167]=l("",3)),t("p",null,[a[72]||(a[72]=e("Another problem in neural network design is the symmetry inherent in their parametrization. Assume that we have a simple MLP with one hidden layer and two units. In this case, we could permute the weights ")),t("mjx-container",N,[(T(),Q("svg",J,a[70]||(a[70]=[l("",1)]))),a[71]||(a[71]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[73]||(a[73]=e(" of the first layer and likewise permute the weights of the output layer to obtain the same function. There is nothing special differentiating the first and second hidden units. In other words, we have permutation symmetry among the hidden units of each layer."))]),t("p",null,[a[82]||(a[82]=e("This is more than just a theoretical nuisance. Consider the aforementioned one-hidden-layer MLP with two hidden units. For illustration, suppose that the output layer transforms the two hidden units into only one output unit. Imagine what would happen if we initialized all the parameters of the hidden layer as ")),t("mjx-container",q,[(T(),Q("svg",W,a[74]||(a[74]=[l("",1)]))),a[75]||(a[75]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])]),t("mo",null,"="),t("mi",null,"c")])],-1))]),a[83]||(a[83]=e(" for some constant ")),t("mjx-container",U,[(T(),Q("svg",$,a[76]||(a[76]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D450",d:"M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z",style:{"stroke-width":"3"}})])])],-1)]))),a[77]||(a[77]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"c")])],-1))]),a[84]||(a[84]=e(". In this case, during forward propagation either hidden unit takes the same inputs and parameters producing the same activation which is fed to the output unit. During backpropagation, differentiating the output unit with respect to parameters ")),t("mjx-container",Y,[(T(),Q("svg",K,a[78]||(a[78]=[l("",1)]))),a[79]||(a[79]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[85]||(a[85]=e(" gives a gradient all of whose elements take the same value. Thus, after gradient-based iteration (e.g., minibatch stochastic gradient descent), all the elements of ")),t("mjx-container",t1,[(T(),Q("svg",a1,a[80]||(a[80]=[l("",1)]))),a[81]||(a[81]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])])])],-1))]),a[86]||(a[86]=e(" still take the same value. Such iterations would never ")),a[87]||(a[87]=t("em",null,"break the symmetry",-1)),a[88]||(a[88]=e(" on their own and we might never be able to realize the network's expressive power. The hidden layer would behave as if it had only a single unit. Note that while minibatch stochastic gradient descent would not break this symmetry, dropout regularization (to be introduced later) would!"))]),a[168]||(a[168]=l("",5)),t("p",null,[a[97]||(a[97]=e("Let's look at the scale distribution of an output ")),t("mjx-container",e1,[(T(),Q("svg",Q1,a[89]||(a[89]=[l("",1)]))),a[90]||(a[90]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])])])],-1))]),a[98]||(a[98]=e(" for some fully connected layer ")),a[99]||(a[99]=t("em",null,"without nonlinearities",-1)),a[100]||(a[100]=e(". With ")),t("mjx-container",T1,[(T(),Q("svg",l1,a[91]||(a[91]=[l("",1)]))),a[92]||(a[92]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")])])],-1))]),a[101]||(a[101]=e(" inputs ")),t("mjx-container",s1,[(T(),Q("svg",o1,a[93]||(a[93]=[l("",1)]))),a[94]||(a[94]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"x"),t("mi",null,"j")])])],-1))]),a[102]||(a[102]=e(" and their associated weights ")),t("mjx-container",n1,[(T(),Q("svg",r1,a[95]||(a[95]=[l("",1)]))),a[96]||(a[96]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])])],-1))]),a[103]||(a[103]=e(" for this layer, an output is given by"))]),t("mjx-container",i1,[(T(),Q("svg",d1,a[104]||(a[104]=[l("",1)]))),a[105]||(a[105]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")])])]),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])]),t("msub",null,[t("mi",null,"x"),t("mi",null,"j")]),t("mo",null,".")])],-1))]),t("p",null,[a[118]||(a[118]=e("The weights ")),t("mjx-container",m1,[(T(),Q("svg",h1,a[106]||(a[106]=[l("",1)]))),a[107]||(a[107]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])])],-1))]),a[119]||(a[119]=e(" are all drawn independently from the same distribution. Furthermore, let's assume that this distribution has zero mean and variance ")),t("mjx-container",p1,[(T(),Q("svg",g1,a[108]||(a[108]=[l("",1)]))),a[109]||(a[109]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"σ"),t("mn",null,"2")])])],-1))]),a[120]||(a[120]=e(". Note that this does not mean that the distribution has to be Gaussian, just that the mean and variance need to exist. For now, let's assume that the inputs to the layer ")),t("mjx-container",c1,[(T(),Q("svg",H1,a[110]||(a[110]=[l("",1)]))),a[111]||(a[111]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"x"),t("mi",null,"j")])])],-1))]),a[121]||(a[121]=e(" also have zero mean and variance ")),t("mjx-container",u1,[(T(),Q("svg",x1,a[112]||(a[112]=[l("",1)]))),a[113]||(a[113]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"γ"),t("mn",null,"2")])])],-1))]),a[122]||(a[122]=e(" and that they are independent of ")),t("mjx-container",w1,[(T(),Q("svg",V1,a[114]||(a[114]=[l("",1)]))),a[115]||(a[115]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])])],-1))]),a[123]||(a[123]=e(" and independent of each other. In this case, we can compute the mean of ")),t("mjx-container",f1,[(T(),Q("svg",y1,a[116]||(a[116]=[l("",1)]))),a[117]||(a[117]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"o"),t("mi",null,"i")])])],-1))]),a[124]||(a[124]=e(":"))]),t("mjx-container",k1,[(T(),Q("svg",L1,a[125]||(a[125]=[l("",1)]))),a[126]||(a[126]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{stretchy:"false"},"]")]),t("mtd",null,[t("mi"),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")])])]),t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])]),t("msub",null,[t("mi",null,"x"),t("mi",null,"j")]),t("mo",{stretchy:"false"},"]")])]),t("mtr",null,[t("mtd"),t("mtd",null,[t("mi"),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")])])]),t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])]),t("mo",{stretchy:"false"},"]"),t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msub",null,[t("mi",null,"x"),t("mi",null,"j")]),t("mo",{stretchy:"false"},"]")])]),t("mtr",null,[t("mtd"),t("mtd",null,[t("mi"),t("mo",null,"="),t("mn",null,"0"),t("mo",null,",")])])])])],-1))]),a[169]||(a[169]=t("p",null,"and the variance:",-1)),t("mjx-container",M1,[(T(),Q("svg",b1,a[127]||(a[127]=[l("",1)]))),a[128]||(a[128]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("mtext",null,"Var"),t("mo",{stretchy:"false"},"["),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{stretchy:"false"},"]")]),t("mtd",null,[t("mi"),t("mo",null,"="),t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msubsup",null,[t("mi",null,"o"),t("mi",null,"i"),t("mn",null,"2")]),t("mo",{stretchy:"false"},"]"),t("mo",null,"−"),t("mo",{stretchy:"false"},"("),t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msub",null,[t("mi",null,"o"),t("mi",null,"i")]),t("mo",{stretchy:"false"},"]"),t("msup",null,[t("mo",{stretchy:"false"},")"),t("mn",null,"2")])])]),t("mtr",null,[t("mtd"),t("mtd",null,[t("mi"),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")])])]),t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msubsup",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")]),t("mn",null,"2")]),t("msubsup",null,[t("mi",null,"x"),t("mi",null,"j"),t("mn",null,"2")]),t("mo",{stretchy:"false"},"]"),t("mo",null,"−"),t("mn",null,"0")])]),t("mtr",null,[t("mtd"),t("mtd",null,[t("mi"),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")])])]),t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msubsup",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")]),t("mn",null,"2")]),t("mo",{stretchy:"false"},"]"),t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msubsup",null,[t("mi",null,"x"),t("mi",null,"j"),t("mn",null,"2")]),t("mo",{stretchy:"false"},"]")])]),t("mtr",null,[t("mtd"),t("mtd",null,[t("mi"),t("mo",null,"="),t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")]),t("msup",null,[t("mi",null,"σ"),t("mn",null,"2")]),t("msup",null,[t("mi",null,"γ"),t("mn",null,"2")]),t("mo",null,".")])])])])],-1))]),t("p",null,[a[135]||(a[135]=e("One way to keep the variance fixed is to set ")),t("mjx-container",Z1,[(T(),Q("svg",v1,a[129]||(a[129]=[l("",1)]))),a[130]||(a[130]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")]),t("msup",null,[t("mi",null,"σ"),t("mn",null,"2")]),t("mo",null,"="),t("mn",null,"1")])],-1))]),a[136]||(a[136]=e(". Now consider backpropagation. There we face a similar problem, albeit with gradients being propagated from the layers closer to the output. Using the same reasoning as for forward propagation, we see that the gradients' variance can blow up unless ")),t("mjx-container",D1,[(T(),Q("svg",_1,a[131]||(a[131]=[l("",1)]))),a[132]||(a[132]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"out")]),t("msup",null,[t("mi",null,"σ"),t("mn",null,"2")]),t("mo",null,"="),t("mn",null,"1")])],-1))]),a[137]||(a[137]=e(", where ")),t("mjx-container",j1,[(T(),Q("svg",A1,a[133]||(a[133]=[l("",1)]))),a[134]||(a[134]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"n"),t("mtext",null,"out")])])],-1))]),a[138]||(a[138]=e(" is the number of outputs of this layer. This leaves us in a dilemma: we cannot possibly satisfy both conditions simultaneously. Instead, we simply try to satisfy:"))]),t("mjx-container",C1,[(T(),Q("svg",E1,a[139]||(a[139]=[l("",1)]))),a[140]||(a[140]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right",columnspacing:"",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("mfrac",null,[t("mn",null,"1"),t("mn",null,"2")]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")]),t("mo",null,"+"),t("msub",null,[t("mi",null,"n"),t("mtext",null,"out")]),t("mo",{stretchy:"false"},")"),t("msup",null,[t("mi",null,"σ"),t("mn",null,"2")]),t("mo",null,"="),t("mn",null,"1"),t("mtext",null," or equivalently "),t("mi",null,"σ"),t("mo",null,"="),t("msqrt",null,[t("mfrac",null,[t("mn",null,"2"),t("mrow",null,[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")]),t("mo",null,"+"),t("msub",null,[t("mi",null,"n"),t("mtext",null,"out")])])])]),t("mo",null,".")])])])])],-1))]),t("p",null,[a[151]||(a[151]=e("This is the reasoning underlying the now-standard and practically beneficial ")),a[152]||(a[152]=t("em",null,"Xavier initialization",-1)),a[153]||(a[153]=e(", named after the first author of its creators ")),a[154]||(a[154]=t("a",{href:"./@cite"},"Glorot.Bengio.2010",-1)),a[155]||(a[155]=e(". Typically, the Xavier initialization samples weights from a Gaussian distribution with zero mean and variance ")),t("mjx-container",R1,[(T(),Q("svg",S1,a[141]||(a[141]=[l("",1)]))),a[142]||(a[142]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"σ"),t("mn",null,"2")]),t("mo",null,"="),t("mfrac",null,[t("mn",null,"2"),t("mrow",null,[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")]),t("mo",null,"+"),t("msub",null,[t("mi",null,"n"),t("mtext",null,"out")])])])])],-1))]),a[156]||(a[156]=e(". We can also adapt this to choose the variance when sampling weights from a uniform distribution. Note that the uniform distribution ")),t("mjx-container",O1,[(T(),Q("svg",P1,a[143]||(a[143]=[l("",1)]))),a[144]||(a[144]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"U"),t("mo",{stretchy:"false"},"("),t("mo",null,"−"),t("mi",null,"a"),t("mo",null,","),t("mi",null,"a"),t("mo",{stretchy:"false"},")")])],-1))]),a[157]||(a[157]=e(" has variance ")),t("mjx-container",z1,[(T(),Q("svg",B1,a[145]||(a[145]=[l("",1)]))),a[146]||(a[146]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mfrac",null,[t("msup",null,[t("mi",null,"a"),t("mn",null,"2")]),t("mn",null,"3")])])],-1))]),a[158]||(a[158]=e(". Plugging ")),t("mjx-container",I1,[(T(),Q("svg",X1,a[147]||(a[147]=[l("",1)]))),a[148]||(a[148]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mfrac",null,[t("msup",null,[t("mi",null,"a"),t("mn",null,"2")]),t("mn",null,"3")])])],-1))]),a[159]||(a[159]=e(" into our condition on ")),t("mjx-container",F1,[(T(),Q("svg",G1,a[149]||(a[149]=[l("",1)]))),a[150]||(a[150]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"σ"),t("mn",null,"2")])])],-1))]),a[160]||(a[160]=e(" prompts us to initialize according to"))]),t("mjx-container",N1,[(T(),Q("svg",J1,a[161]||(a[161]=[l("",1)]))),a[162]||(a[162]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"U"),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mo",null,"−"),t("msqrt",null,[t("mfrac",null,[t("mn",null,"6"),t("mrow",null,[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")]),t("mo",null,"+"),t("msub",null,[t("mi",null,"n"),t("mtext",null,"out")])])])]),t("mo",null,","),t("msqrt",null,[t("mfrac",null,[t("mn",null,"6"),t("mrow",null,[t("msub",null,[t("mi",null,"n"),t("mtext",null,"in")]),t("mo",null,"+"),t("msub",null,[t("mi",null,"n"),t("mtext",null,"out")])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,".")])],-1))]),a[170]||(a[170]=l("",9))])}const e2=s(o,[["render",q1]]);export{a2 as __pageData,e2 as default};
