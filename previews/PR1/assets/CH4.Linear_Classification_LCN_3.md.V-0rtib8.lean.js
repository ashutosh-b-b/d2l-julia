import{_ as n,c as l,o as e,aA as a,j as s,a as t}from"./chunks/framework.DjA5121Y.js";const z=JSON.parse('{"title":"Softmax Regression Implementation from Scratch","description":"","frontmatter":{},"headers":[],"relativePath":"CH4.Linear_Classification/LCN_3.md","filePath":"CH4.Linear_Classification/LCN_3.md","lastUpdated":null}'),p={name:"CH4.Linear_Classification/LCN_3.md"},o={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.27ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.116ex",height:"5.673ex",role:"img",focusable:"false",viewBox:"0 -1504.2 13311.3 2507.4","aria-hidden":"true"},r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.291ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 3222.4 688","aria-hidden":"true"},d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.422ex",height:"1.581ex",role:"img",focusable:"false",viewBox:"0 -677 3722.4 699","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.159ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 2722.4 688","aria-hidden":"true"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.291ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 3222.4 688","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.457ex",role:"img",focusable:"false",viewBox:"0 -444 607 644","aria-hidden":"true"},E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.452ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"2.29ex",role:"img",focusable:"false",viewBox:"0 -812 607 1012","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.131ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 500 688","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.131ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 500 666","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.394ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 1500 688","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.154ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 2278 748","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.663ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.848ex",height:"2.496ex",role:"img",focusable:"false",viewBox:"0 -810 4794.9 1103.1","aria-hidden":"true"};function _(A,i,D,Z,j,S){return e(),l("div",null,[i[64]||(i[64]=a("",7)),s("mjx-container",o,[(e(),l("svg",h,i[0]||(i[0]=[a("",1)]))),i[1]||(i[1]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{"data-mjx-auto-op":"false"},"softmax")]),s("mo",{stretchy:"false"},"("),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"X")]),s("msub",null,[s("mo",{stretchy:"false"},")"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mi",null,"j")])]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"exp"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"X")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mi",null,"j")])]),s("mo",{stretchy:"false"},")")]),s("mrow",null,[s("munder",null,[s("mo",{"data-mjx-texclass":"OP"},"∑"),s("mi",null,"k")]),s("mi",null,"exp"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"X")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mi",null,"k")])]),s("mo",{stretchy:"false"},")")])]),s("mo",null,".")])],-1))]),i[65]||(i[65]=a("",6)),s("p",null,[i[4]||(i[4]=t("We now have everything that we need to implement the softmax regression model. As in our linear regression example, each instance will be represented by a fixed-length vector. Since the raw data here consists of ")),s("mjx-container",r,[(e(),l("svg",Q,i[2]||(i[2]=[a("",1)]))),i[3]||(i[3]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"28"),s("mo",null,"×"),s("mn",null,"28")])],-1))]),i[5]||(i[5]=t(" pixel images, we flatten each image, treating them as vectors of length 784. In later chapters, we will introduce convolutional neural networks, which exploit the spatial structure in a more satisfying way."))]),s("p",null,[i[10]||(i[10]=t("In softmax regression, the number of outputs from our network should be equal to the number of classes. Since our dataset has 10 classes, our network has an output dimension of 10. Consequently, our weights constitute a ")),s("mjx-container",d,[(e(),l("svg",T,i[6]||(i[6]=[a("",1)]))),i[7]||(i[7]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"784"),s("mo",null,"×"),s("mn",null,"10")])],-1))]),i[11]||(i[11]=t(" matrix plus a ")),s("mjx-container",k,[(e(),l("svg",c,i[8]||(i[8]=[a("",1)]))),i[9]||(i[9]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"1"),s("mo",null,"×"),s("mn",null,"10")])],-1))]),i[12]||(i[12]=t(" row vector for the biases. As with linear regression, we initialize the weights ")),i[13]||(i[13]=s("code",null,"W",-1)),i[14]||(i[14]=t(" with Gaussian noise. The biases are initialized as zeros."))]),i[66]||(i[66]=a("",1)),s("p",null,[i[17]||(i[17]=t("The code below defines how the network maps each input to an output. Note that we flatten each ")),s("mjx-container",m,[(e(),l("svg",g,i[15]||(i[15]=[a("",1)]))),i[16]||(i[16]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"28"),s("mo",null,"×"),s("mn",null,"28")])],-1))]),i[18]||(i[18]=t(" pixel image in the batch into a vector using ")),i[19]||(i[19]=s("code",null,"reshape",-1)),i[20]||(i[20]=t(" before passing the data through our model."))]),i[67]||(i[67]=a("",3)),s("p",null,[i[25]||(i[25]=t("Recall that cross-entropy takes the negative log-likelihood of the predicted probability assigned to the true label. For efficiency we avoid Python for-loops and use indexing instead. In particular, the one-hot encoding in ")),s("mjx-container",u,[(e(),l("svg",y,i[21]||(i[21]=[a("",1)]))),i[22]||(i[22]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"y")])])],-1))]),i[26]||(i[26]=t(" allows us to select the matching terms in ")),s("mjx-container",E,[(e(),l("svg",f,i[23]||(i[23]=[a("",1)]))),i[24]||(i[24]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mover",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"y")]),s("mo",{stretchy:"false"},"^")])])])],-1))]),i[27]||(i[27]=t("."))]),s("p",null,[i[32]||(i[32]=t("To see this in action we create sample data ")),i[33]||(i[33]=s("code",null,"y_hat",-1)),i[34]||(i[34]=t(" with 2 examples of predicted probabilities over 3 classes and their corresponding labels ")),i[35]||(i[35]=s("code",null,"y",-1)),i[36]||(i[36]=t(". The correct labels are ")),s("mjx-container",L,[(e(),l("svg",x,i[28]||(i[28]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mn"},[s("path",{"data-c":"30",d:"M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z",style:{"stroke-width":"3"}})])])],-1)]))),i[29]||(i[29]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"0")])],-1))]),i[37]||(i[37]=t(" and ")),s("mjx-container",w,[(e(),l("svg",H,i[30]||(i[30]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mn"},[s("path",{"data-c":"32",d:"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z",style:{"stroke-width":"3"}})])])],-1)]))),i[31]||(i[31]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"2")])],-1))]),i[38]||(i[38]=t(" respectively (i.e., the first and third class). Using ")),i[39]||(i[39]=s("code",null,"y",-1)),i[40]||(i[40]=t(" as the indices of the probabilities in ")),i[41]||(i[41]=s("code",null,"y_hat",-1)),i[42]||(i[42]=t(", we can pick out terms efficiently."))]),i[68]||(i[68]=a("",16)),s("ol",null,[i[61]||(i[61]=s("li",null,[s("p",null,[t("In this section, we directly implemented the softmax function based on the mathematical definition of the softmax operation. As discussed in :numref:"),s("code",null,"sec_softmax"),t(" this can cause numerical instabilities.")])],-1)),s("li",null,[s("p",null,[i[45]||(i[45]=t("Test whether ")),i[46]||(i[46]=s("code",null,"softmax",-1)),i[47]||(i[47]=t(" still works correctly if an input has a value of ")),s("mjx-container",b,[(e(),l("svg",F,i[43]||(i[43]=[a("",1)]))),i[44]||(i[44]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"100")])],-1))]),i[48]||(i[48]=t("."))])]),s("li",null,[s("p",null,[i[51]||(i[51]=t("Test whether ")),i[52]||(i[52]=s("code",null,"softmax",-1)),i[53]||(i[53]=t(" still works correctly if the largest of all inputs is smaller than ")),s("mjx-container",C,[(e(),l("svg",V,i[49]||(i[49]=[a("",1)]))),i[50]||(i[50]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mo",null,"−"),s("mn",null,"100")])],-1))]),i[54]||(i[54]=t("."))])]),i[62]||(i[62]=s("li",null,[s("p",null,"Implement a fix by looking at the value relative to the largest entry in the argument.")],-1)),s("li",null,[s("p",null,[i[57]||(i[57]=t("Implement a ")),i[58]||(i[58]=s("code",null,"cross_entropy",-1)),i[59]||(i[59]=t(" function that follows the definition of the cross-entropy loss function ")),s("mjx-container",v,[(e(),l("svg",M,i[55]||(i[55]=[a("",1)]))),i[56]||(i[56]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("munder",null,[s("mo",{"data-mjx-texclass":"OP"},"∑"),s("mi",null,"i")]),s("msub",null,[s("mi",null,"y"),s("mi",null,"i")]),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mover",null,[s("mi",null,"y"),s("mo",{stretchy:"false"},"^")])]),s("mi",null,"i")])])],-1))]),i[60]||(i[60]=t("."))])]),i[63]||(i[63]=a("",9))]),i[69]||(i[69]=a("",1))])}const I=n(p,[["render",_]]);export{z as __pageData,I as default};
