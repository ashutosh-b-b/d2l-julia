import{_ as s,c as a,o as e,aA as l,j as t,a as T}from"./chunks/framework.DjA5121Y.js";const o="/d2l-julia/previews/PR1/assets/truncated-bptt.B30JmEKw.svg",m="/d2l-julia/previews/PR1/assets/rnn-bptt.BqlDN94d.svg",o6=JSON.parse('{"title":"Backpropagation Through Time","description":"","frontmatter":{},"headers":[],"relativePath":"CH8.Recurrent_Neural_Networks/RNN_7.md","filePath":"CH8.Recurrent_Neural_Networks/RNN_7.md","lastUpdated":null}'),n={name:"CH8.Recurrent_Neural_Networks/RNN_7.md"},d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.068ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 914.3 851.8","aria-hidden":"true"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.059ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 910.3 599.8","aria-hidden":"true"},p={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.863ex",height:"1.355ex",role:"img",focusable:"false",viewBox:"0 -441 823.3 598.8","aria-hidden":"true"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.697ex",height:"1.342ex",role:"img",focusable:"false",viewBox:"0 -443 1192.2 593","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.355ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.608ex",height:"1.358ex",role:"img",focusable:"false",viewBox:"0 -443 1152.6 600.1","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.036ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.601ex",height:"5.204ex",role:"img",focusable:"false",viewBox:"0 -1400 8663.5 2300","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.244ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 550 910","aria-hidden":"true"},M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.079ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 477 647","aria-hidden":"true"},Z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"36.62ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 16186 1000","aria-hidden":"true"},D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.763ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4315.1 1000","aria-hidden":"true"},j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.863ex",height:"1.355ex",role:"img",focusable:"false",viewBox:"0 -441 823.3 598.8","aria-hidden":"true"},R={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.874ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 828.3 647","aria-hidden":"true"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.593ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -677 704 677","aria-hidden":"true"},P={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},I={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"48.546ex",height:"6.73ex",role:"img",focusable:"false",viewBox:"0 -1728.7 21457.5 2974.6","aria-hidden":"true"},E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.697ex",height:"1.342ex",role:"img",focusable:"false",viewBox:"0 -443 1192.2 593","aria-hidden":"true"},X={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},z={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},G={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-6.504ex"},xmlns:"http://www.w3.org/2000/svg",width:"40.452ex",height:"14.139ex",role:"img",focusable:"false",viewBox:"0 -3374.6 17879.9 6249.3","aria-hidden":"true"},J={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.458ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3738.4 1000","aria-hidden":"true"},q={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.697ex",height:"1.342ex",role:"img",focusable:"false",viewBox:"0 -443 1192.2 593","aria-hidden":"true"},$={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.068ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 914.3 851.8","aria-hidden":"true"},K={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.068ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 914.3 851.8","aria-hidden":"true"},t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.113ex",height:"2.041ex",role:"img",focusable:"false",viewBox:"0 -694 1817.9 902","aria-hidden":"true"},T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.697ex",height:"1.342ex",role:"img",focusable:"false",viewBox:"0 -443 1192.2 593","aria-hidden":"true"},e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.113ex",height:"2.041ex",role:"img",focusable:"false",viewBox:"0 -694 1817.9 902","aria-hidden":"true"},s1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.697ex",height:"1.342ex",role:"img",focusable:"false",viewBox:"0 -443 1192.2 593","aria-hidden":"true"},m1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.068ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 914.3 851.8","aria-hidden":"true"},d1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.697ex",height:"1.342ex",role:"img",focusable:"false",viewBox:"0 -443 1192.2 593","aria-hidden":"true"},i1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},h1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"50.098ex",height:"5.326ex",role:"img",focusable:"false",viewBox:"0 -1460 22143.5 2354","aria-hidden":"true"},p1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.242ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6295.1 1000","aria-hidden":"true"},H1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.375ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.333ex",height:"1.881ex",role:"img",focusable:"false",viewBox:"0 -666 2799.1 831.6","aria-hidden":"true"},x1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.232ex",height:"2.041ex",role:"img",focusable:"false",viewBox:"0 -694 6732.7 902","aria-hidden":"true"},c1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.76ex",height:"1.946ex",role:"img",focusable:"false",viewBox:"0 -666 4755.9 860","aria-hidden":"true"},V1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.312ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.965ex",height:"1.819ex",role:"img",focusable:"false",viewBox:"0 -666 2194.6 804","aria-hidden":"true"},y1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},k1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.752ex",height:"6.972ex",role:"img",focusable:"false",viewBox:"0 -1749.5 11382.2 3081.7","aria-hidden":"true"},M1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.962ex",height:"1.355ex",role:"img",focusable:"false",viewBox:"0 -441 867.3 598.8","aria-hidden":"true"},Z1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.736ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 767.3 851.8","aria-hidden":"true"},D1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.745ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 771.3 599.8","aria-hidden":"true"},j1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},C1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-7.893ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.77ex",height:"16.916ex",role:"img",focusable:"false",viewBox:"0 -3988.5 9622.5 7477","aria-hidden":"true"},R1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.232ex",height:"2.041ex",role:"img",focusable:"false",viewBox:"0 -694 6732.7 902","aria-hidden":"true"},S1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},O1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"72.089ex",height:"6.972ex",role:"img",focusable:"false",viewBox:"0 -1749.5 31863.2 3081.7","aria-hidden":"true"},P1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.458ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3738.4 1000","aria-hidden":"true"},E1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637","aria-hidden":"true"},X1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.029ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.17ex",height:"1.005ex",role:"img",focusable:"false",viewBox:"0 -431 517 444","aria-hidden":"true"},z1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.53ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4654.1 1000","aria-hidden":"true"},J1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.458ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3738.4 1000","aria-hidden":"true"},q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.756ex",height:"2.057ex",role:"img",focusable:"false",viewBox:"0 -704 776.3 909","aria-hidden":"true"},$1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.352ex",height:"1.864ex",role:"img",focusable:"false",viewBox:"0 -666 4575.4 823.8","aria-hidden":"true"},K1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.333ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 8103.1 1000","aria-hidden":"true"},t2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.626ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.827ex",height:"2.623ex",role:"img",focusable:"false",viewBox:"0 -882.5 7437.3 1159.3","aria-hidden":"true"},T2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.891ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3929.8 1000","aria-hidden":"true"},e2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.458ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3738.4 1000","aria-hidden":"true"},s2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},o2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"48.699ex",height:"5.326ex",role:"img",focusable:"false",viewBox:"0 -1460 21524.9 2354","aria-hidden":"true"},m2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.756ex",height:"2.057ex",role:"img",focusable:"false",viewBox:"0 -704 776.3 909","aria-hidden":"true"},d2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.279ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 7195.2 1000","aria-hidden":"true"},i2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.905ex",height:"2.057ex",role:"img",focusable:"false",viewBox:"0 -704 2609.8 909","aria-hidden":"true"},p2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637","aria-hidden":"true"},H2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.714ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3851.6 1000","aria-hidden":"true"},x2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637","aria-hidden":"true"},c2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.558ex",height:"2.288ex",role:"img",focusable:"false",viewBox:"0 -853.7 3340.5 1011.5","aria-hidden":"true"},V2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.874ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 828.3 647","aria-hidden":"true"},y2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.72ex",height:"2.288ex",role:"img",focusable:"false",viewBox:"0 -853.7 3412.1 1011.5","aria-hidden":"true"},M2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.389ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 3266.1 840.8","aria-hidden":"true"},Z2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},v2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.078ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.286ex",height:"5.288ex",role:"img",focusable:"false",viewBox:"0 -1418.6 10734.3 2337.2","aria-hidden":"true"},D2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.197ex",height:"2.271ex",role:"img",focusable:"false",viewBox:"0 -853.7 5391.2 1003.7","aria-hidden":"true"},j2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.332ex",height:"2.271ex",role:"img",focusable:"false",viewBox:"0 -853.7 5450.6 1003.7","aria-hidden":"true"},R2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.101ex",height:"2.581ex",role:"img",focusable:"false",viewBox:"0 -853.7 5348.8 1140.9","aria-hidden":"true"},S2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.381ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3262.2 1000","aria-hidden":"true"},P2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637","aria-hidden":"true"},E2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.593ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -677 704 677","aria-hidden":"true"},X2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.177ex",height:"6.73ex",role:"img",focusable:"false",viewBox:"0 -1728.7 8476.1 2974.6","aria-hidden":"true"},z2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.375ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.433ex",height:"1.945ex",role:"img",focusable:"false",viewBox:"0 -694 1075.6 859.6","aria-hidden":"true"},J2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.612ex",height:"1.891ex",role:"img",focusable:"false",viewBox:"0 -686 2038.5 836","aria-hidden":"true"},q2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.657ex",height:"1.891ex",role:"img",focusable:"false",viewBox:"0 -686 2058.3 836","aria-hidden":"true"},$2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.433ex",height:"1.91ex",role:"img",focusable:"false",viewBox:"0 -694 1075.6 844","aria-hidden":"true"},K2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.375ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.361ex",height:"1.379ex",role:"img",focusable:"false",viewBox:"0 -444 1043.6 609.6","aria-hidden":"true"},t3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.612ex",height:"1.891ex",role:"img",focusable:"false",viewBox:"0 -686 2038.5 836","aria-hidden":"true"},T3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.657ex",height:"1.891ex",role:"img",focusable:"false",viewBox:"0 -686 2058.3 836","aria-hidden":"true"},e3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.612ex",height:"2.202ex",role:"img",focusable:"false",viewBox:"0 -686 2038.5 973.2","aria-hidden":"true"},s3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.845ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4351.5 1000","aria-hidden":"true"},m3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.89ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4371.3 1000","aria-hidden":"true"},d3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.845ex",height:"2.347ex",role:"img",focusable:"false",viewBox:"0 -750 4351.5 1037.2","aria-hidden":"true"},i3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.534ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 2004 888","aria-hidden":"true"},p3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637","aria-hidden":"true"},H3={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},u3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.909ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.968ex",height:"5.212ex",role:"img",focusable:"false",viewBox:"0 -1460 10151.8 2303.8","aria-hidden":"true"},x3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.612ex",height:"2.202ex",role:"img",focusable:"false",viewBox:"0 -686 2038.5 973.2","aria-hidden":"true"},c3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.334ex",height:"2.581ex",role:"img",focusable:"false",viewBox:"0 -853.7 7661.8 1140.9","aria-hidden":"true"},V3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},y3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.612ex",height:"2.202ex",role:"img",focusable:"false",viewBox:"0 -686 2038.5 973.2","aria-hidden":"true"},M3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.944ex",height:"1.462ex",role:"img",focusable:"false",viewBox:"0 -452 4395.4 646","aria-hidden":"true"},Z3={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},v3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"48.537ex",height:"6.73ex",role:"img",focusable:"false",viewBox:"0 -1728.7 21453.4 2974.6","aria-hidden":"true"},D3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.299ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3226.3 1000","aria-hidden":"true"},j3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.593ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -677 704 677","aria-hidden":"true"},R3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},S3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.76ex",height:"1.91ex",role:"img",focusable:"false",viewBox:"0 -694 1219.8 844","aria-hidden":"true"},P3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.615ex",height:"1.362ex",role:"img",focusable:"false",viewBox:"0 -452 1155.8 602","aria-hidden":"true"},E3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.501ex",height:"2.497ex",role:"img",focusable:"false",viewBox:"0 -853.7 5967.7 1103.7","aria-hidden":"true"},X3={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.148ex"},xmlns:"http://www.w3.org/2000/svg",width:"40.376ex",height:"5.428ex",role:"img",focusable:"false",viewBox:"0 -1449.5 17846.2 2399","aria-hidden":"true"},z3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.427ex",height:"1.622ex",role:"img",focusable:"false",viewBox:"0 -677 2398.6 717","aria-hidden":"true"},J3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},q3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.211ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 977.3 851.8","aria-hidden":"true"},$3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.471ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.256ex",height:"2.041ex",role:"img",focusable:"false",viewBox:"0 -694 1880.9 902","aria-hidden":"true"},K3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.066ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -452 913.3 609.8","aria-hidden":"true"},t4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.953ex",height:"2.497ex",role:"img",focusable:"false",viewBox:"0 -853.7 5725.1 1103.7","aria-hidden":"true"},T4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.427ex",height:"1.622ex",role:"img",focusable:"false",viewBox:"0 -677 2398.6 717","aria-hidden":"true"},e4={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},l4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.148ex"},xmlns:"http://www.w3.org/2000/svg",width:"77.211ex",height:"5.428ex",role:"img",focusable:"false",viewBox:"0 -1449.5 34127.4 2399","aria-hidden":"true"},s4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.312ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.575ex",height:"1.844ex",role:"img",focusable:"false",viewBox:"0 -677 4232.1 815","aria-hidden":"true"},m4={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},n4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.811ex"},xmlns:"http://www.w3.org/2000/svg",width:"34.739ex",height:"6.722ex",role:"img",focusable:"false",viewBox:"0 -1728.7 15354.5 2971.1","aria-hidden":"true"},d4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.696ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.657ex",height:"2.586ex",role:"img",focusable:"false",viewBox:"0 -835.3 2058.3 1143.1","aria-hidden":"true"},i4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},p4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.612ex",height:"1.891ex",role:"img",focusable:"false",viewBox:"0 -686 2038.5 836","aria-hidden":"true"},H4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.657ex",height:"1.891ex",role:"img",focusable:"false",viewBox:"0 -686 2058.3 836","aria-hidden":"true"},x4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.234ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 4523.4 888","aria-hidden":"true"},c4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.43ex",height:"2.497ex",role:"img",focusable:"false",viewBox:"0 -853.7 7704.2 1103.7","aria-hidden":"true"},V4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.565ex",height:"2.497ex",role:"img",focusable:"false",viewBox:"0 -853.7 7763.6 1103.7","aria-hidden":"true"},y4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.444ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3290.3 1000","aria-hidden":"true"},M4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.444ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3290.3 1000","aria-hidden":"true"},Z4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.845ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4351.5 1000","aria-hidden":"true"},D4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.89ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4371.3 1000","aria-hidden":"true"},j4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.222ex",height:"1.697ex",role:"img",focusable:"false",viewBox:"0 -710.2 4518.2 750.2","aria-hidden":"true"},R4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.059ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 910 851.8","aria-hidden":"true"},S4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.113ex",height:"1.361ex",role:"img",focusable:"false",viewBox:"0 -444 934 601.8","aria-hidden":"true"},P4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.327ex",height:"1.946ex",role:"img",focusable:"false",viewBox:"0 -666 5006.6 860","aria-hidden":"true"},E4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.564ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.695ex",height:"2.26ex",role:"img",focusable:"false",viewBox:"0 -749.5 5169.1 999","aria-hidden":"true"},X4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.492ex",height:"1.932ex",role:"img",focusable:"false",viewBox:"0 -853.7 1543.4 853.7","aria-hidden":"true"},z4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.679ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.34ex",height:"2.61ex",role:"img",focusable:"false",viewBox:"0 -853.7 1034.4 1153.7","aria-hidden":"true"},J4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.92ex",height:"1.636ex",role:"img",focusable:"false",viewBox:"0 -683 3058.8 723","aria-hidden":"true"},q4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"4.865ex",height:"1.932ex",role:"img",focusable:"false",viewBox:"0 -853.7 2150.4 853.7","aria-hidden":"true"},$4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.361ex",height:"1.344ex",role:"img",focusable:"false",viewBox:"0 -444 1043.6 594","aria-hidden":"true"},K4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.471ex",height:"1.552ex",role:"img",focusable:"false",viewBox:"0 -686 1092 686","aria-hidden":"true"};function t6(Q6,Q,T6,a6,e6,l6){return e(),a("div",null,[Q[456]||(Q[456]=l("",4)),t("p",null,[Q[12]||(Q[12]=T("We start with a simplified model of how an RNN works. This model ignores details about the specifics of the hidden state and how it is updated. The mathematical notation here does not explicitly distinguish scalars, vectors, and matrices. We are just trying to develop some intuition. In this simplified model, we denote ")),t("mjx-container",d,[(e(),a("svg",r,Q[0]||(Q[0]=[l("",1)]))),Q[1]||(Q[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])])],-1))]),Q[13]||(Q[13]=T(" as the hidden state, ")),t("mjx-container",i,[(e(),a("svg",h,Q[2]||(Q[2]=[l("",1)]))),Q[3]||(Q[3]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"x"),t("mi",null,"t")])])],-1))]),Q[14]||(Q[14]=T(" as input, and ")),t("mjx-container",p,[(e(),a("svg",g,Q[4]||(Q[4]=[l("",1)]))),Q[5]||(Q[5]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])])],-1))]),Q[15]||(Q[15]=T(" as output at time step ")),t("mjx-container",H,[(e(),a("svg",u,Q[6]||(Q[6]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D461",d:"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[7]||(Q[7]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t")])],-1))]),Q[16]||(Q[16]=T(". Recall our discussions in :numref:")),Q[17]||(Q[17]=t("code",null,"subsec_rnn_w_hidden_states",-1)),Q[18]||(Q[18]=T(" that the input and the hidden state can be concatenated before being multiplied by one weight variable in the hidden layer. Thus, we use ")),t("mjx-container",x,[(e(),a("svg",w,Q[8]||(Q[8]=[l("",1)]))),Q[9]||(Q[9]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[19]||(Q[19]=T(" and ")),t("mjx-container",c,[(e(),a("svg",L,Q[10]||(Q[10]=[l("",1)]))),Q[11]||(Q[11]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mtext",null,"o")])])],-1))]),Q[20]||(Q[20]=T(" to indicate the weights of the hidden layer and the output layer, respectively. As a result, the hidden states and outputs at each time step are"))]),t("mjx-container",V,[(e(),a("svg",f,Q[21]||(Q[21]=[l("",1)]))),Q[22]||(Q[22]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])]),t("mtd",null,[t("mi"),t("mo",null,"="),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")"),t("mo",null,",")])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])]),t("mtd",null,[t("mi"),t("mo",null,"="),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"o")]),t("mo",{stretchy:"false"},")"),t("mo",null,",")])])])])],-1))]),Q[457]||(Q[457]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_ht_ot")],-1)),t("p",null,[Q[37]||(Q[37]=T("where ")),t("mjx-container",y,[(e(),a("svg",k,Q[23]||(Q[23]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D453",d:"M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[24]||(Q[24]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"f")])],-1))]),Q[38]||(Q[38]=T(" and ")),t("mjx-container",M,[(e(),a("svg",b,Q[25]||(Q[25]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D454",d:"M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[26]||(Q[26]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"g")])],-1))]),Q[39]||(Q[39]=T(" are transformations of the hidden layer and the output layer, respectively. Hence, we have a chain of values ")),t("mjx-container",Z,[(e(),a("svg",v,Q[27]||(Q[27]=[l("",1)]))),Q[28]||(Q[28]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{fence:"false",stretchy:"false"},"{"),t("mo",null,"…"),t("mo",null,","),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mo",null,"…"),t("mo",{fence:"false",stretchy:"false"},"}")])],-1))]),Q[40]||(Q[40]=T(" that depend on each other via recurrent computation. The forward propagation is fairly straightforward. All we need is to loop through the ")),t("mjx-container",D,[(e(),a("svg",_,Q[29]||(Q[29]=[l("",1)]))),Q[30]||(Q[30]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")])],-1))]),Q[41]||(Q[41]=T(" triples one time step at a time. The discrepancy between output ")),t("mjx-container",j,[(e(),a("svg",C,Q[31]||(Q[31]=[l("",1)]))),Q[32]||(Q[32]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])])],-1))]),Q[42]||(Q[42]=T(" and the desired target ")),t("mjx-container",R,[(e(),a("svg",A,Q[33]||(Q[33]=[l("",1)]))),Q[34]||(Q[34]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"y"),t("mi",null,"t")])])],-1))]),Q[43]||(Q[43]=T(" is then evaluated by an objective function across all the ")),t("mjx-container",S,[(e(),a("svg",O,Q[35]||(Q[35]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D447",d:"M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[36]||(Q[36]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"T")])],-1))]),Q[44]||(Q[44]=T(" time steps as"))]),t("mjx-container",P,[(e(),a("svg",I,Q[45]||(Q[45]=[l("",1)]))),Q[46]||(Q[46]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"L"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mn",null,"1")]),t("mo",null,","),t("mo",null,"…"),t("mo",null,","),t("msub",null,[t("mi",null,"x"),t("mi",null,"T")]),t("mo",null,","),t("msub",null,[t("mi",null,"y"),t("mn",null,"1")]),t("mo",null,","),t("mo",null,"…"),t("mo",null,","),t("msub",null,[t("mi",null,"y"),t("mi",null,"T")]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"o")]),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mi",null,"T")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"T")]),t("mi",null,"l"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"y"),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")"),t("mo",null,".")])],-1))]),t("p",null,[Q[51]||(Q[51]=T("For backpropagation, matters are a bit trickier, especially when we compute the gradients with regard to the parameters ")),t("mjx-container",E,[(e(),a("svg",N,Q[47]||(Q[47]=[l("",1)]))),Q[48]||(Q[48]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[52]||(Q[52]=T(" of the objective function ")),t("mjx-container",X,[(e(),a("svg",B,Q[49]||(Q[49]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[50]||(Q[50]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),Q[53]||(Q[53]=T(". To be specific, by the chain rule,"))]),t("mjx-container",z,[(e(),a("svg",G,Q[54]||(Q[54]=[l("",1)]))),Q[55]||(Q[55]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])])]),t("mtd",null,[t("mi"),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mi",null,"T")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"T")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"l"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"y"),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])])])]),t("mtr",null,[t("mtd"),t("mtd",null,[t("mi"),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mi",null,"T")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"T")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"l"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"y"),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"o"),t("mi",null,"t")])])]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"o")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])])]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,".")])])])])],-1))]),Q[458]||(Q[458]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_partial_L_wh")],-1)),t("p",null,[Q[76]||(Q[76]=T("The first and the second factors of the product in :eqref:")),Q[77]||(Q[77]=t("code",null,"eq_bptt_partial_L_wh",-1)),Q[78]||(Q[78]=T(" are easy to compute. The third factor ")),t("mjx-container",J,[(e(),a("svg",F,Q[56]||(Q[56]=[l("",1)]))),Q[57]||(Q[57]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[79]||(Q[79]=T(" is where things get tricky, since we need to recurrently compute the effect of the parameter ")),t("mjx-container",q,[(e(),a("svg",W,Q[58]||(Q[58]=[l("",1)]))),Q[59]||(Q[59]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[80]||(Q[80]=T(" on ")),t("mjx-container",$,[(e(),a("svg",U,Q[60]||(Q[60]=[l("",1)]))),Q[61]||(Q[61]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])])],-1))]),Q[81]||(Q[81]=T(". According to the recurrent computation in :eqref:")),Q[82]||(Q[82]=t("code",null,"eq_bptt_ht_ot",-1)),Q[83]||(Q[83]=T(", ")),t("mjx-container",K,[(e(),a("svg",Y,Q[62]||(Q[62]=[l("",1)]))),Q[63]||(Q[63]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])])],-1))]),Q[84]||(Q[84]=T(" depends on both ")),t("mjx-container",t1,[(e(),a("svg",Q1,Q[64]||(Q[64]=[l("",1)]))),Q[65]||(Q[65]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])])],-1))]),Q[85]||(Q[85]=T(" and ")),t("mjx-container",T1,[(e(),a("svg",a1,Q[66]||(Q[66]=[l("",1)]))),Q[67]||(Q[67]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[86]||(Q[86]=T(", where computation of ")),t("mjx-container",e1,[(e(),a("svg",l1,Q[68]||(Q[68]=[l("",1)]))),Q[69]||(Q[69]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])])],-1))]),Q[87]||(Q[87]=T(" also depends on ")),t("mjx-container",s1,[(e(),a("svg",o1,Q[70]||(Q[70]=[l("",1)]))),Q[71]||(Q[71]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[88]||(Q[88]=T(". Thus, evaluating the total derivate of ")),t("mjx-container",m1,[(e(),a("svg",n1,Q[72]||(Q[72]=[l("",1)]))),Q[73]||(Q[73]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])])],-1))]),Q[89]||(Q[89]=T(" with respect to ")),t("mjx-container",d1,[(e(),a("svg",r1,Q[74]||(Q[74]=[l("",1)]))),Q[75]||(Q[75]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[90]||(Q[90]=T(" using the chain rule yields"))]),t("mjx-container",i1,[(e(),a("svg",h1,Q[91]||(Q[91]=[l("",1)]))),Q[92]||(Q[92]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,"+"),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])])]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,".")])],-1))]),Q[459]||(Q[459]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_partial_ht_wh_recur")],-1)),t("p",null,[Q[103]||(Q[103]=T("To derive the above gradient, assume that we have three sequences ")),t("mjx-container",p1,[(e(),a("svg",g1,Q[93]||(Q[93]=[l("",1)]))),Q[94]||(Q[94]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{fence:"false",stretchy:"false"},"{"),t("msub",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",{fence:"false",stretchy:"false"},"}"),t("mo",null,","),t("mo",{fence:"false",stretchy:"false"},"{"),t("msub",null,[t("mi",null,"b"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",{fence:"false",stretchy:"false"},"}"),t("mo",null,","),t("mo",{fence:"false",stretchy:"false"},"{"),t("msub",null,[t("mi",null,"c"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",{fence:"false",stretchy:"false"},"}")])],-1))]),Q[104]||(Q[104]=T(" satisfying ")),t("mjx-container",H1,[(e(),a("svg",u1,Q[95]||(Q[95]=[l("",1)]))),Q[96]||(Q[96]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"0")])]),t("mo",null,"="),t("mn",null,"0")])],-1))]),Q[105]||(Q[105]=T(" and ")),t("mjx-container",x1,[(e(),a("svg",w1,Q[97]||(Q[97]=[l("",1)]))),Q[98]||(Q[98]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,"="),t("msub",null,[t("mi",null,"b"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,"+"),t("msub",null,[t("mi",null,"c"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("msub",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])])],-1))]),Q[106]||(Q[106]=T(" for ")),t("mjx-container",c1,[(e(),a("svg",L1,Q[99]||(Q[99]=[l("",1)]))),Q[100]||(Q[100]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1"),t("mo",null,","),t("mn",null,"2"),t("mo",null,","),t("mo",null,"…")])],-1))]),Q[107]||(Q[107]=T(". Then for ")),t("mjx-container",V1,[(e(),a("svg",f1,Q[101]||(Q[101]=[l("",1)]))),Q[102]||(Q[102]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t"),t("mo",null,"≥"),t("mn",null,"1")])],-1))]),Q[108]||(Q[108]=T(", it is easy to show"))]),t("mjx-container",y1,[(e(),a("svg",k1,Q[109]||(Q[109]=[l("",1)]))),Q[110]||(Q[110]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,"="),t("msub",null,[t("mi",null,"b"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,"+"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∏"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mi",null,"i"),t("mo",null,"+"),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("msub",null,[t("mi",null,"c"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("msub",null,[t("mi",null,"b"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",null,".")])],-1))]),Q[460]||(Q[460]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_at")],-1)),t("p",null,[Q[117]||(Q[117]=T("By substituting ")),t("mjx-container",M1,[(e(),a("svg",b1,Q[111]||(Q[111]=[l("",1)]))),Q[112]||(Q[112]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"a"),t("mi",null,"t")])])],-1))]),Q[118]||(Q[118]=T(", ")),t("mjx-container",Z1,[(e(),a("svg",v1,Q[113]||(Q[113]=[l("",1)]))),Q[114]||(Q[114]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"b"),t("mi",null,"t")])])],-1))]),Q[119]||(Q[119]=T(", and ")),t("mjx-container",D1,[(e(),a("svg",_1,Q[115]||(Q[115]=[l("",1)]))),Q[116]||(Q[116]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"c"),t("mi",null,"t")])])],-1))]),Q[120]||(Q[120]=T(" according to"))]),t("mjx-container",j1,[(e(),a("svg",C1,Q[121]||(Q[121]=[l("",1)]))),Q[122]||(Q[122]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"a"),t("mi",null,"t")])]),t("mtd",null,[t("mi"),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,",")])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"b"),t("mi",null,"t")])]),t("mtd",null,[t("mi"),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,",")])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"c"),t("mi",null,"t")])]),t("mtd",null,[t("mi"),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])])]),t("mo",null,",")])])])])],-1))]),t("p",null,[Q[125]||(Q[125]=T("the gradient computation in :eqref:")),Q[126]||(Q[126]=t("code",null,"eq_bptt_partial_ht_wh_recur",-1)),Q[127]||(Q[127]=T(" satisfies ")),t("mjx-container",R1,[(e(),a("svg",A1,Q[123]||(Q[123]=[l("",1)]))),Q[124]||(Q[124]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,"="),t("msub",null,[t("mi",null,"b"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,"+"),t("msub",null,[t("mi",null,"c"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("msub",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])])],-1))]),Q[128]||(Q[128]=T(". Thus, per :eqref:")),Q[129]||(Q[129]=t("code",null,"eq_bptt_at",-1)),Q[130]||(Q[130]=T(", we can remove the recurrent computation in :eqref:")),Q[131]||(Q[131]=t("code",null,"eq_bptt_partial_ht_wh_recur",-1)),Q[132]||(Q[132]=T(" with"))]),t("mjx-container",S1,[(e(),a("svg",O1,Q[133]||(Q[133]=[l("",1)]))),Q[134]||(Q[134]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,"+"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∏"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mi",null,"i"),t("mo",null,"+"),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"−"),t("mn",null,"1")])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,".")])],-1))]),Q[461]||(Q[461]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_partial_ht_wh_gen")],-1)),t("p",null,[Q[139]||(Q[139]=T("While we can use the chain rule to compute ")),t("mjx-container",P1,[(e(),a("svg",I1,Q[135]||(Q[135]=[l("",1)]))),Q[136]||(Q[136]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[140]||(Q[140]=T(" recursively, this chain can get very long whenever ")),t("mjx-container",E1,[(e(),a("svg",N1,Q[137]||(Q[137]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D461",d:"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[138]||(Q[138]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t")])],-1))]),Q[141]||(Q[141]=T(" is large. Let's discuss a number of strategies for dealing with this problem."))]),Q[462]||(Q[462]=t("h3",{id:"Full-Computation",tabindex:"-1"},[T("Full Computation "),t("a",{class:"header-anchor",href:"#Full-Computation","aria-label":'Permalink to "Full Computation {#Full-Computation}"'},"​")],-1)),Q[463]||(Q[463]=t("p",null,[T("One idea might be to compute the full sum in :eqref:"),t("code",null,"eq_bptt_partial_ht_wh_gen"),T(". However, this is very slow and gradients can blow up, since subtle changes in the initial conditions can potentially affect the outcome a lot. That is, we could see things similar to the butterfly effect, where minimal changes in the initial conditions lead to disproportionate changes in the outcome. This is generally undesirable. After all, we are looking for robust estimators that generalize well. Hence this strategy is almost never used in practice.")],-1)),Q[464]||(Q[464]=t("h3",{id:"Truncating-Time-Steps###",tabindex:"-1"},[T("Truncating Time Steps### "),t("a",{class:"header-anchor",href:"#Truncating-Time-Steps###","aria-label":'Permalink to "Truncating Time Steps### {#Truncating-Time-Steps###}"'},"​")],-1)),t("p",null,[Q[146]||(Q[146]=T("Alternatively, we can truncate the sum in :eqref:")),Q[147]||(Q[147]=t("code",null,"eq_bptt_partial_ht_wh_gen",-1)),Q[148]||(Q[148]=T(" after ")),t("mjx-container",X1,[(e(),a("svg",B1,Q[142]||(Q[142]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D70F",d:"M39 284Q18 284 18 294Q18 301 45 338T99 398Q134 425 164 429Q170 431 332 431Q492 431 497 429Q517 424 517 402Q517 388 508 376T485 360Q479 358 389 358T299 356Q298 355 283 274T251 109T233 20Q228 5 215 -4T186 -13Q153 -13 153 20V30L203 192Q214 228 227 272T248 336L254 357Q254 358 208 358Q206 358 197 358T183 359Q105 359 61 295Q56 287 53 286T39 284Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[143]||(Q[143]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"τ")])],-1))]),Q[149]||(Q[149]=T(" steps. This is what we have been discussing so far. This leads to an ")),Q[150]||(Q[150]=t("em",null,"approximation",-1)),Q[151]||(Q[151]=T(" of the true gradient, simply by terminating the sum at ")),t("mjx-container",z1,[(e(),a("svg",G1,Q[144]||(Q[144]=[l("",1)]))),Q[145]||(Q[145]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mi",null,"τ")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[152]||(Q[152]=T(". In practice this works quite well. It is what is commonly referred to as truncated backpropgation through time [")),Q[153]||(Q[153]=t("a",{href:"/d2l-julia/previews/PR1/references#Jaeger_2002"},"161",-1)),Q[154]||(Q[154]=T("]. One of the consequences of this is that the model focuses primarily on short-term influence rather than long-term consequences. This is actually ")),Q[155]||(Q[155]=t("em",null,"desirable",-1)),Q[156]||(Q[156]=T(", since it biases the estimate towards simpler and more stable models."))]),Q[465]||(Q[465]=t("h3",{id:"Randomized-Truncation",tabindex:"-1"},[T("Randomized Truncation "),t("a",{class:"header-anchor",href:"#Randomized-Truncation","aria-label":'Permalink to "Randomized Truncation {#Randomized-Truncation}"'},"​")],-1)),t("p",null,[Q[171]||(Q[171]=T("Last, we can replace ")),t("mjx-container",J1,[(e(),a("svg",F1,Q[157]||(Q[157]=[l("",1)]))),Q[158]||(Q[158]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[172]||(Q[172]=T(" by a random variable which is correct in expectation but truncates the sequence. This is achieved by using a sequence of ")),t("mjx-container",q1,[(e(),a("svg",W1,Q[159]||(Q[159]=[l("",1)]))),Q[160]||(Q[160]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ξ"),t("mi",null,"t")])])],-1))]),Q[173]||(Q[173]=T(" with predefined ")),t("mjx-container",$1,[(e(),a("svg",U1,Q[161]||(Q[161]=[l("",1)]))),Q[162]||(Q[162]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"0"),t("mo",null,"≤"),t("msub",null,[t("mi",null,"π"),t("mi",null,"t")]),t("mo",null,"≤"),t("mn",null,"1")])],-1))]),Q[174]||(Q[174]=T(", where ")),t("mjx-container",K1,[(e(),a("svg",Y1,Q[163]||(Q[163]=[l("",1)]))),Q[164]||(Q[164]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"ξ"),t("mi",null,"t")]),t("mo",null,"="),t("mn",null,"0"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"π"),t("mi",null,"t")])])],-1))]),Q[175]||(Q[175]=T(" and ")),t("mjx-container",t2,[(e(),a("svg",Q2,Q[165]||(Q[165]=[l("",1)]))),Q[166]||(Q[166]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"ξ"),t("mi",null,"t")]),t("mo",null,"="),t("msubsup",null,[t("mi",null,"π"),t("mi",null,"t"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("msub",null,[t("mi",null,"π"),t("mi",null,"t")])])],-1))]),Q[176]||(Q[176]=T(", thus ")),t("mjx-container",T2,[(e(),a("svg",a2,Q[167]||(Q[167]=[l("",1)]))),Q[168]||(Q[168]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msub",null,[t("mi",null,"ξ"),t("mi",null,"t")]),t("mo",{stretchy:"false"},"]"),t("mo",null,"="),t("mn",null,"1")])],-1))]),Q[177]||(Q[177]=T(". We use this to replace the gradient ")),t("mjx-container",e2,[(e(),a("svg",l2,Q[169]||(Q[169]=[l("",1)]))),Q[170]||(Q[170]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[178]||(Q[178]=T(" in :eqref:")),Q[179]||(Q[179]=t("code",null,"eq_bptt_partial_ht_wh_recur",-1)),Q[180]||(Q[180]=T(" with"))]),t("mjx-container",s2,[(e(),a("svg",o2,Q[181]||(Q[181]=[l("",1)]))),Q[182]||(Q[182]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"z"),t("mi",null,"t")]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,"+"),t("msub",null,[t("mi",null,"ξ"),t("mi",null,"t")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,","),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])])]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])]),t("mo",null,".")])],-1))]),t("p",null,[Q[191]||(Q[191]=T("It follows from the definition of ")),t("mjx-container",m2,[(e(),a("svg",n2,Q[183]||(Q[183]=[l("",1)]))),Q[184]||(Q[184]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ξ"),t("mi",null,"t")])])],-1))]),Q[192]||(Q[192]=T(" that ")),t("mjx-container",d2,[(e(),a("svg",r2,Q[185]||(Q[185]=[l("",1)]))),Q[186]||(Q[186]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"E"),t("mo",{stretchy:"false"},"["),t("msub",null,[t("mi",null,"z"),t("mi",null,"t")]),t("mo",{stretchy:"false"},"]"),t("mo",null,"="),t("mi",null,"∂"),t("msub",null,[t("mi",null,"h"),t("mi",null,"t")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mi",null,"w"),t("mtext",null,"h")])])],-1))]),Q[193]||(Q[193]=T(". Whenever ")),t("mjx-container",i2,[(e(),a("svg",h2,Q[187]||(Q[187]=[l("",1)]))),Q[188]||(Q[188]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"ξ"),t("mi",null,"t")]),t("mo",null,"="),t("mn",null,"0")])],-1))]),Q[194]||(Q[194]=T(" the recurrent computation terminates at that time step ")),t("mjx-container",p2,[(e(),a("svg",g2,Q[189]||(Q[189]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D461",d:"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[190]||(Q[190]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t")])],-1))]),Q[195]||(Q[195]=T(". This leads to a weighted sum of sequences of varying lengths, where long sequences are rare but appropriately overweighted. This idea was proposed by ")),Q[196]||(Q[196]=t("a",{href:"/d2l-julia/previews/PR1/references#Tallec_Ollivier_2017"},"Tallec and Ollivier [162]",-1)),Q[197]||(Q[197]=T("."))]),Q[466]||(Q[466]=l("",7)),t("p",null,[Q[210]||(Q[210]=T("After discussing the general principle, let's discuss backpropagation through time in detail. In contrast to the analysis in :numref:")),Q[211]||(Q[211]=t("code",null,"subsec_bptt_analysis",-1)),Q[212]||(Q[212]=T(", in the following we will show how to compute the gradients of the objective function with respect to all the decomposed model parameters. To keep things simple, we consider an RNN without bias parameters, whose activation function in the hidden layer uses the identity mapping (")),t("mjx-container",H2,[(e(),a("svg",u2,Q[198]||(Q[198]=[l("",1)]))),Q[199]||(Q[199]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"ϕ"),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mi",null,"x")])],-1))]),Q[213]||(Q[213]=T("). For time step ")),t("mjx-container",x2,[(e(),a("svg",w2,Q[200]||(Q[200]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D461",d:"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[201]||(Q[201]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t")])],-1))]),Q[214]||(Q[214]=T(", let the single example input and the target be ")),t("mjx-container",c2,[(e(),a("svg",L2,Q[202]||(Q[202]=[l("",1)]))),Q[203]||(Q[203]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"t")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"d")])])],-1))]),Q[215]||(Q[215]=T(" and ")),t("mjx-container",V2,[(e(),a("svg",f2,Q[204]||(Q[204]=[l("",1)]))),Q[205]||(Q[205]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"y"),t("mi",null,"t")])])],-1))]),Q[216]||(Q[216]=T(", respectively. The hidden state ")),t("mjx-container",y2,[(e(),a("svg",k2,Q[206]||(Q[206]=[l("",1)]))),Q[207]||(Q[207]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"h")])])],-1))]),Q[217]||(Q[217]=T(" and the output ")),t("mjx-container",M2,[(e(),a("svg",b2,Q[208]||(Q[208]=[l("",1)]))),Q[209]||(Q[209]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"q")])])],-1))]),Q[218]||(Q[218]=T(" are computed as"))]),t("mjx-container",Z2,[(e(),a("svg",v2,Q[219]||(Q[219]=[l("",1)]))),Q[220]||(Q[220]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])]),t("mtd",null,[t("mi"),t("mo",null,"="),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hx")]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"t")]),t("mo",null,"+"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh")]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,",")])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])]),t("mtd",null,[t("mi"),t("mo",null,"="),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t")])]),t("mo",null,",")])])])])],-1))]),t("p",null,[Q[233]||(Q[233]=T("where ")),t("mjx-container",D2,[(e(),a("svg",_2,Q[221]||(Q[221]=[l("",1)]))),Q[222]||(Q[222]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hx")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"h"),t("mo",null,"×"),t("mi",null,"d")])])])],-1))]),Q[234]||(Q[234]=T(", ")),t("mjx-container",j2,[(e(),a("svg",C2,Q[223]||(Q[223]=[l("",1)]))),Q[224]||(Q[224]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"h"),t("mo",null,"×"),t("mi",null,"h")])])])],-1))]),Q[235]||(Q[235]=T(", and ")),t("mjx-container",R2,[(e(),a("svg",A2,Q[225]||(Q[225]=[l("",1)]))),Q[226]||(Q[226]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,"×"),t("mi",null,"h")])])])],-1))]),Q[236]||(Q[236]=T(" are the weight parameters. Denote by ")),t("mjx-container",S2,[(e(),a("svg",O2,Q[227]||(Q[227]=[l("",1)]))),Q[228]||(Q[228]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"l"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"y"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")])],-1))]),Q[237]||(Q[237]=T(" the loss at time step ")),t("mjx-container",P2,[(e(),a("svg",I2,Q[229]||(Q[229]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D461",d:"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[230]||(Q[230]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t")])],-1))]),Q[238]||(Q[238]=T(". Our objective function, the loss over ")),t("mjx-container",E2,[(e(),a("svg",N2,Q[231]||(Q[231]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D447",d:"M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[232]||(Q[232]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"T")])],-1))]),Q[239]||(Q[239]=T(" time steps from the beginning of the sequence is thus"))]),t("mjx-container",X2,[(e(),a("svg",B2,Q[240]||(Q[240]=[l("",1)]))),Q[241]||(Q[241]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"L"),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mi",null,"T")]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"T")]),t("mi",null,"l"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"y"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")"),t("mo",null,".")])],-1))]),t("p",null,[Q[252]||(Q[252]=T("In order to visualize the dependencies among model variables and parameters during computation of the RNN, we can draw a computational graph for the model, as shown in ")),Q[253]||(Q[253]=t("a",{href:"/d2l-julia/previews/PR1/CH8.Recurrent_Neural_Networks/RNN_7#fig_rnn_bptt"},"Figure",-1)),Q[254]||(Q[254]=T(". For example, the computation of the hidden states of time step 3, ")),t("mjx-container",z2,[(e(),a("svg",G2,Q[242]||(Q[242]=[l("",1)]))),Q[243]||(Q[243]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mn",null,"3")])])],-1))]),Q[255]||(Q[255]=T(", depends on the model parameters ")),t("mjx-container",J2,[(e(),a("svg",F2,Q[244]||(Q[244]=[l("",1)]))),Q[245]||(Q[245]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hx")])])],-1))]),Q[256]||(Q[256]=T(" and ")),t("mjx-container",q2,[(e(),a("svg",W2,Q[246]||(Q[246]=[l("",1)]))),Q[247]||(Q[247]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh")])])],-1))]),Q[257]||(Q[257]=T(", the hidden state of the previous time step ")),t("mjx-container",$2,[(e(),a("svg",U2,Q[248]||(Q[248]=[l("",1)]))),Q[249]||(Q[249]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mn",null,"2")])])],-1))]),Q[258]||(Q[258]=T(", and the input of the current time step ")),t("mjx-container",K2,[(e(),a("svg",Y2,Q[250]||(Q[250]=[l("",1)]))),Q[251]||(Q[251]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mn",null,"3")])])],-1))]),Q[259]||(Q[259]=T(". ")),Q[260]||(Q[260]=t("img",{src:m,id:"fig_rnn_bptt"},null,-1))]),Q[467]||(Q[467]=t("p",null,[t("em",null,"Computational graph showing dependencies for an RNN model with three time steps. Boxes represent variables (not shaded) or parameters (shaded) and circles represent operators.")],-1)),t("p",null,[Q[275]||(Q[275]=T("As just mentioned, the model parameters in ")),Q[276]||(Q[276]=t("a",{href:"/d2l-julia/previews/PR1/CH8.Recurrent_Neural_Networks/RNN_7#fig_rnn_bptt"},"Figure",-1)),Q[277]||(Q[277]=T(" are ")),t("mjx-container",t3,[(e(),a("svg",Q3,Q[261]||(Q[261]=[l("",1)]))),Q[262]||(Q[262]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hx")])])],-1))]),Q[278]||(Q[278]=T(", ")),t("mjx-container",T3,[(e(),a("svg",a3,Q[263]||(Q[263]=[l("",1)]))),Q[264]||(Q[264]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh")])])],-1))]),Q[279]||(Q[279]=T(", and ")),t("mjx-container",e3,[(e(),a("svg",l3,Q[265]||(Q[265]=[l("",1)]))),Q[266]||(Q[266]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")])])],-1))]),Q[280]||(Q[280]=T(". Generally, training this model requires gradient computation with respect to these parameters ")),t("mjx-container",s3,[(e(),a("svg",o3,Q[267]||(Q[267]=[l("",1)]))),Q[268]||(Q[268]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hx")])])],-1))]),Q[281]||(Q[281]=T(", ")),t("mjx-container",m3,[(e(),a("svg",n3,Q[269]||(Q[269]=[l("",1)]))),Q[270]||(Q[270]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh")])])],-1))]),Q[282]||(Q[282]=T(", and ")),t("mjx-container",d3,[(e(),a("svg",r3,Q[271]||(Q[271]=[l("",1)]))),Q[272]||(Q[272]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")])])],-1))]),Q[283]||(Q[283]=T(". According to the dependencies in ")),Q[284]||(Q[284]=t("a",{href:"/d2l-julia/previews/PR1/CH8.Recurrent_Neural_Networks/RNN_7#fig_rnn_bptt"},"Figure",-1)),Q[285]||(Q[285]=T(", we can traverse in the opposite direction of the arrows to calculate and store the gradients in turn. To flexibly express the multiplication of matrices, vectors, and scalars of different shapes in the chain rule, we continue to use the ")),t("mjx-container",i3,[(e(),a("svg",h3,Q[273]||(Q[273]=[l("",1)]))),Q[274]||(Q[274]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mtext",null,"prod")])],-1))]),Q[286]||(Q[286]=T(" operator as described in :numref:")),Q[287]||(Q[287]=t("code",null,"sec_backprop",-1)),Q[288]||(Q[288]=T("."))]),t("p",null,[Q[291]||(Q[291]=T("First of all, differentiating the objective function with respect to the model output at any time step ")),t("mjx-container",p3,[(e(),a("svg",g3,Q[289]||(Q[289]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D461",d:"M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[290]||(Q[290]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t")])],-1))]),Q[292]||(Q[292]=T(" is fairly straightforward:"))]),t("mjx-container",H3,[(e(),a("svg",u3,Q[293]||(Q[293]=[l("",1)]))),Q[294]||(Q[294]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])])]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"l"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")]),t("mo",null,","),t("msub",null,[t("mi",null,"y"),t("mi",null,"t")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"T"),t("mo",null,"⋅"),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"q")]),t("mo",null,".")])],-1))]),Q[468]||(Q[468]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_partial_L_ot")],-1)),t("p",null,[Q[305]||(Q[305]=T("Now we can calculate the gradient of the objective with respect to the parameter ")),t("mjx-container",x3,[(e(),a("svg",w3,Q[295]||(Q[295]=[l("",1)]))),Q[296]||(Q[296]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")])])],-1))]),Q[306]||(Q[306]=T(" in the output layer: ")),t("mjx-container",c3,[(e(),a("svg",L3,Q[297]||(Q[297]=[l("",1)]))),Q[298]||(Q[298]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"q"),t("mo",null,"×"),t("mi",null,"h")])])])],-1))]),Q[307]||(Q[307]=T(". Based on ")),Q[308]||(Q[308]=t("a",{href:"/d2l-julia/previews/PR1/CH8.Recurrent_Neural_Networks/RNN_7#fig_rnn_bptt"},"Figure",-1)),Q[309]||(Q[309]=T(", the objective ")),t("mjx-container",V3,[(e(),a("svg",f3,Q[299]||(Q[299]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[300]||(Q[300]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),Q[310]||(Q[310]=T(" depends on ")),t("mjx-container",y3,[(e(),a("svg",k3,Q[301]||(Q[301]=[l("",1)]))),Q[302]||(Q[302]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")])])],-1))]),Q[311]||(Q[311]=T(" via ")),t("mjx-container",M3,[(e(),a("svg",b3,Q[303]||(Q[303]=[l("",1)]))),Q[304]||(Q[304]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mn",null,"1")]),t("mo",null,","),t("mo",null,"…"),t("mo",null,","),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"T")])])],-1))]),Q[312]||(Q[312]=T(". Using the chain rule yields"))]),t("mjx-container",Z3,[(e(),a("svg",v3,Q[313]||(Q[313]=[l("",1)]))),Q[314]||(Q[314]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")])])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"T")]),t("mtext",null,"prod"),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])])]),t("mo",null,","),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh")])])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"="),t("mn",null,"1")]),t("mi",null,"T")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])])]),t("msubsup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t"),t("mi",{mathvariant:"normal"},"⊤")]),t("mo",null,",")])],-1))]),t("p",null,[Q[317]||(Q[317]=T("where ")),t("mjx-container",D3,[(e(),a("svg",_3,Q[315]||(Q[315]=[l("",1)]))),Q[316]||(Q[316]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])])],-1))]),Q[318]||(Q[318]=T(" is given by :eqref:")),Q[319]||(Q[319]=t("code",null,"eq_bptt_partial_L_ot",-1)),Q[320]||(Q[320]=T("."))]),t("p",null,[Q[331]||(Q[331]=T("Next, as shown in ")),Q[332]||(Q[332]=t("a",{href:"#fig_rnn_bptt"},"Figure",-1)),Q[333]||(Q[333]=T(", at the final time step ")),t("mjx-container",j3,[(e(),a("svg",C3,Q[321]||(Q[321]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D447",d:"M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[322]||(Q[322]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"T")])],-1))]),Q[334]||(Q[334]=T(", the objective function ")),t("mjx-container",R3,[(e(),a("svg",A3,Q[323]||(Q[323]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[324]||(Q[324]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),Q[335]||(Q[335]=T(" depends on the hidden state ")),t("mjx-container",S3,[(e(),a("svg",O3,Q[325]||(Q[325]=[l("",1)]))),Q[326]||(Q[326]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"T")])])],-1))]),Q[336]||(Q[336]=T(" only via ")),t("mjx-container",P3,[(e(),a("svg",I3,Q[327]||(Q[327]=[l("",1)]))),Q[328]||(Q[328]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"T")])])],-1))]),Q[337]||(Q[337]=T(". Therefore, we can easily find the gradient ")),t("mjx-container",E3,[(e(),a("svg",N3,Q[329]||(Q[329]=[l("",1)]))),Q[330]||(Q[330]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"T")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"h")])])],-1))]),Q[338]||(Q[338]=T(" using the chain rule:"))]),t("mjx-container",X3,[(e(),a("svg",B3,Q[339]||(Q[339]=[l("",1)]))),Q[340]||(Q[340]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"T")])])]),t("mo",null,"="),t("mtext",null,"prod"),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"T")])])]),t("mo",null,","),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"T")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"T")])])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"="),t("msubsup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh"),t("mi",{mathvariant:"normal"},"⊤")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"T")])])]),t("mo",null,".")])],-1))]),Q[469]||(Q[469]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_partial_L_hT_final_step")],-1)),t("p",null,[Q[355]||(Q[355]=T("It gets trickier for any time step ")),t("mjx-container",z3,[(e(),a("svg",G3,Q[341]||(Q[341]=[l("",1)]))),Q[342]||(Q[342]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t"),t("mo",null,"<"),t("mi",null,"T")])],-1))]),Q[356]||(Q[356]=T(", where the objective function ")),t("mjx-container",J3,[(e(),a("svg",F3,Q[343]||(Q[343]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[344]||(Q[344]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),Q[357]||(Q[357]=T(" depends on ")),t("mjx-container",q3,[(e(),a("svg",W3,Q[345]||(Q[345]=[l("",1)]))),Q[346]||(Q[346]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])],-1))]),Q[358]||(Q[358]=T(" via ")),t("mjx-container",$3,[(e(),a("svg",U3,Q[347]||(Q[347]=[l("",1)]))),Q[348]||(Q[348]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])])],-1))]),Q[359]||(Q[359]=T(" and ")),t("mjx-container",K3,[(e(),a("svg",Y3,Q[349]||(Q[349]=[l("",1)]))),Q[350]||(Q[350]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])])],-1))]),Q[360]||(Q[360]=T(". According to the chain rule, the gradient of the hidden state ")),t("mjx-container",t4,[(e(),a("svg",Q4,Q[351]||(Q[351]=[l("",1)]))),Q[352]||(Q[352]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"h")])])],-1))]),Q[361]||(Q[361]=T(" at any time step ")),t("mjx-container",T4,[(e(),a("svg",a4,Q[353]||(Q[353]=[l("",1)]))),Q[354]||(Q[354]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"t"),t("mo",null,"<"),t("mi",null,"T")])],-1))]),Q[362]||(Q[362]=T(" can be recurrently computed as:"))]),t("mjx-container",e4,[(e(),a("svg",l4,Q[363]||(Q[363]=[l("",1)]))),Q[364]||(Q[364]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])]),t("mo",null,"="),t("mtext",null,"prod"),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])])]),t("mo",null,","),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"+"),t("mtext",null,"prod"),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])])]),t("mo",null,","),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"="),t("msubsup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh"),t("mi",{mathvariant:"normal"},"⊤")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"t"),t("mo",null,"+"),t("mn",null,"1")])])])]),t("mo",null,"+"),t("msubsup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh"),t("mi",{mathvariant:"normal"},"⊤")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mi",null,"t")])])]),t("mo",null,".")])],-1))]),Q[470]||(Q[470]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_partial_L_ht_recur")],-1)),t("p",null,[Q[367]||(Q[367]=T("For analysis, expanding the recurrent computation for any time step ")),t("mjx-container",s4,[(e(),a("svg",o4,Q[365]||(Q[365]=[l("",1)]))),Q[366]||(Q[366]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"1"),t("mo",null,"≤"),t("mi",null,"t"),t("mo",null,"≤"),t("mi",null,"T")])],-1))]),Q[368]||(Q[368]=T(" gives"))]),t("mjx-container",m4,[(e(),a("svg",n4,Q[369]||(Q[369]=[l("",1)]))),Q[370]||(Q[370]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mi",null,"t")]),t("mi",null,"T")]),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msubsup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh"),t("mi",{mathvariant:"normal"},"⊤")]),t("mo",{"data-mjx-texclass":"CLOSE"},")")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"−"),t("mi",null,"i")])]),t("msubsup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"qh"),t("mi",{mathvariant:"normal"},"⊤")]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"o")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T"),t("mo",null,"+"),t("mi",null,"t"),t("mo",null,"−"),t("mi",null,"i")])])])]),t("mo",null,".")])],-1))]),Q[471]||(Q[471]=t("p",null,[T(":eqlabel:"),t("code",null,"eq_bptt_partial_L_ht")],-1)),t("p",null,[Q[373]||(Q[373]=T("We can see from :eqref:")),Q[374]||(Q[374]=t("code",null,"eq_bptt_partial_L_ht",-1)),Q[375]||(Q[375]=T(" that this simple linear example already exhibits some key problems of long sequence models: it involves potentially very large powers of ")),t("mjx-container",d4,[(e(),a("svg",r4,Q[371]||(Q[371]=[l("",1)]))),Q[372]||(Q[372]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msubsup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh"),t("mi",{mathvariant:"normal"},"⊤")])])],-1))]),Q[376]||(Q[376]=T(". In it, eigenvalues smaller than 1 vanish and eigenvalues larger than 1 diverge. This is numerically unstable, which manifests itself in the form of vanishing and exploding gradients. One way to address this is to truncate the time steps at a computationally convenient size as discussed in :numref:")),Q[377]||(Q[377]=t("code",null,"subsec_bptt_analysis",-1)),Q[378]||(Q[378]=T(". In practice, this truncation can also be effected by detaching the gradient after a given number of time steps. Later on, we will see how more sophisticated sequence models such as long short-term memory can alleviate this further."))]),t("p",null,[Q[391]||(Q[391]=T("Finally, ")),Q[392]||(Q[392]=t("a",{href:"/d2l-julia/previews/PR1/CH8.Recurrent_Neural_Networks/RNN_7#fig_rnn_bptt"},"Figure",-1)),Q[393]||(Q[393]=T(" shows that the objective function ")),t("mjx-container",i4,[(e(),a("svg",h4,Q[379]||(Q[379]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[380]||(Q[380]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),Q[394]||(Q[394]=T(" depends on model parameters ")),t("mjx-container",p4,[(e(),a("svg",g4,Q[381]||(Q[381]=[l("",1)]))),Q[382]||(Q[382]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hx")])])],-1))]),Q[395]||(Q[395]=T(" and ")),t("mjx-container",H4,[(e(),a("svg",u4,Q[383]||(Q[383]=[l("",1)]))),Q[384]||(Q[384]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh")])])],-1))]),Q[396]||(Q[396]=T(" in the hidden layer via hidden states ")),t("mjx-container",x4,[(e(),a("svg",w4,Q[385]||(Q[385]=[l("",1)]))),Q[386]||(Q[386]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mn",null,"1")]),t("mo",null,","),t("mo",null,"…"),t("mo",null,","),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"T")])])],-1))]),Q[397]||(Q[397]=T(". To compute gradients with respect to such parameters ")),t("mjx-container",c4,[(e(),a("svg",L4,Q[387]||(Q[387]=[l("",1)]))),Q[388]||(Q[388]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hx")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"h"),t("mo",null,"×"),t("mi",null,"d")])])])],-1))]),Q[398]||(Q[398]=T(" and ")),t("mjx-container",V4,[(e(),a("svg",f4,Q[389]||(Q[389]=[l("",1)]))),Q[390]||(Q[390]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"h"),t("mo",null,"×"),t("mi",null,"h")])])])],-1))]),Q[399]||(Q[399]=T(", we apply the chain rule giving"))]),Q[472]||(Q[472]=t("p",null,"$",-1)),Q[473]||(Q[473]=t("p",null,[T("\\begin{aligned} \\frac{\\partial L}{\\partial \\mathbf{W}"),t("em",{t:"1"},"\\textrm{hx}} &= \\sum"),T("^T \\textrm{prod}\\left(\\frac{\\partial L}{\\partial \\mathbf{h}"),t("em",{t:"1"},[T("t}, \\frac{\\partial \\mathbf{h}"),t("em",null,"t}{\\partial \\mathbf{W}"),T("\\textrm{hx}}\\right) = \\sum")]),T("^T \\frac{\\partial L}{\\partial \\mathbf{h}"),t("em",{t:"1"},[T("t} \\mathbf{x}"),t("em",null,[T("t^\\top,"),t("br"),T(" \\frac{\\partial L}{\\partial \\mathbf{W}")]),T("\\textrm{hh}} &= \\sum")]),T("^T \\textrm{prod}\\left(\\frac{\\partial L}{\\partial \\mathbf{h}"),t("em",{t:"1"},[T("t}, \\frac{\\partial \\mathbf{h}"),t("em",null,"t}{\\partial \\mathbf{W}"),T("\\textrm{hh}}\\right) = \\sum")]),T("^T \\frac{\\partial L}{\\partial \\mathbf{h}"),t("em",{"t-1":""},"t} \\mathbf{h}"),T("^\\top, \\end{aligned} $")],-1)),t("p",null,[Q[402]||(Q[402]=T("where ")),t("mjx-container",y4,[(e(),a("svg",k4,Q[400]||(Q[400]=[l("",1)]))),Q[401]||(Q[401]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])],-1))]),Q[403]||(Q[403]=T(" which is recurrently computed by :eqref:")),Q[404]||(Q[404]=t("code",null,"eq_bptt_partial_L_hT_final_step",-1)),Q[405]||(Q[405]=T(" and :eqref:")),Q[406]||(Q[406]=t("code",null,"eq_bptt_partial_L_ht_recur",-1)),Q[407]||(Q[407]=T(" is the key quantity that affects the numerical stability."))]),t("p",null,[Q[414]||(Q[414]=T("Since backpropagation through time is the application of backpropagation in RNNs, as we have explained in :numref:")),Q[415]||(Q[415]=t("code",null,"sec_backprop",-1)),Q[416]||(Q[416]=T(", training RNNs alternates forward propagation with backpropagation through time. Moreover, backpropagation through time computes and stores the above gradients in turn. Specifically, stored intermediate values are reused to avoid duplicate calculations, such as storing ")),t("mjx-container",M4,[(e(),a("svg",b4,Q[408]||(Q[408]=[l("",1)]))),Q[409]||(Q[409]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mi",null,"t")])])],-1))]),Q[417]||(Q[417]=T(" to be used in computation of both ")),t("mjx-container",Z4,[(e(),a("svg",v4,Q[410]||(Q[410]=[l("",1)]))),Q[411]||(Q[411]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hx")])])],-1))]),Q[418]||(Q[418]=T(" and ")),t("mjx-container",D4,[(e(),a("svg",_4,Q[412]||(Q[412]=[l("",1)]))),Q[413]||(Q[413]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"∂"),t("mi",null,"L"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mtext",null,"hh")])])],-1))]),Q[419]||(Q[419]=T("."))]),Q[474]||(Q[474]=t("h2",{id:"Summary",tabindex:"-1"},[T("Summary "),t("a",{class:"header-anchor",href:"#Summary","aria-label":'Permalink to "Summary {#Summary}"'},"​")],-1)),Q[475]||(Q[475]=t("p",null,"Backpropagation through time is merely an application of backpropagation to sequence models with a hidden state. Truncation, such as regular or randomized, is needed for computational convenience and numerical stability. High powers of matrices can lead to divergent or vanishing eigenvalues. This manifests itself in the form of exploding or vanishing gradients. For efficient computation, intermediate values are cached during backpropagation through time.",-1)),Q[476]||(Q[476]=t("h2",{id:"Exercises",tabindex:"-1"},[T("Exercises "),t("a",{class:"header-anchor",href:"#Exercises","aria-label":'Permalink to "Exercises {#Exercises}"'},"​")],-1)),t("ol",null,[t("li",null,[t("p",null,[Q[430]||(Q[430]=T("Assume that we have a symmetric matrix ")),t("mjx-container",j4,[(e(),a("svg",C4,Q[420]||(Q[420]=[l("",1)]))),Q[421]||(Q[421]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n"),t("mo",null,"×"),t("mi",null,"n")])])])],-1))]),Q[431]||(Q[431]=T(" with eigenvalues ")),t("mjx-container",R4,[(e(),a("svg",A4,Q[422]||(Q[422]=[l("",1)]))),Q[423]||(Q[423]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"λ"),t("mi",null,"i")])])],-1))]),Q[432]||(Q[432]=T(" whose corresponding eigenvectors are ")),t("mjx-container",S4,[(e(),a("svg",O4,Q[424]||(Q[424]=[l("",1)]))),Q[425]||(Q[425]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mi",null,"i")])])],-1))]),Q[433]||(Q[433]=T(" (")),t("mjx-container",P4,[(e(),a("svg",I4,Q[426]||(Q[426]=[l("",1)]))),Q[427]||(Q[427]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1"),t("mo",null,","),t("mo",null,"…"),t("mo",null,","),t("mi",null,"n")])],-1))]),Q[434]||(Q[434]=T("). Without loss of generality, assume that they are ordered in the order ")),t("mjx-container",E4,[(e(),a("svg",N4,Q[428]||(Q[428]=[l("",1)]))),Q[429]||(Q[429]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"λ"),t("mi",null,"i")]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mo",null,"≥"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("msub",null,[t("mi",null,"λ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])],-1))]),Q[435]||(Q[435]=T("."))])]),t("li",null,[t("p",null,[Q[440]||(Q[440]=T("Show that ")),t("mjx-container",X4,[(e(),a("svg",B4,Q[436]||(Q[436]=[l("",1)]))),Q[437]||(Q[437]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")]),t("mi",null,"k")])])],-1))]),Q[441]||(Q[441]=T(" has eigenvalues ")),t("mjx-container",z4,[(e(),a("svg",G4,Q[438]||(Q[438]=[l("",1)]))),Q[439]||(Q[439]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msubsup",null,[t("mi",null,"λ"),t("mi",null,"i"),t("mi",null,"k")])])],-1))]),Q[442]||(Q[442]=T("."))])]),t("li",null,[t("p",null,[Q[449]||(Q[449]=T("Prove that for a random vector ")),t("mjx-container",J4,[(e(),a("svg",F4,Q[443]||(Q[443]=[l("",1)]))),Q[444]||(Q[444]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mi",null,"n")])])],-1))]),Q[450]||(Q[450]=T(", with high probability ")),t("mjx-container",q4,[(e(),a("svg",W4,Q[445]||(Q[445]=[l("",1)]))),Q[446]||(Q[446]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")]),t("mi",null,"k")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")])])],-1))]),Q[451]||(Q[451]=T(" will be very much aligned with the eigenvector ")),t("mjx-container",$4,[(e(),a("svg",U4,Q[447]||(Q[447]=[l("",1)]))),Q[448]||(Q[448]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mn",null,"1")])])],-1))])])])]),t("p",null,[Q[454]||(Q[454]=T("of ")),t("mjx-container",K4,[(e(),a("svg",Y4,Q[452]||(Q[452]=[l("",1)]))),Q[453]||(Q[453]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"M")])])],-1))]),Q[455]||(Q[455]=T(". Formalize this statement."))]),Q[477]||(Q[477]=l("",2))])}const m6=s(n,[["render",t6]]);export{o6 as __pageData,m6 as default};
