import{_ as r,c as e,o,j as l,aA as Q,a as t}from"./chunks/framework.DjA5121Y.js";const b1=JSON.parse('{"title":"Attention Pooling by Similarity","description":"","frontmatter":{},"headers":[],"relativePath":"CH10.Attention_Mechanisms_and_Transformers/ATTN_2.md","filePath":"CH10.Attention_Mechanisms_and_Transformers/ATTN_2.md","lastUpdated":null}'),n={name:"CH10.Attention_Mechanisms_and_Transformers/ATTN_2.md"},s={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.961ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3076.7 1000","aria-hidden":"true"},p={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.457ex",role:"img",focusable:"false",viewBox:"0 -450 607 644","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.57ex",role:"img",focusable:"false",viewBox:"0 -694 607 694","aria-hidden":"true"},h={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-5.089ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.892ex",height:"11.31ex",role:"img",focusable:"false",viewBox:"0 -2749.5 21168.4 4999","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.697ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.197ex",height:"6ex",role:"img",focusable:"false",viewBox:"0 -1460 11579.2 2652.2","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.728ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2973.6 1000","aria-hidden":"true"},T={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.978ex",height:"1.783ex",role:"img",focusable:"false",viewBox:"0 -583 3084.5 788","aria-hidden":"true"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.243ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 3201.5 851.8","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.457ex",role:"img",focusable:"false",viewBox:"0 -450 607 644","aria-hidden":"true"},B={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.244ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 550 910","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.848ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 817 647","aria-hidden":"true"},M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.113ex",height:"1.361ex",role:"img",focusable:"false",viewBox:"0 -444 934 601.8","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.961ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3076.7 1000","aria-hidden":"true"},Y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.57ex",role:"img",focusable:"false",viewBox:"0 -694 607 694","aria-hidden":"true"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},J={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.457ex",role:"img",focusable:"false",viewBox:"0 -450 607 644","aria-hidden":"true"},z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453","aria-hidden":"true"},W={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.625ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 3370.2 888","aria-hidden":"true"},j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.327ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 2354.6 776","aria-hidden":"true"},N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.131ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 500 666","aria-hidden":"true"},X={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.059ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 9750 1000","aria-hidden":"true"},K={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.919ex",height:"1ex",role:"img",focusable:"false",viewBox:"0 -431 406 442","aria-hidden":"true"},O={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.798ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.002ex",height:"2.755ex",role:"img",focusable:"false",viewBox:"0 -864.9 6631.1 1217.7","aria-hidden":"true"},_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.871ex"},xmlns:"http://www.w3.org/2000/svg",width:"29.814ex",height:"2.828ex",role:"img",focusable:"false",viewBox:"0 -864.9 13177.9 1250.1","aria-hidden":"true"},l1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.28ex",height:"1.912ex",role:"img",focusable:"false",viewBox:"0 -833.9 1007.6 844.9","aria-hidden":"true"},t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},e1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.798ex"},xmlns:"http://www.w3.org/2000/svg",width:"20.558ex",height:"2.755ex",role:"img",focusable:"false",viewBox:"0 -864.9 9086.7 1217.7","aria-hidden":"true"},o1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.595ex",height:"2.398ex",role:"img",focusable:"false",viewBox:"0 -810 11312.9 1060","aria-hidden":"true"},r1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.438ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 5497.5 1083.9","aria-hidden":"true"},s1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.848ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 817 647","aria-hidden":"true"},p1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.244ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 550 910","aria-hidden":"true"},c1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.728ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2973.6 1000","aria-hidden":"true"},h1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.118ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2262 1000","aria-hidden":"true"},L1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.005ex",role:"img",focusable:"false",viewBox:"0 -444 607 444","aria-hidden":"true"},y1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.784ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3440.6 1000","aria-hidden":"true"},T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.502ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 4199.9 1083.9","aria-hidden":"true"};function m1(E1,i,C1,w1,B1,I1){return o(),e("div",null,[i[120]||(i[120]=l("h1",{id:"Attention-Pooling-by-Similarity",tabindex:"-1"},[t("Attention Pooling by Similarity "),l("a",{class:"header-anchor",href:"#Attention-Pooling-by-Similarity","aria-label":'Permalink to "Attention Pooling by Similarity {#Attention-Pooling-by-Similarity}"'},"​")],-1)),l("p",null,[i[6]||(i[6]=t("Now that we have introduced the primary components of the attention mechanism, let's use them in a rather classical setting, namely regression and classification via kernel density estimation [")),i[7]||(i[7]=l("a",{href:"/d2l-julia/previews/PR1/references#Nadaraya_1964"},"178",-1)),i[8]||(i[8]=t("], [")),i[9]||(i[9]=l("a",{href:"/d2l-julia/previews/PR1/references#Watson_1964"},"179",-1)),i[10]||(i[10]=t("]. This detour simply provides additional background: it is entirely optional and can be skipped if needed. At their core, Nadaraya–Watson estimators rely on some similarity kernel ")),l("mjx-container",s,[(o(),e("svg",a,i[0]||(i[0]=[Q("",1)]))),i[1]||(i[1]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"α"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,","),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mo",{stretchy:"false"},")")])],-1))]),i[11]||(i[11]=t(" relating queries ")),l("mjx-container",p,[(o(),e("svg",A,i[2]||(i[2]=[Q("",1)]))),i[3]||(i[3]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")])])],-1))]),i[12]||(i[12]=t(" to keys ")),l("mjx-container",c,[(o(),e("svg",d,i[4]||(i[4]=[Q("",1)]))),i[5]||(i[5]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")])])],-1))]),i[13]||(i[13]=t(". Some common kernels are"))]),l("mjx-container",h,[(o(),e("svg",k,i[14]||(i[14]=[Q("",1)]))),i[15]||(i[15]=l("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("mtable",{displaystyle:"true",columnalign:"right left right left",columnspacing:"0em 2em 0em",rowspacing:"3pt"},[l("mtr",null,[l("mtd",null,[l("mi",null,"α"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,","),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mo",{stretchy:"false"},")")]),l("mtd",null,[l("mi"),l("mo",null,"="),l("mi",null,"exp"),l("mo",{"data-mjx-texclass":"NONE"},"⁡"),l("mrow",{"data-mjx-texclass":"INNER"},[l("mo",{"data-mjx-texclass":"OPEN"},"("),l("mo",null,"−"),l("mfrac",null,[l("mn",null,"1"),l("mn",null,"2")]),l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,"−"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("msup",null,[l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mn",null,"2")]),l("mo",{"data-mjx-texclass":"CLOSE"},")")])]),l("mtd"),l("mtd",null,[l("mtext",null,"Gaussian;")])]),l("mtr",null,[l("mtd",null,[l("mi",null,"α"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,","),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mo",{stretchy:"false"},")")]),l("mtd",null,[l("mi"),l("mo",null,"="),l("mn",null,"1"),l("mtext",null," if "),l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,"−"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mo",null,"≤"),l("mn",null,"1")]),l("mtd"),l("mtd",null,[l("mtext",null,"Boxcar;")])]),l("mtr",null,[l("mtd",null,[l("mi",null,"α"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,","),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mo",{stretchy:"false"},")")]),l("mtd",null,[l("mi"),l("mo",null,"="),l("mrow",{"data-mjx-texclass":"OP"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{"data-mjx-auto-op":"false"},"max")])]),l("mo",{"data-mjx-texclass":"NONE"},"⁡"),l("mrow",{"data-mjx-texclass":"INNER"},[l("mo",{"data-mjx-texclass":"OPEN"},"("),l("mn",null,"0"),l("mo",null,","),l("mn",null,"1"),l("mo",null,"−"),l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,"−"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mo",{"data-mjx-texclass":"CLOSE"},")")])]),l("mtd"),l("mtd",null,[l("mtext",null,"Epanechikov.")])])])])],-1))]),i[121]||(i[121]=l("p",null,[t("There are many more choices that we could pick. See a "),l("a",{href:"https://en.wikipedia.org/wiki/Kernel_(statistics)",target:"_blank",rel:"noreferrer"},"Wikipedia article"),t(" for a more extensive review and how the choice of kernels is related to kernel density estimation, sometimes also called "),l("em",null,"Parzen Windows"),t(),l("a",{href:"./@cite"},"parzen1957consistent"),t(". All of the kernels are heuristic and can be tuned. For instance, we can adjust the width, not only on a global basis but even on a per-coordinate basis. Regardless, all of them lead to the following equation for regression and classification alike:")],-1)),l("mjx-container",L,[(o(),e("svg",f,i[16]||(i[16]=[Q("",1)]))),i[17]||(i[17]=l("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("mi",null,"f"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",{stretchy:"false"},")"),l("mo",null,"="),l("munder",null,[l("mo",{"data-mjx-texclass":"OP"},"∑"),l("mi",null,"i")]),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"v")]),l("mi",null,"i")]),l("mfrac",null,[l("mrow",null,[l("mi",null,"α"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,","),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mi",null,"i")]),l("mo",{stretchy:"false"},")")]),l("mrow",null,[l("munder",null,[l("mo",{"data-mjx-texclass":"OP"},"∑"),l("mi",null,"j")]),l("mi",null,"α"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,","),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mi",null,"j")]),l("mo",{stretchy:"false"},")")])]),l("mo",null,".")])],-1))]),l("p",null,[i[32]||(i[32]=t("In the case of a (scalar) regression with observations ")),l("mjx-container",y,[(o(),e("svg",u,i[18]||(i[18]=[Q("",1)]))),i[19]||(i[19]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mo",{stretchy:"false"},"("),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mi",null,"i")]),l("mo",null,","),l("msub",null,[l("mi",null,"y"),l("mi",null,"i")]),l("mo",{stretchy:"false"},")")])],-1))]),i[33]||(i[33]=t(" for features and labels respectively, ")),l("mjx-container",T,[(o(),e("svg",g,i[20]||(i[20]=[Q("",1)]))),i[21]||(i[21]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"v")]),l("mi",null,"i")]),l("mo",null,"="),l("msub",null,[l("mi",null,"y"),l("mi",null,"i")])])],-1))]),i[34]||(i[34]=t(" are scalars, ")),l("mjx-container",m,[(o(),e("svg",E,i[22]||(i[22]=[Q("",1)]))),i[23]||(i[23]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mi",null,"i")]),l("mo",null,"="),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mi",null,"i")])])],-1))]),i[35]||(i[35]=t(" are vectors, and the query ")),l("mjx-container",C,[(o(),e("svg",w,i[24]||(i[24]=[Q("",1)]))),i[25]||(i[25]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")])])],-1))]),i[36]||(i[36]=t(" denotes the new location where ")),l("mjx-container",B,[(o(),e("svg",I,i[26]||(i[26]=[l("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[l("g",{"data-mml-node":"math"},[l("g",{"data-mml-node":"mi"},[l("path",{"data-c":"1D453",d:"M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z",style:{"stroke-width":"3"}})])])],-1)]))),i[27]||(i[27]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"f")])],-1))]),i[37]||(i[37]=t(" should be evaluated. In the case of (multiclass) classification, we use one-hot-encoding of ")),l("mjx-container",x,[(o(),e("svg",b,i[28]||(i[28]=[Q("",1)]))),i[29]||(i[29]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("msub",null,[l("mi",null,"y"),l("mi",null,"i")])])],-1))]),i[38]||(i[38]=t(" to obtain ")),l("mjx-container",M,[(o(),e("svg",H,i[30]||(i[30]=[Q("",1)]))),i[31]||(i[31]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"v")]),l("mi",null,"i")])])],-1))]),i[39]||(i[39]=t(". One of the convenient properties of this estimator is that it requires no training. Even more so, if we suitably narrow the kernel with increasing amounts of data, the approach is consistent [")),i[40]||(i[40]=l("a",{href:"/d2l-julia/previews/PR1/references#mack1982weak"},"180",-1)),i[41]||(i[41]=t("], i.e., it will converge to some statistically optimal solution. Let's start by inspecting some kernels."))]),i[122]||(i[122]=Q("",3)),l("p",null,[i[54]||(i[54]=t("All the kernels ")),l("mjx-container",v,[(o(),e("svg",Z,i[42]||(i[42]=[Q("",1)]))),i[43]||(i[43]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"α"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mo",null,","),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",{stretchy:"false"},")")])],-1))]),i[55]||(i[55]=t(" defined in this section are ")),i[56]||(i[56]=l("em",null,"translation and rotation invariant",-1)),i[57]||(i[57]=t("; that is, if we shift and rotate ")),l("mjx-container",Y,[(o(),e("svg",F,i[44]||(i[44]=[Q("",1)]))),i[45]||(i[45]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")])])],-1))]),i[58]||(i[58]=t(" and ")),l("mjx-container",S,[(o(),e("svg",J,i[46]||(i[46]=[Q("",1)]))),i[47]||(i[47]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")])])],-1))]),i[59]||(i[59]=t(" in the same manner, the value of ")),l("mjx-container",z,[(o(),e("svg",V,i[48]||(i[48]=[l("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[l("g",{"data-mml-node":"math"},[l("g",{"data-mml-node":"mi"},[l("path",{"data-c":"1D6FC",d:"M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z",style:{"stroke-width":"3"}})])])],-1)]))),i[49]||(i[49]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"α")])],-1))]),i[60]||(i[60]=t(" remains unchanged. For simplicity we thus pick scalar arguments ")),l("mjx-container",W,[(o(),e("svg",D,i[50]||(i[50]=[Q("",1)]))),i[51]||(i[51]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"k"),l("mo",null,","),l("mi",null,"q"),l("mo",null,"∈"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"double-struck"},"R")])])],-1))]),i[61]||(i[61]=t(" and pick the key ")),l("mjx-container",j,[(o(),e("svg",P,i[52]||(i[52]=[Q("",1)]))),i[53]||(i[53]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"k"),l("mo",null,"="),l("mn",null,"0")])],-1))]),i[62]||(i[62]=t(" as the origin. This yields:"))]),i[123]||(i[123]=Q("",2)),l("p",null,[i[65]||(i[65]=t("Different kernels correspond to different notions of range and smoothness. For instance, the boxcar kernel only attends to observations within a distance of ")),l("mjx-container",N,[(o(),e("svg",G,i[63]||(i[63]=[l("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[l("g",{"data-mml-node":"math"},[l("g",{"data-mml-node":"mn"},[l("path",{"data-c":"31",d:"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z",style:{"stroke-width":"3"}})])])],-1)]))),i[64]||(i[64]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mn",null,"1")])],-1))]),i[66]||(i[66]=t(" (or some otherwise defined hyperparameter) and does so indiscriminately."))]),i[124]||(i[124]=l("p",null,"To see Nadaraya–Watson estimation in action, let's define some training data. In the following we use the dependency",-1)),l("mjx-container",X,[(o(),e("svg",R,i[67]||(i[67]=[Q("",1)]))),i[68]||(i[68]=l("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("msub",null,[l("mi",null,"y"),l("mi",null,"i")]),l("mo",null,"="),l("mn",null,"2"),l("mi",null,"sin"),l("mo",{"data-mjx-texclass":"NONE"},"⁡"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"x"),l("mi",null,"i")]),l("mo",{stretchy:"false"},")"),l("mo",null,"+"),l("msub",null,[l("mi",null,"x"),l("mi",null,"i")]),l("mo",null,"+"),l("mi",null,"ϵ"),l("mo",null,",")])],-1))]),l("p",null,[i[71]||(i[71]=t("where ")),l("mjx-container",K,[(o(),e("svg",U,i[69]||(i[69]=[l("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[l("g",{"data-mml-node":"math"},[l("g",{"data-mml-node":"mi"},[l("path",{"data-c":"1D716",d:"M227 -11Q149 -11 95 41T40 174Q40 262 87 322Q121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411Q382 385 341 385H325H312Q191 385 154 277L150 265H327Q340 256 340 246Q340 228 320 219H138V217Q128 187 128 143Q128 77 160 52T231 26Q258 26 284 36T326 57T343 68Q350 68 354 58T358 39Q358 36 357 35Q354 31 337 21T289 0T227 -11Z",style:{"stroke-width":"3"}})])])],-1)]))),i[70]||(i[70]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"ϵ")])],-1))]),i[72]||(i[72]=t(" is drawn from a normal distribution with zero mean and unit variance. We draw 40 training examples."))]),i[125]||(i[125]=Q("",9)),l("p",null,[i[75]||(i[75]=t("The first thing that stands out is that all three nontrivial kernels (Gaussian, Boxcar, and Epanechikov) produce fairly workable estimates that are not too far from the true function. Only the constant kernel that leads to the trivial estimate ")),l("mjx-container",O,[(o(),e("svg",q,i[73]||(i[73]=[Q("",1)]))),i[74]||(i[74]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"f"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")"),l("mo",null,"="),l("mfrac",null,[l("mn",null,"1"),l("mi",null,"n")]),l("munder",null,[l("mo",{"data-mjx-texclass":"OP"},"∑"),l("mi",null,"i")]),l("msub",null,[l("mi",null,"y"),l("mi",null,"i")])])],-1))]),i[76]||(i[76]=t(" produces a rather unrealistic result. Let's inspect the attention weighting a bit more closely:"))]),i[126]||(i[126]=Q("",4)),l("p",null,[i[81]||(i[81]=t("We could replace the Gaussian kernel with one of a different width. That is, we could use ")),l("mjx-container",_,[(o(),e("svg",$,i[77]||(i[77]=[Q("",1)]))),i[78]||(i[78]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"α"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,","),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("mo",{stretchy:"false"},")"),l("mo",null,"="),l("mi",null,"exp"),l("mo",{"data-mjx-texclass":"NONE"},"⁡"),l("mrow",{"data-mjx-texclass":"INNER"},[l("mo",{"data-mjx-texclass":"OPEN"},"("),l("mo",null,"−"),l("mfrac",null,[l("mn",null,"1"),l("mrow",null,[l("mn",null,"2"),l("msup",null,[l("mi",null,"σ"),l("mn",null,"2")])])]),l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"q")]),l("mo",null,"−"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"k")]),l("msup",null,[l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mn",null,"2")]),l("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))]),i[82]||(i[82]=t(" where ")),l("mjx-container",l1,[(o(),e("svg",i1,i[79]||(i[79]=[Q("",1)]))),i[80]||(i[80]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("msup",null,[l("mi",null,"σ"),l("mn",null,"2")])])],-1))]),i[83]||(i[83]=t(" determines the width of the kernel. Let's see whether this affects the outcomes."))]),i[127]||(i[127]=Q("",10)),l("ol",null,[l("li",null,[l("p",null,[i[88]||(i[88]=t("Parzen windows density estimates are given by ")),l("mjx-container",t1,[(o(),e("svg",e1,i[84]||(i[84]=[Q("",1)]))),i[85]||(i[85]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mover",null,[l("mi",null,"p"),l("mo",{stretchy:"false"},"^")])]),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mo",{stretchy:"false"},")"),l("mo",null,"="),l("mfrac",null,[l("mn",null,"1"),l("mi",null,"n")]),l("munder",null,[l("mo",{"data-mjx-texclass":"OP"},"∑"),l("mi",null,"i")]),l("mi",null,"k"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mo",null,","),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mi",null,"i")]),l("mo",{stretchy:"false"},")")])],-1))]),i[89]||(i[89]=t(". Prove that for binary classification the function ")),l("mjx-container",o1,[(o(),e("svg",Q1,i[86]||(i[86]=[Q("",1)]))),i[87]||(i[87]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mover",null,[l("mi",null,"p"),l("mo",{stretchy:"false"},"^")])]),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mo",null,","),l("mi",null,"y"),l("mo",null,"="),l("mn",null,"1"),l("mo",{stretchy:"false"},")"),l("mo",null,"−"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mover",null,[l("mi",null,"p"),l("mo",{stretchy:"false"},"^")])]),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mo",null,","),l("mi",null,"y"),l("mo",null,"="),l("mo",null,"−"),l("mn",null,"1"),l("mo",{stretchy:"false"},")")])],-1))]),i[90]||(i[90]=t(", as obtained by Parzen windows is equivalent to Nadaraya–Watson classification."))])]),i[118]||(i[118]=l("li",null,[l("p",null,"Implement stochastic gradient descent to learn a good value for kernel widths in Nadaraya–Watson regression.")],-1)),l("li",null,[l("p",null,[i[97]||(i[97]=t("What happens if you just use the above estimates to minimize ")),l("mjx-container",r1,[(o(),e("svg",n1,i[91]||(i[91]=[Q("",1)]))),i[92]||(i[92]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mo",{stretchy:"false"},"("),l("mi",null,"f"),l("mo",{stretchy:"false"},"("),l("mrow",{"data-mjx-texclass":"ORD"},[l("msub",null,[l("mi",{mathvariant:"bold"},"x"),l("mi",{mathvariant:"bold"},"i")])]),l("mo",{stretchy:"false"},")"),l("mo",null,"−"),l("msub",null,[l("mi",null,"y"),l("mi",null,"i")]),l("msup",null,[l("mo",{stretchy:"false"},")"),l("mn",null,"2")])])],-1))]),i[98]||(i[98]=t(" directly? Hint: ")),l("mjx-container",s1,[(o(),e("svg",a1,i[93]||(i[93]=[Q("",1)]))),i[94]||(i[94]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("msub",null,[l("mi",null,"y"),l("mi",null,"i")])])],-1))]),i[99]||(i[99]=t(" is part of the terms used to compute ")),l("mjx-container",p1,[(o(),e("svg",A1,i[95]||(i[95]=[l("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[l("g",{"data-mml-node":"math"},[l("g",{"data-mml-node":"mi"},[l("path",{"data-c":"1D453",d:"M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z",style:{"stroke-width":"3"}})])])],-1)]))),i[96]||(i[96]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"f")])],-1))]),i[100]||(i[100]=t("."))])]),l("li",null,[l("p",null,[i[105]||(i[105]=t("Remove ")),l("mjx-container",c1,[(o(),e("svg",d1,i[101]||(i[101]=[Q("",1)]))),i[102]||(i[102]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mo",{stretchy:"false"},"("),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mi",null,"i")]),l("mo",null,","),l("msub",null,[l("mi",null,"y"),l("mi",null,"i")]),l("mo",{stretchy:"false"},")")])],-1))]),i[106]||(i[106]=t(" from the estimate for ")),l("mjx-container",h1,[(o(),e("svg",k1,i[103]||(i[103]=[Q("",1)]))),i[104]||(i[104]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mi",null,"f"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mi",null,"i")]),l("mo",{stretchy:"false"},")")])],-1))]),i[107]||(i[107]=t(" and optimize over the kernel widths. Do you still observe overfitting?"))])]),l("li",null,[l("p",null,[i[114]||(i[114]=t("Assume that all ")),l("mjx-container",L1,[(o(),e("svg",f1,i[108]||(i[108]=[Q("",1)]))),i[109]||(i[109]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")])])],-1))]),i[115]||(i[115]=t(" lie on the unit sphere, i.e., all satisfy ")),l("mjx-container",y1,[(o(),e("svg",u1,i[110]||(i[110]=[Q("",1)]))),i[111]||(i[111]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mo",null,"="),l("mn",null,"1")])],-1))]),i[116]||(i[116]=t(". Can you simplify the ")),l("mjx-container",T1,[(o(),e("svg",g1,i[112]||(i[112]=[Q("",1)]))),i[113]||(i[113]=l("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mo",null,"−"),l("msub",null,[l("mrow",{"data-mjx-texclass":"ORD"},[l("mi",{mathvariant:"bold"},"x")]),l("mi",null,"i")]),l("msup",null,[l("mo",{"data-mjx-texclass":"ORD"},"∥"),l("mn",null,"2")])])],-1))]),i[117]||(i[117]=t(" term in the exponential? Hint: we will later see that this is very closely related to dot product attention."))])]),i[119]||(i[119]=l("li",null,[l("p",null,[t("Recall that "),l("a",{href:"/d2l-julia/previews/PR1/references#mack1982weak"},"Mack and Silverman [180]"),t(" proved that Nadaraya–Watson estimation is consistent. How quickly should you reduce the scale for the attention mechanism as you get more data? Provide some intuition for your answer. Does it depend on the dimensionality of the data? How?")])],-1))]),i[128]||(i[128]=Q("",1))])}const M1=r(n,[["render",m1]]);export{b1 as __pageData,M1 as default};
